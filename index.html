<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>עזר תורה - תושיה תפרח | v14</title>
<link rel="icon" href="data:image/jpeg;base64,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c2x0VW50RiNQeGxAUgAAAAAAAAAAAAp2ZWN0b3JEYXRhYm9vbAEAAAAAUGdQc2VudW0AAAAAUGdQcwAAAABQZ1BDAAAAAExlZnRVbnRGI1JsdAAAAAAAAAAAAAAAAFRvcCBVbnRGI1JsdAAAAAAAAAAAAAAAAFNjbCBVbnRGI1ByY0BZAAAAAAAAOEJJTQPtAAAAAAAQAEgAAAABAAIASAAAAAEAAjhCSU0EJgAAAAAADgAAAAAAAAAAAAA/gAAAOEJJTQQNAAAAAAAEAAAAeDhCSU0EGQAAAAAABAAAAB44QklNA/MAAAAAAAkAAAAAAAAAAAEAOEJJTScQAAAAAAAKAAEAAAAAAAAAAjhCSU0D9QAAAAAASAAvZmYAAQBsZmYABgAAAAAAAQAvZmYAAQChmZoABgAAAAAAAQAyAAAAAQBaAAAABgAAAAAAAQA1AAAAAQAtAAAABgAAAAAAAThCSU0D+AAAAAAAcAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAA4QklNBAAAAAAAAAIAAThCSU0EAgAAAAAABAAAAAA4QklNBDAAAAAAAAIBAThCSU0ELQAAAAAABgABAAAABDhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAANJAAAABgAAAAAAAAAAAAAAngAAAMgAAAAKAFUAbgB0AGkAdABsAGUAZAAtADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAMgAAACeAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAACeAAAAAFJnaHRsb25nAAAAyAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElE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ZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgeG1wOkNyZWF0ZURhdGU9IjIwMTktMDQtMDhUMjA6NTM6MDUrMDM6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMDQtMDhUMjA6NTM6MDUrMDM6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTA0LTA4VDIwOjUzOjA1KzAzOjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkIxRjBDRTBFRjk1OUU5MTFCMjQ2QjMzNjkzODBBQ0U5IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkIwRjBDRTBFRjk1OUU5MTFCMjQ2QjMzNjkzODBBQ0U5IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6QjBGMENFMEVGOTU5RTkxMUIyNDZCMzM2OTM4MEFDRTkiIGRjOmZvcm1hdD0iaW1hZ2UvanBlZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMEYwQ0UwRUY5NTlFOTExQjI0NkIzMzY5MzgwQUNFOSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0wOFQyMDo1MzowNSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMUYwQ0UwRUY5NTlFOTExQjI0NkIzMzY5MzgwQUNFOSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0wOFQyMDo1MzowNSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAA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QAA8USmfiYcB0A+Z+aX0ybZt8pqf7Rwf+Mqfl5ny4ceGyd8RviJj9q4/GyzYyOMxxwnmIADSB/VeLW9y91HPVwW19rUeDo4YYYkQIigWUDkD6/Qe/de6WX04Hv3Xuve/de697917r3v3Xuve/de697917r3v3Xuve/de697917r/0t/j37r3Xvfuvde9+691737r3Xvfuvde9+691737r3Xvfuvde9+691737r3WCo8JjPmKhbclvp7917opPeVH1lPi6sbhy9DRAo+ppaarlK+k34gpZbj377OvdUTdnYD4jt3Vt6KPffXcfeUvXe8JNiVL4TIP29TdVRVsI3fBswjG/wAfO36h2kK/bwyTimWu+ydKb+IAxlfwciNzJ9TdXtJ1mUSRBX+ma4PwPKwUxBx+IFwpahcahQjG2k5mGyvFBbsbQrUPUawnmFFdRB8jSoHDFKGj+LeD+NsE1GcFvXC1zXj0CLFZuG44tpNRiIhb3Jv29A7q6nY0W2Y8fTjD1VNPEI10mOORL8CxPkiQ2/p7917oSRawt9Pfuvdd+/de697917r3v3Xuve/de697917r3v3Xuve/de697917r3v3Xuv/2Q==" type="image/jpeg">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
// ══ SUPABASE CONFIG ══
const SUPABASE_URL = "https://bgnjupxlslelynbgyggt.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJnbmp1cHhsc2xlbHluYmd5Z2d0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3OTcwNTgsImV4cCI6MjA4NzM3MzA1OH0.42yRsoRUlpZ0wl05if3EAvx0vkiJg1Fv_9COx8V68qA";
const _sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Frank+Ruhl+Libre:wght@300;400;500;700;900&family=Heebo:wght@300;400;500;600;700&display=swap');

:root {
  --navy:#1a2744; --navy-l:#243258; --navy-h:#0f1a30;
  --gold:#c9a84c; --gold-l:#e8c97e; --gold-bg:#fdf8ec;
  --cream:#f8f4ed; --cream-d:#ede8df;
  --text:#1a2744; --muted:#6b7a9a;
  --white:#fff; --danger:#c0392b; --danger-bg:#fdecea;
  --success:#27ae60; --success-bg:#eafaf1;
  --warn:#e67e22; --purple:#6d28d9; --purple-bg:#f5f3ff;
  --border:#d5cfc4;
  --teal:#0891b2; --teal-bg:#e0f7fa;
  --sh:0 2px 16px rgba(26,39,68,.08);
  --sh-lg:0 8px 40px rgba(26,39,68,.18);
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Heebo',sans-serif;background:var(--cream);color:var(--text);min-height:100vh;direction:rtl}

/* LOGIN */
.login-screen{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--navy) 0%,#2a3f6b 100%)}
.login-box{background:var(--white);border-radius:20px;box-shadow:var(--sh-lg);padding:48px 40px;width:400px;max-width:95vw;text-align:center}
.login-logo{font-family:'Frank Ruhl Libre',serif;font-size:32px;color:var(--navy);margin-bottom:4px}
.login-sub{color:var(--muted);font-size:14px;margin-bottom:32px}
.login-form{display:flex;flex-direction:column;gap:14px;text-align:right}
.login-error{background:var(--danger-bg);color:var(--danger);padding:10px;border-radius:8px;font-size:13px;display:none}

/* TOPBAR */
.topbar{background:var(--navy);color:var(--white);padding:0 20px;height:58px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 2px 12px rgba(26,39,68,.3);position:sticky;top:0;z-index:200;flex-wrap:wrap;gap:6px}
.topbar-brand{font-family:'Frank Ruhl Libre',serif;font-size:20px;font-weight:700;color:var(--gold-l)}
.topbar-brand span{color:rgba(255,255,255,.6);font-weight:300;font-size:16px}
.topbar-right{display:flex;align-items:center;gap:14px}
.user-pill{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,.1);padding:5px 12px;border-radius:20px;font-size:13px}
.role-badge{font-size:10px;background:var(--gold);color:var(--navy);padding:2px 6px;border-radius:10px;font-weight:700}
.topbar-nav{display:flex;gap:4px;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;padding-bottom:1px}
.topbar-nav::-webkit-scrollbar{display:none}
.nav-btn{background:transparent;border:1px solid rgba(201,168,76,.3);color:rgba(255,255,255,.85);padding:6px 13px;border-radius:6px;cursor:pointer;font-family:'Heebo',sans-serif;font-size:13px;transition:all .2s}
.nav-btn:hover,.nav-btn.active{background:var(--gold);color:var(--navy);border-color:var(--gold);font-weight:700}
.logout-btn{background:none;border:none;color:rgba(255,255,255,.6);cursor:pointer;font-size:13px;font-family:'Heebo',sans-serif}
.logout-btn:hover{color:white}

/* PAGES */
.page{display:none;padding:16px 20px;min-height:calc(100vh - 90px)}
.page.active{display:block}

/* BUTTONS */
.btn{padding:8px 16px;border-radius:8px;font-family:'Heebo',sans-serif;font-size:13px;font-weight:600;cursor:pointer;border:none;transition:all .2s;display:inline-flex;align-items:center;gap:6px}
.btn-navy{background:var(--navy);color:white}.btn-navy:hover{background:var(--navy-h)}
.btn-gold{background:var(--gold);color:var(--navy)}.btn-gold:hover{background:var(--gold-l)}
.btn-outline{background:white;color:var(--navy);border:1.5px solid var(--border)}.btn-outline:hover{border-color:var(--navy)}
.btn-danger{background:var(--danger-bg);color:var(--danger)}.btn-danger:hover{background:var(--danger);color:white}
.btn-purple{background:var(--purple);color:white}.btn-purple:hover{background:#5b21b6}
.btn-success{background:var(--success);color:white}
.btn-sm{padding:5px 11px;font-size:12px;border-radius:6px}
.btn-icon{width:32px;height:32px;border-radius:7px;border:none;cursor:pointer;font-size:15px;display:inline-flex;align-items:center;justify-content:center;transition:all .2s}
.btn-icon.wa{background:#e8fdf2;color:#25d366}.btn-icon.wa:hover{background:#25d366;color:white}
.btn-icon.em{background:#e8f0fe;color:var(--navy)}.btn-icon.em:hover{background:var(--navy);color:white}

/* CARDS */
.card{background:var(--white);border-radius:12px;box-shadow:var(--sh);overflow:hidden;margin-bottom:16px}
.card-header{background:var(--navy);color:white;padding:14px 20px;display:flex;align-items:center;justify-content:space-between}
.card-header h3{font-family:'Frank Ruhl Libre',serif;font-size:17px}
.card-body{padding:20px}

/* STAT CARDS */
.stat-grid{display:grid;gap:14px;margin-bottom:20px}
.stat-card{background:var(--white);border-radius:12px;padding:18px 20px;box-shadow:var(--sh);border-top:3px solid var(--navy);cursor:default;transition:transform .15s,box-shadow .15s}
.stat-card.clickable{cursor:pointer}.stat-card.clickable:hover{transform:translateY(-2px);box-shadow:var(--sh-lg)}
.stat-card.gold{border-top-color:var(--gold)}
.stat-card.green{border-top-color:var(--success)}
.stat-card.orange{border-top-color:var(--warn)}
.stat-card.purple{border-top-color:var(--purple)}
.stat-card.red{border-top-color:var(--danger)}
.sv{font-family:'Frank Ruhl Libre',serif;font-size:28px;font-weight:700;color:var(--navy)}
.sv.green{color:var(--success)}.sv.red{color:var(--danger)}.sv.gold{color:#7a5c00}.sv.purple{color:var(--purple)}
.sl{font-size:12px;color:var(--muted);margin-top:3px}
.sl small{font-size:10px;color:var(--purple)}

/* TABLE */
.table-wrap{background:var(--white);border-radius:12px;box-shadow:var(--sh);overflow:hidden}
.table-info{padding:10px 18px;font-size:12px;color:var(--muted);border-bottom:1px solid var(--cream-d);display:flex;justify-content:space-between;align-items:center}
.table-scroll{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:13px}
thead{background:var(--navy);color:white;position:sticky;top:0;z-index:10}
th{padding:11px 12px;text-align:right;font-weight:600;font-size:12px;white-space:nowrap;cursor:pointer;user-select:none;transition:background .15s}
th:hover{background:var(--navy-l)}
th .si{font-size:10px;margin-right:3px;opacity:.5}
th.sorted .si{opacity:1;color:var(--gold-l)}
td{padding:9px 12px;border-bottom:1px solid var(--cream-d);white-space:nowrap;vertical-align:middle}
tr:hover td{background:#f8f6ff}
.row-actions{display:flex;gap:4px}

/* BADGES */
.badge{display:inline-block;padding:2px 8px;border-radius:20px;font-size:11px;font-weight:700}
.b-cash{background:var(--success-bg);color:var(--success)}
.b-credit{background:#e8f0fe;color:#1a56b0}
.b-check{background:#fff3e0;color:#b05e00}
.b-bank{background:#f3e5f5;color:#7b1fa2}
.b-other{background:var(--cream-d);color:var(--muted)}

/* TOOLBAR */
.toolbar{background:var(--white);border-radius:12px;padding:14px 18px;box-shadow:var(--sh);margin-bottom:16px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.search-input{flex:1;min-width:200px;padding:8px 14px;border:1.5px solid var(--border);border-radius:8px;font-family:'Heebo',sans-serif;font-size:14px;outline:none;transition:border-color .2s}
.search-input:focus{border-color:var(--navy)}
.filter-select{padding:7px 10px;border:1.5px solid var(--border);border-radius:7px;font-family:'Heebo',sans-serif;font-size:13px;outline:none;background:white;cursor:pointer}
.filter-select:focus{border-color:var(--navy)}
.filter-clear{background:none;border:none;color:var(--muted);cursor:pointer;font-size:12px;font-family:'Heebo',sans-serif;text-decoration:underline}

/* MODAL */
.modal-overlay{position:fixed;inset:0;background:rgba(26,39,68,.55);display:flex;align-items:center;justify-content:center;z-index:500;opacity:0;pointer-events:none;transition:opacity .2s}
.modal-overlay.open{opacity:1;pointer-events:all}
.modal{background:var(--white);border-radius:16px;box-shadow:var(--sh-lg);width:700px;max-width:96vw;max-height:90vh;overflow:hidden;transform:translateY(24px);transition:transform .25s;display:flex;flex-direction:column}
.modal-body{overflow-y:auto;flex:1}
.modal-footer{flex-shrink:0}
.modal-overlay.open .modal{transform:translateY(0)}
.modal-sm{width:460px}.modal-lg{width:920px}
.modal-header{background:linear-gradient(135deg,#243868,#1e3258);color:white;padding:16px 24px;display:flex;align-items:center;justify-content:space-between;border-radius:16px 16px 0 0;position:sticky;top:0;z-index:10}
.modal-header h3{font-family:'Frank Ruhl Libre',serif;font-size:19px}
.modal-close{background:none;border:none;color:rgba(255,255,255,.7);font-size:22px;cursor:pointer;line-height:1}
.modal-close:hover{color:white}
.modal-body{padding:24px}
.modal-footer{padding:14px 24px;border-top:1px solid var(--border);display:flex;gap:8px;justify-content:flex-end;background:var(--cream);border-radius:0 0 16px 16px}

/* TABS */
.tabs{display:flex;border-bottom:2px solid var(--border);margin-bottom:20px}
.tab{padding:9px 18px;cursor:pointer;font-size:13px;font-weight:600;color:var(--muted);border-bottom:2px solid transparent;margin-bottom:-2px;transition:all .2s}
.tab.active{color:var(--navy);border-bottom-color:var(--navy)}

/* FORM */
.fg{display:flex;flex-direction:column;gap:4px}
.fg.full{grid-column:1/-1}.fg.half{grid-column:span 2}
.form-label{font-size:11px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.4px}
.form-control{padding:8px 11px;border:1.5px solid var(--border);border-radius:8px;font-family:'Heebo',sans-serif;font-size:13px;color:var(--text);background:var(--white);outline:none;transition:border-color .2s,box-shadow .2s;width:100%}
.form-control:focus{border-color:var(--navy);box-shadow:0 0 0 3px rgba(26,39,68,.07)}
.form-control[readonly]{background:var(--cream);cursor:not-allowed}
.ig{display:flex;gap:6px;align-items:center}.ig .form-control{flex:1}
.req{color:var(--danger)}
.fg3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.fg2{display:grid;grid-template-columns:1fr 1fr;gap:14px}

/* DONOR STATS */
.d-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px}
.d-stat{background:var(--cream);border-radius:9px;padding:12px 14px;text-align:center}
.d-stat .sv{font-size:20px}.d-stat .sl{font-size:11px}

/* FUTURE ITEM */
.future-item{background:var(--purple-bg);border:1px solid #c4b5fd;border-radius:10px;padding:12px 16px;margin-bottom:8px;display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
.future-item-info{flex:1}
.future-item-info .fi-date{font-weight:700;font-size:13px;color:var(--purple)}
.future-item-info .fi-heb{font-size:11px;color:var(--muted);margin-top:1px}
.future-item-info .fi-amount{font-size:13px;margin-top:4px}
.future-item-info .fi-notes{font-size:12px;color:var(--muted);margin-top:3px;white-space:pre-wrap}
.future-item-actions{display:flex;gap:5px;flex-shrink:0}

/* ADMIN GRID */
.admin-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:24px}
.admin-card{background:var(--white);border-radius:12px;padding:20px;box-shadow:var(--sh);border-top:3px solid var(--border);cursor:pointer;transition:all .2s}
.admin-card:hover{border-top-color:var(--navy);transform:translateY(-2px);box-shadow:var(--sh-lg)}
.admin-card .ac-icon{font-size:30px;margin-bottom:10px}
.admin-card h3{font-size:15px;font-weight:700;margin-bottom:4px}
.admin-card p{font-size:12px;color:var(--muted)}

/* CAMPAIGN PANEL */
.camp-goal{font-family:'Frank Ruhl Libre',serif;font-size:48px;font-weight:900;text-align:center;margin:8px 0}
.camp-goal.over{color:var(--success)}.camp-goal.under{color:var(--danger)}
.progress-bar{height:16px;background:var(--cream-d);border-radius:20px;overflow:hidden;margin:8px 0}
.progress-fill{height:100%;border-radius:20px;transition:width .5s ease;background:linear-gradient(90deg,var(--navy),var(--gold))}
.progress-fill.over{background:linear-gradient(90deg,var(--success),#52c41a)}
.camp-stat{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cream-d)}
.camp-stat:last-child{border:none}

/* DATE */
.date-cell{display:flex;flex-direction:column}
.date-heb{font-size:10px;color:var(--muted)}

/* USERS TABLE */
.users-table{width:100%;border-collapse:collapse}
.users-table th{background:var(--cream);padding:9px 12px;text-align:right;font-size:12px;font-weight:700;color:var(--muted);border-bottom:2px solid var(--border)}
.users-table td{padding:10px 12px;border-bottom:1px solid var(--cream-d)}

/* INLINE SETTINGS */
.setting-item{display:flex;gap:6px;margin-bottom:6px}
.setting-item .form-control{flex:1}


/* ══════════════ MOBILE RESPONSIVE ══════════════ */
@media (max-width: 768px) {
  /* Topbar */
  .topbar { height: auto; min-height: 52px; padding: 6px 12px; gap: 4px; }
  .topbar-brand { font-size: 16px; }
  .topbar-brand span { font-size: 13px; }
  .topbar-right { gap: 8px; }
  .topbar-nav { gap: 2px; overflow-x: auto; scrollbar-width: none; padding-bottom: 2px; }
  .topbar-nav::-webkit-scrollbar { display: none; }
  .nav-btn { padding: 6px 10px; font-size: 11px; white-space: nowrap; flex-shrink: 0; min-height: 34px; }

  /* Pages */
  .page { padding: 10px 10px; min-height: auto; }

  /* Stats */
  .stat-grid, .sg, .dash-stats { grid-template-columns: repeat(2, 1fr) !important; }
  .stat-card, .sc { padding: 10px; }

  /* Toolbar — vertical stack */
  .toolbar { flex-direction: column; align-items: stretch; gap: 6px; flex-wrap: wrap; }
  .toolbar > * { width: 100%; }
  .toolbar .btn { width: 100%; justify-content: center; }
  .search-input, .si-input { min-width: 0 !important; width: 100% !important; }

  /* Tables — scroll horizontally, hide less important columns */
  .table-wrap, .tw { overflow: hidden; border-radius: 10px; }
  .table-scroll, .ts { overflow-x: auto; -webkit-overflow-scrolling: touch; }
  table { min-width: 500px; }

  /* Modals full screen bottom sheet */
  .modal-overlay { align-items: flex-end !important; padding: 0; }
  .modal, .modal.modal-sm, .modal.modal-lg, .modal.modal-xl {
    width: 100% !important; max-width: 100vw !important;
    max-height: 93vh !important; border-radius: 18px 18px 0 0 !important;
  }
  .modal-header, .mh { border-radius: 18px 18px 0 0 !important; padding: 14px 16px; }
  .modal-body { padding: 14px 16px; }

  /* Form grids */
  .form-grid, .fg3 { grid-template-columns: 1fr 1fr !important; }
  .form-grid-2, .fg2 { grid-template-columns: 1fr !important; }
  .fg4 { grid-template-columns: 1fr 1fr !important; }
  .fg.full, .fg.half { grid-column: 1 / -1; }

  /* Donor stats in card */
  .donor-stats, .d-stats { grid-template-columns: repeat(3, 1fr); gap: 6px; }
  .d-stat .sv { font-size: 15px; }

  /* Admin grid */
  .admin-grid, .ag { grid-template-columns: repeat(2, 1fr) !important; gap: 10px; }
  .ac, .admin-card { padding: 12px 10px; }
  .admin-card .ac-icon { font-size: 24px; }
  .admin-card h3 { font-size: 12px; }
  .admin-card p { font-size: 10px; }

  /* Campaign */
  .camp-goal { font-size: 32px; }
  .camp-bar-wrap { height: 16px; }

  /* Groups */
  .grp-card { padding: 12px; }

  /* Row actions always visible on mobile */
  .row-actions { opacity: 1 !important; visibility: visible !important; position: static !important; flex-wrap: wrap; gap: 4px; }

  /* Top10 */
  .t10 { min-width: 0; }

  /* Future item */
  .future-item, .fi { flex-direction: column; }
  .future-item-actions { margin-top: 8px; }

  /* Tabs */
  .modal-tabs, .tabs { overflow-x: auto; flex-wrap: nowrap; -webkit-overflow-scrolling: touch; gap: 2px; }
  .modal-tab, .tab { white-space: nowrap; flex-shrink: 0; padding: 7px 12px; font-size: 12px; }

  /* Donor modal header buttons */
  .donor-modal-btns { flex-wrap: wrap; gap: 4px; }
  .donor-modal-btns .btn { font-size: 11px; padding: 5px 8px; }

  /* Table action buttons */
  table .btn { padding: 4px 8px; font-size: 11px; }
  table td { padding: 6px 8px; font-size: 12px; }
  table th { padding: 7px 8px; font-size: 11px; }

  /* Donor cards (mobile-only card view) */
  .donor-card-mobile { display: block !important; }
  .donor-table-desktop { display: none !important; }
  .dc-m { background: var(--white); border: 1px solid var(--border); border-radius: 12px; padding: 12px 14px; margin-bottom: 8px; cursor: pointer; transition: box-shadow .15s; }
  .dc-m:active { box-shadow: 0 0 0 2px var(--navy); }
  .dc-m-name { font-weight: 700; font-size: 14px; color: var(--navy); }
  .dc-m-detail { font-size: 12px; color: var(--muted); margin-top: 2px; }
  .dc-m-amount { font-weight: 700; color: var(--success); font-size: 13px; }
  .dc-m-btns { display: flex; gap: 6px; margin-top: 8px; }
  .dc-m-btns .btn { flex: 1; font-size: 11px; padding: 5px; justify-content: center; }
}

@media (max-width: 480px) {
  .stat-grid, .sg { grid-template-columns: 1fr 1fr !important; }
  .form-grid, .fg3 { grid-template-columns: 1fr !important; }
  .fg4 { grid-template-columns: 1fr 1fr !important; }
  .topbar-nav { justify-content: flex-start; }
  .d-stats, .donor-stats { grid-template-columns: repeat(2, 1fr) !important; }
  .page { padding: 8px; }
  .topbar-brand { font-size: 14px; }
  table th:nth-child(n+5), table td:nth-child(n+5) { display: none; }
  /* Keep name, address, phone, actions visible */
  table th:nth-child(1), table th:nth-child(2), table th:nth-child(3), table th:nth-child(4),
  table td:nth-child(1), table td:nth-child(2), table td:nth-child(3), table td:nth-child(4) { display: table-cell !important; }
}




/* ── Multi-filter dropdown ── */
.col-pick-cb { display:inline-flex;align-items:center;gap:5px;padding:5px 10px;background:var(--cream);border:1px solid var(--border);border-radius:20px;cursor:pointer;font-size:12px;transition:background .15s; }
.col-pick-cb:hover { background:var(--cream-d); }
.col-pick-cb input { cursor:pointer; }
.multi-filter-drop { position:absolute;top:calc(100% + 4px);right:0;z-index:300;background:white;border:1.5px solid var(--border);border-radius:10px;box-shadow:0 6px 24px rgba(0,0,0,.12);min-width:200px;max-width:280px; }
.multi-filter-search { width:100%;padding:8px 10px;border:none;border-bottom:1px solid var(--border);border-radius:10px 10px 0 0;font-family:Heebo,sans-serif;font-size:12px;outline:none;box-sizing:border-box; }
.multi-filter-opts { max-height:200px;overflow-y:auto;padding:6px 4px; }
.multi-filter-opt { display:flex;align-items:center;gap:8px;padding:6px 10px;cursor:pointer;border-radius:6px;font-size:12px;transition:background .1s; }
.multi-filter-opt:hover { background:var(--cream); }
.multi-filter-opt input { cursor:pointer;flex-shrink:0; }
.multi-filter-footer { display:flex;gap:6px;padding:6px 8px;border-top:1px solid var(--border); }
.multi-filter-footer button { flex:1;padding:4px;font-size:11px;border:1px solid var(--border);background:white;border-radius:5px;cursor:pointer;font-family:Heebo,sans-serif; }
.multi-filter-footer button:hover { background:var(--cream); }

/* PRINT */
@media print{.topbar,.toolbar,.row-actions,.nav-btn,.btn,.modal-overlay{display:none!important}.page{padding:0}.table-wrap{box-shadow:none;border:1px solid #ccc}}

/* SCROLLBAR */
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:var(--cream)}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}


/* ── Select with + button ── */
.sel-wrap { display:flex; gap:5px; align-items:center; }
.sel-wrap select { flex:1; }
.sel-add-btn { flex-shrink:0; width:28px; height:28px; background:var(--gold); border:none; border-radius:6px;
  cursor:pointer; font-size:16px; color:var(--navy); font-weight:700; display:flex; align-items:center; justify-content:center; }
.sel-add-btn:hover { background:var(--gold-l); }

.col-pick{display:flex;align-items:center;gap:5px;font-size:12px;background:var(--cream);padding:4px 10px;border-radius:6px;cursor:pointer;border:1px solid var(--border);}
.col-pick:hover{background:var(--cream-d);}
.col-pick input{cursor:pointer;}
.add-opt-row{display:none;gap:5px;margin-top:4px;align-items:center}
.add-opt-row input{flex:1}
.add-opt-row.visible{display:flex}
.card-header{background:linear-gradient(135deg,#1e3a5f,#162d4a)!important}
.sub-modal-header{background:linear-gradient(135deg,#2d4a7a,#1e3258);color:white;padding:10px 16px;border-radius:10px 10px 0 0;display:flex;align-items:center;justify-content:space-between}

@media print {
  tr { page-break-inside: avoid; }
  td { 
    white-space: normal !important;
    word-wrap: break-word;
    max-height: calc(3 * 1.4em);
    overflow: hidden;
    line-height: 1.4;
  }
  table { page-break-inside: auto; }
}

/* ══ SIDEBAR NAV ══ */
#appWrapper { display:flex; flex-direction:row; min-height:100vh; }
#sidebar {
  width:220px; min-height:100vh; background:var(--navy);
  display:flex; flex-direction:column; transition:width .25s;
  position:fixed; right:0; top:0; z-index:200; overflow:hidden;
  box-shadow:-3px 0 15px rgba(0,0,0,.2);
}
#sidebar.collapsed { width:58px; }
#sidebar .sb-brand {
  padding:14px 16px 12px; display:flex; align-items:center; gap:10px;
  border-bottom:1px solid rgba(255,255,255,.12);
}
#sidebar .sb-brand-text { color:white; font-size:13px; font-weight:700; transition:opacity .2s; white-space:nowrap; overflow:hidden; }
#sidebar.collapsed .sb-brand-text { opacity:0; width:0; }
#sidebar .sb-toggle {
  background:none; border:none; color:rgba(255,255,255,.7); cursor:pointer;
  font-size:18px; padding:4px 6px; border-radius:6px; flex-shrink:0;
}
#sidebar .sb-toggle:hover { background:rgba(255,255,255,.15); }
#sidebar .sb-nav { flex:1; padding:8px 0; overflow-y:auto; }
#sidebar .sb-item {
  display:flex; align-items:center; gap:12px; padding:10px 16px;
  color:rgba(255,255,255,.75); cursor:pointer; transition:all .15s;
  border:none; background:none; width:100%; text-align:right;
  white-space:nowrap; font-size:13px; font-weight:500;
  border-right:3px solid transparent;
}
#sidebar .sb-item:hover { background:rgba(255,255,255,.1); color:white; }
#sidebar .sb-item.active { background:rgba(201,168,76,.2); color:var(--gold-l); border-right-color:var(--gold); }
#sidebar .sb-icon { font-size:20px; flex-shrink:0; width:24px; text-align:center; }
#sidebar .sb-label { transition:opacity .2s; overflow:hidden; }
#sidebar.collapsed .sb-label { opacity:0; width:0; }
#sidebar .sb-divider { border:none; border-top:1px solid rgba(255,255,255,.1); margin:6px 0; }
#sidebar .sb-user {
  padding:10px 14px; border-top:1px solid rgba(255,255,255,.12);
  color:rgba(255,255,255,.7); font-size:11px; white-space:nowrap; overflow:hidden;
}
#sidebar.collapsed .sb-user-text { opacity:0; }
#mainContent { 
  flex:1; margin-right:220px; transition:margin-right .25s; min-height:100vh;
  display:flex; flex-direction:column;
}
#mainContent.expanded { margin-right:58px; }
@media(max-width:700px){
  #sidebar{width:58px!important;}
  #sidebar .sb-label{opacity:0!important;width:0!important;}
  #mainContent{margin-right:58px!important;}
}
/* ── TEAL CARD ── */
.stat-card.teal { border-top-color: var(--teal); }
.stat-card.teal .stat-val { color: var(--teal); }

/* ── PICK LIST ── */
.pick-results { max-height: 160px; overflow-y: auto; margin-top: 4px; }
.pick-item { padding: 7px 10px; cursor: pointer; border-radius: 7px; background: var(--cream); margin-bottom: 4px; border: 1px solid var(--border); font-size: 13px; }
.pick-item:hover { background: var(--cream-d); }

/* ── TOP 10 TABLE ── */
.t10 { width: 100%; border-collapse: collapse; font-size: 12px; }
.t10 th { padding: 6px 10px; background: var(--cream-d); text-align: right; font-weight: 700; font-size: 11px; }
.t10 td { padding: 6px 10px; border-bottom: 1px solid var(--cream-d); }
.t10 .rank { font-size: 16px; font-weight: 900; color: var(--muted); font-family: "Frank Ruhl Libre", serif; }

/* ── GROUP CARD ── */
.grp-card { background: var(--white); border-radius: 11px; box-shadow: var(--sh); padding: 14px; margin-bottom: 10px; border-right: 4px solid var(--teal); }

/* ── CAMPAIGN GOAL ── */
.camp-goal { font-family: "Frank Ruhl Libre", serif; font-size: 48px; font-weight: 900; text-align: center; margin: 8px 0; }
.camp-goal.over { color: var(--success); }
.camp-goal.under { color: var(--danger); }
.camp-stat { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--cream-d); }
.camp-stat:last-child { border: none; }

/* Rich Email Editor */
.re-btn{padding:3px 8px;border:1px solid var(--border);border-radius:5px;background:white;cursor:pointer;font-size:12px;font-family:Heebo,sans-serif;color:var(--navy);transition:all .15s}
.wiz-type-card:hover{border-color:var(--navy)!important;background:var(--cream)!important}
.wiz-type-card.selected{border-color:var(--gold)!important;background:var(--gold-bg)!important;box-shadow:0 0 0 2px var(--gold)}
.wiz-step.active{border-bottom-color:var(--navy)!important;color:var(--navy)!important}
.wiz-step.done{border-bottom-color:var(--gold)!important;color:var(--gold)!important}
.wiz-col-cb{display:flex;align-items:center;gap:6px;padding:4px 8px;border-radius:5px;font-size:12px;cursor:pointer;transition:background .15s}
.wiz-col-cb:hover{background:var(--cream)}
.quick-export-bar{display:flex;align-items:center;gap:8px;padding:5px 0 8px}
.re-btn:hover{background:var(--navy);color:white}
.re-btn.re-field{background:var(--gold-bg);border-color:var(--gold);color:var(--navy);font-size:11px}
.re-btn.re-field:hover{background:var(--gold);color:white}
[contenteditable]:empty:before{content:attr(data-placeholder);color:#aaa;pointer-events:none}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="login-screen" id="loginScreen">
  <div class="login-box">
    <div class="login-logo"><img src="data:image/jpeg;base64,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c2x0VW50RiNQeGxAUgAAAAAAAAAAAAp2ZWN0b3JEYXRhYm9vbAEAAAAAUGdQc2VudW0AAAAAUGdQcwAAAABQZ1BDAAAAAExlZnRVbnRGI1JsdAAAAAAAAAAAAAAAAFRvcCBVbnRGI1JsdAAAAAAAAAAAAAAAAFNjbCBVbnRGI1ByY0BZAAAAAAAAOEJJTQPtAAAAAAAQAEgAAAABAAIASAAAAAEAAjhCSU0EJgAAAAAADgAAAAAAAAAAAAA/gAAAOEJJTQQNAAAAAAAEAAAAeDhCSU0EGQAAAAAABAAAAB44QklNA/MAAAAAAAkAAAAAAAAAAAEAOEJJTScQAAAAAAAKAAEAAAAAAAAAAjhCSU0D9QAAAAAASAAvZmYAAQBsZmYABgAAAAAAAQAvZmYAAQChmZoABgAAAAAAAQAyAAAAAQBaAAAABgAAAAAAAQA1AAAAAQAtAAAABgAAAAAAAThCSU0D+AAAAAAAcAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAA4QklNBAAAAAAAAAIAAThCSU0EAgAAAAAABAAAAAA4QklNBDAAAAAAAAIBAThCSU0ELQAAAAAABgABAAAABDhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAANJAAAABgAAAAAAAAAAAAAAngAAAMgAAAAKAFUAbgB0AGkAdABsAGUAZAAtADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAMgAAACeAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAACeAAAAAFJnaHRsb25nAAAAyAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElE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ZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgeG1wOkNyZWF0ZURhdGU9IjIwMTktMDQtMDhUMjA6NTM6MDUrMDM6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMDQtMDhUMjA6NTM6MDUrMDM6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTA0LTA4VDIwOjUzOjA1KzAzOjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkIxRjBDRTBFRjk1OUU5MTFCMjQ2QjMzNjkzODBBQ0U5IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkIwRjBDRTBFRjk1OUU5MTFCMjQ2QjMzNjkzODBBQ0U5IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6QjBGMENFMEVGOTU5RTkxMUIyNDZCMzM2OTM4MEFDRTkiIGRjOmZvcm1hdD0iaW1hZ2UvanBlZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMEYwQ0UwRUY5NTlFOTExQjI0NkIzMzY5MzgwQUNFOSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0wOFQyMDo1MzowNSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMUYwQ0UwRUY5NTlFOTExQjI0NkIzMzY5MzgwQUNFOSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0wOFQyMDo1MzowNSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAA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QAA8USmfiYcB0A+Z+aX0ybZt8pqf7Rwf+Mqfl5ny4ceGyd8RviJj9q4/GyzYyOMxxwnmIADSB/VeLW9y91HPVwW19rUeDo4YYYkQIigWUDkD6/Qe/de6WX04Hv3Xuve/de697917r3v3Xuve/de697917r3v3Xuve/de697917r/0t/j37r3Xvfuvde9+691737r3Xvfuvde9+691737r3Xvfuvde9+691737r3WCo8JjPmKhbclvp7917opPeVH1lPi6sbhy9DRAo+ppaarlK+k34gpZbj377OvdUTdnYD4jt3Vt6KPffXcfeUvXe8JNiVL4TIP29TdVRVsI3fBswjG/wAfO36h2kK/bwyTimWu+ydKb+IAxlfwciNzJ9TdXtJ1mUSRBX+ma4PwPKwUxBx+IFwpahcahQjG2k5mGyvFBbsbQrUPUawnmFFdRB8jSoHDFKGj+LeD+NsE1GcFvXC1zXj0CLFZuG44tpNRiIhb3Jv29A7q6nY0W2Y8fTjD1VNPEI10mOORL8CxPkiQ2/p7917oSRawt9Pfuvdd+/de697917r3v3Xuve/de697917r3v3Xuve/de697917r3v3Xuv/2Q==" style="height:90px;margin-bottom:4px"><div style="font-size:20px;font-weight:900;color:var(--navy)">עזר תורה</div></div>
    <div class="login-sub">תושיה תפרח — כניסה למערכת</div>
    <div class="login-form" id="loginFormBox">
      <div class="fg"><label class="form-label">כתובת מייל</label><input class="form-control" id="loginEmail" type="email" placeholder="your@email.com" onkeydown="if(event.key==='Enter')doLogin()"></div>
      <div class="fg"><label class="form-label">סיסמה</label><input class="form-control" type="password" id="loginPass" placeholder="סיסמה" onkeydown="if(event.key==='Enter')doLogin()"></div>
      <label style="display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted);cursor:pointer"><input type="checkbox" id="rememberMe"> זכור אותי</label>
      <div class="login-error" id="loginError">כתובת מייל או סיסמה שגויים</div>
      <button class="btn btn-navy" onclick="doLogin()" id="loginBtn" style="padding:11px;justify-content:center">כניסה</button>
      <button type="button" onclick="showForgotPassword()" style="background:none;border:none;color:var(--muted);font-size:12px;cursor:pointer;font-family:Heebo,sans-serif;text-decoration:underline;margin-top:-6px">שכחתי סיסמה</button>
    </div>
    <!-- Forgot Password Form -->
    <div class="login-form" id="forgotPassBox" style="display:none" dir="rtl">
      <div style="text-align:center;margin-bottom:12px">
        <div style="font-size:20px">🔑</div>
        <div style="font-weight:700;margin-top:4px">שחזור סיסמה</div>
        <div style="font-size:12px;color:var(--muted);margin-top:4px">נשלח קישור לאיפוס סיסמה למייל שלך</div>
      </div>
      <div class="fg"><label class="form-label">כתובת מייל</label><input class="form-control" id="forgotEmail" type="email" placeholder="your@email.com"></div>
      <div id="forgotMsg" style="font-size:12px;text-align:center;display:none"></div>
      <button class="btn btn-navy" onclick="sendForgotPassword()" style="justify-content:center">שלח קישור</button>
      <button type="button" onclick="showLoginForm()" style="background:none;border:none;color:var(--muted);font-size:12px;cursor:pointer;font-family:Heebo,sans-serif;text-decoration:underline">← חזרה לכניסה</button>
    </div>
  </div>
</div>

<!-- APP -->
<div id="appWrapper" style="display:none">

<!-- SIDEBAR -->
<aside id="sidebar">
  <div class="sb-brand">
    <button class="sb-toggle" onclick="toggleSidebar()" title="הצג/הסתר תפריט">☰</button>
    <span class="sb-brand-text"><img src="data:image/jpeg;base64,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c2x0VW50RiNQeGxAUgAAAAAAAAAAAAp2ZWN0b3JEYXRhYm9vbAEAAAAAUGdQc2VudW0AAAAAUGdQcwAAAABQZ1BDAAAAAExlZnRVbnRGI1JsdAAAAAAAAAAAAAAAAFRvcCBVbnRGI1JsdAAAAAAAAAAAAAAAAFNjbCBVbnRGI1ByY0BZAAAAAAAAOEJJTQPtAAAAAAAQAEgAAAABAAIASAAAAAEAAjhCSU0EJgAAAAAADgAAAAAAAAAAAAA/gAAAOEJJTQQNAAAAAAAEAAAAeDhCSU0EGQAAAAAABAAAAB44QklNA/MAAAAAAAkAAAAAAAAAAAEAOEJJTScQAAAAAAAKAAEAAAAAAAAAAjhCSU0D9QAAAAAASAAvZmYAAQBsZmYABgAAAAAAAQAvZmYAAQChmZoABgAAAAAAAQAyAAAAAQBaAAAABgAAAAAAAQA1AAAAAQAtAAAABgAAAAAAAThCSU0D+AAAAAAAcAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAA4QklNBAAAAAAAAAIAAThCSU0EAgAAAAAABAAAAAA4QklNBDAAAAAAAAIBAThCSU0ELQAAAAAABgABAAAABDhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAANJAAAABgAAAAAAAAAAAAAAngAAAMgAAAAKAFUAbgB0AGkAdABsAGUAZAAtADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAMgAAACeAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAACeAAAAAFJnaHRsb25nAAAAyAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElE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ZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgeG1wOkNyZWF0ZURhdGU9IjIwMTktMDQtMDhUMjA6NTM6MDUrMDM6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMDQtMDhUMjA6NTM6MDUrMDM6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTA0LTA4VDIwOjUzOjA1KzAzOjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkIxRjBDRTBFRjk1OUU5MTFCMjQ2QjMzNjkzODBBQ0U5IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkIwRjBDRTBFRjk1OUU5MTFCMjQ2QjMzNjkzODBBQ0U5IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6QjBGMENFMEVGOTU5RTkxMUIyNDZCMzM2OTM4MEFDRTkiIGRjOmZvcm1hdD0iaW1hZ2UvanBlZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMEYwQ0UwRUY5NTlFOTExQjI0NkIzMzY5MzgwQUNFOSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0wOFQyMDo1MzowNSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMUYwQ0UwRUY5NTlFOTExQjI0NkIzMzY5MzgwQUNFOSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0wOFQyMDo1MzowNSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAA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QAA8USmfiYcB0A+Z+aX0ybZt8pqf7Rwf+Mqfl5ny4ceGyd8RviJj9q4/GyzYyOMxxwnmIADSB/VeLW9y91HPVwW19rUeDo4YYYkQIigWUDkD6/Qe/de6WX04Hv3Xuve/de697917r3v3Xuve/de697917r3v3Xuve/de697917r/0t/j37r3Xvfuvde9+691737r3Xvfuvde9+691737r3Xvfuvde9+691737r3WCo8JjPmKhbclvp7917opPeVH1lPi6sbhy9DRAo+ppaarlK+k34gpZbj377OvdUTdnYD4jt3Vt6KPffXcfeUvXe8JNiVL4TIP29TdVRVsI3fBswjG/wAfO36h2kK/bwyTimWu+ydKb+IAxlfwciNzJ9TdXtJ1mUSRBX+ma4PwPKwUxBx+IFwpahcahQjG2k5mGyvFBbsbQrUPUawnmFFdRB8jSoHDFKGj+LeD+NsE1GcFvXC1zXj0CLFZuG44tpNRiIhb3Jv29A7q6nY0W2Y8fTjD1VNPEI10mOORL8CxPkiQ2/p7917oSRawt9Pfuvdd+/de697917r3v3Xuve/de697917r3v3Xuve/de697917r3v3Xuv/2Q==" style="height:22px;border-radius:3px;margin-left:5px;vertical-align:middle"> עזר תורה</span>
  </div>
  <nav class="sb-nav">
    <button class="sb-item active" id="sb-dash" onclick="showPage('dash')"><span class="sb-icon">🏠</span><span class="sb-label">ראשי</span></button>
    <button class="sb-item" id="sb-donors" onclick="showPage('donors')"><span class="sb-icon">👥</span><span class="sb-label">תורמים</span></button>
    <button class="sb-item" id="sb-donations" onclick="showPage('donations')"><span class="sb-icon">💰</span><span class="sb-label">תרומות</span></button>
    <button class="sb-item" id="sb-campaign" onclick="showPage('campaign')"><span class="sb-icon">🎯</span><span class="sb-label">מגביות</span></button>
    <button class="sb-item" id="sb-future" onclick="showPage('future')"><span class="sb-icon">⭐</span><span class="sb-label">עתידיות</span></button>
    <hr class="sb-divider">
    <button class="sb-item" id="sb-fundraisers" onclick="showPage('fundraisers')"><span class="sb-icon">🎓</span><span class="sb-label">מתרימים</span></button>
    <button class="sb-item" id="sb-messages" onclick="showPage('messages')"><span class="sb-icon">✉️</span><span class="sb-label">הודעות <span id="sbUnreadBadge" style="display:none;background:var(--danger);color:white;border-radius:10px;padding:1px 6px;font-size:10px;font-weight:700"></span></span></button>
    <hr class="sb-divider">
    <button class="sb-item" id="sb-exportwiz" onclick="openExportWizard()"><span class="sb-icon">🖨️</span><span class="sb-label">ייצוא/הדפסה</span></button>
    <button class="sb-item" id="sb-admin" onclick="showPage('admin'); setTimeout(checkCloudStatus, 500);"><span class="sb-icon">⚙️</span><span class="sb-label">ניהול</span></button>
  </nav>
  <div class="sb-user">
    <div style="display:flex;align-items:center;gap:8px;padding:8px 0">
      <span style="font-size:18px;flex-shrink:0">👤</span>
      <div class="sb-user-text">
        <div id="sbUserName" style="font-weight:600;color:white;font-size:12px;white-space:nowrap"></div>
        <div id="sbUserRole" style="font-size:10px;opacity:.6;white-space:nowrap"></div>
      </div>
    </div>
    <button onclick="doLogout()" class="sb-item" style="padding:6px 8px;font-size:11px;opacity:.7;width:100%">
      <span class="sb-icon" style="font-size:16px">↩</span><span class="sb-label">יציאה</span>
    </button>
  </div>
</aside>

<!-- MAIN CONTENT -->
<div id="mainContent">
<div id="app" style="display:block">

<!-- TOPBAR -->
<div class="topbar" style="padding:8px 16px;position:sticky;top:0;z-index:100">
  <div style="display:flex;align-items:center;justify-content:space-between">
    <div class="topbar-brand"><img src="data:image/jpeg;base64,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c2x0VW50RiNQeGxAUgAAAAAAAAAAAAp2ZWN0b3JEYXRhYm9vbAEAAAAAUGdQc2VudW0AAAAAUGdQcwAAAABQZ1BDAAAAAExlZnRVbnRGI1JsdAAAAAAAAAAAAAAAAFRvcCBVbnRGI1JsdAAAAAAAAAAAAAAAAFNjbCBVbnRGI1ByY0BZAAAAAAAAOEJJTQPtAAAAAAAQAEgAAAABAAIASAAAAAEAAjhCSU0EJgAAAAAADgAAAAAAAAAAAAA/gAAAOEJJTQQNAAAAAAAEAAAAeDhCSU0EGQAAAAAABAAAAB44QklNA/MAAAAAAAkAAAAAAAAAAAEAOEJJTScQAAAAAAAKAAEAAAAAAAAAAjhCSU0D9QAAAAAASAAvZmYAAQBsZmYABgAAAAAAAQAvZmYAAQChmZoABgAAAAAAAQAyAAAAAQBaAAAABgAAAAAAAQA1AAAAAQAtAAAABgAAAAAAAThCSU0D+AAAAAAAcAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAA4QklNBAAAAAAAAAIAAThCSU0EAgAAAAAABAAAAAA4QklNBDAAAAAAAAIBAThCSU0ELQAAAAAABgABAAAABDhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAANJAAAABgAAAAAAAAAAAAAAngAAAMgAAAAKAFUAbgB0AGkAdABsAGUAZAAtADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAMgAAACeAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAACeAAAAAFJnaHRsb25nAAAAyAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElE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ZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgeG1wOkNyZWF0ZURhdGU9IjIwMTktMDQtMDhUMjA6NTM6MDUrMDM6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMDQtMDhUMjA6NTM6MDUrMDM6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTA0LTA4VDIwOjUzOjA1KzAzOjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkIxRjBDRTBFRjk1OUU5MTFCMjQ2QjMzNjkzODBBQ0U5IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkIwRjBDRTBFRjk1OUU5MTFCMjQ2QjMzNjkzODBBQ0U5IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6QjBGMENFMEVGOTU5RTkxMUIyNDZCMzM2OTM4MEFDRTkiIGRjOmZvcm1hdD0iaW1hZ2UvanBlZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMEYwQ0UwRUY5NTlFOTExQjI0NkIzMzY5MzgwQUNFOSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0wOFQyMDo1MzowNSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMUYwQ0UwRUY5NTlFOTExQjI0NkIzMzY5MzgwQUNFOSIgc3RFdnQ6d2hlbj0iMjAxOS0wNC0wOFQyMDo1MzowNSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAA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QAA8USmfiYcB0A+Z+aX0ybZt8pqf7Rwf+Mqfl5ny4ceGyd8RviJj9q4/GyzYyOMxxwnmIADSB/VeLW9y91HPVwW19rUeDo4YYYkQIigWUDkD6/Qe/de6WX04Hv3Xuve/de697917r3v3Xuve/de697917r3v3Xuve/de697917r/0t/j37r3Xvfuvde9+691737r3Xvfuvde9+691737r3Xvfuvde9+691737r3WCo8JjPmKhbclvp7917opPeVH1lPi6sbhy9DRAo+ppaarlK+k34gpZbj377OvdUTdnYD4jt3Vt6KPffXcfeUvXe8JNiVL4TIP29TdVRVsI3fBswjG/wAfO36h2kK/bwyTimWu+ydKb+IAxlfwciNzJ9TdXtJ1mUSRBX+ma4PwPKwUxBx+IFwpahcahQjG2k5mGyvFBbsbQrUPUawnmFFdRB8jSoHDFKGj+LeD+NsE1GcFvXC1zXj0CLFZuG44tpNRiIhb3Jv29A7q6nY0W2Y8fTjD1VNPEI10mOORL8CxPkiQ2/p7917oSRawt9Pfuvdd+/de697917r3v3Xuve/de697917r3v3Xuve/de697917r3v3Xuv/2Q==" style="height:34px;margin-left:8px;border-radius:4px"> עזר תורה <span>| תושיה תפרח</span> <span style="font-size:10px;font-family:monospace;font-weight:600;opacity:.5;background:rgba(255,255,255,.12);padding:1px 7px;border-radius:10px">v16 ☁️</span></div>
    <div style="display:flex;align-items:center;gap:10px"><span id="syncStatusDot" title="סטטוס סנכרון" style="display:none;width:10px;height:10px;border-radius:50%;background:#6b7a9a;flex-shrink:0;transition:background .5s"></span>
      <div class="user-pill"><span id="topUserName"></span><span class="role-badge" id="topUserRole"></span></div>
      
      <button onclick="showPage('messages')" id="topMsgBadge" style="display:none;background:var(--danger);color:white;border:none;border-radius:12px;padding:3px 9px;font-size:12px;font-weight:700;cursor:pointer;font-family:Heebo,sans-serif" title="הודעות שלא נקראו"></button>
      <button class="logout-btn" onclick="doLogout()">↩ יציאה</button>
    </div>
  </div>
  <div class="topbar-nav" style="display:none;padding-bottom:2px">
    <button class="nav-btn active" id="navDash" onclick="showPage('dash')">🏠 ראשי</button>
    <button class="nav-btn" id="navDonors" onclick="showPage('donors')">👥 תורמים</button>
    <button class="nav-btn" id="navDonations" onclick="showPage('donations')">💰 תרומות</button>
      <button class="nav-btn" id="navCampaign" onclick="showPage('campaign')">🎯 מגבית</button>
    <button class="nav-btn" id="navFuture" onclick="showPage('future')">⭐ עתידיות</button>
    <button class="nav-btn" id="navFundraisers" onclick="showPage('fundraisers')">🎓 מתרימים</button>
    <button class="nav-btn" id="navAdmin" onclick="showPage('admin'); setTimeout(checkCloudStatus, 500);">⚙️ ניהול</button>
  </div>
</div>

<!-- ════ DASHBOARD PAGE ════ -->
<div class="page active" id="pageDash">
  <div style="margin-bottom:20px;display:flex;align-items:center;justify-content:space-between">
    <div>
      <h2 style="font-family:'Frank Ruhl Libre',serif;font-size:26px" id="dashGreet">שלום!</h2>
      <div id="dashDate" style="font-size:13px;color:var(--muted)"></div>
    </div>
    <div style="display:flex;gap:10px" id="dashActions">
      <button class="btn btn-gold" onclick="openNewDonorModal()">+ הוסף תורם</button>
      <button class="btn btn-navy" onclick="openQuickDonationModal()">💰 הוסף תרומה</button>
      <button class="btn btn-outline" id="dashCreditBtn" onclick="openNedarimPayment()">💳 תרומת אשראי</button>
    </div>
  </div>

  <!-- Stats -->
  <div class="stat-grid" style="grid-template-columns:repeat(4,1fr)">
    <div class="stat-card green clickable" onclick="showPage('donors')">
      <div class="sv green" id="ds-count">0</div><div class="sl">תורמים רשומים</div>
    </div>
    <div class="stat-card gold">
      <div class="sv gold" id="ds-total">₪0</div><div class="sl">סך כל התרומות</div>
    </div>
    <div class="stat-card orange">
      <div class="sv" id="ds-donations">0</div><div class="sl">תרומות שנרשמו</div>
    </div>
    <div class="stat-card purple clickable" onclick="showPage('future')">
      <div class="sv purple" id="ds-future">0</div><div class="sl">תרומות עתידיות <small>לחץ לרשימה</small></div>
    </div>
  </div>

  <!-- Active Campaign Mini -->
  <div id="dashCampaignBox"></div>

  <!-- Recent donations -->
  <div class="card">
    <div class="card-header"><h3>⏱️ תרומות אחרונות</h3><button class="btn btn-outline btn-sm" onclick="showPage('donors')">כל התורמים</button></div>
    <div class="card-body" style="padding:0;overflow-x:auto">
      <table style="width:100%;min-width:500px;border-collapse:collapse">
        <thead style="background:var(--navy);color:white">
          <tr>
            <th style="padding:8px 10px;text-align:right;font-size:11px;white-space:nowrap">תורם</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;white-space:nowrap">מגבית</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;white-space:nowrap">מתרים</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;white-space:nowrap">סכום</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;white-space:nowrap">תאריך</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;white-space:nowrap">אופן</th>
          </tr>
        </thead>
        <tbody id="recentDonations"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- ════ DONORS PAGE ════ -->
<div class="page" id="pageDonors">
  <!-- Top toolbar -->
  <div class="toolbar">
    <input type="text" class="search-input" id="mainSearch" placeholder="🔍 חיפוש חופשי בכל השדות..." oninput="applyFilters()">
    <button class="btn btn-gold" onclick="openNewDonorModal()">+ הוסף תורם</button>
    <button class="btn btn-outline btn-sm" id="exportBtn" onclick="quickExcelExport('donors')" title="ייצוא לאקסל">📊 Excel</button>
    <button class="btn btn-outline btn-sm" id="exportPdfBtn" onclick="quickPdfExport('donors')" title="הדפסת הטבלה המסוננת">🖨️ PDF</button>
    <button class="btn btn-danger btn-sm" id="deleteSelectedBtn" onclick="deleteSelectedDonors()" style="display:none">🗑️ מחק נבחרים</button>
    <button class="btn btn-outline btn-sm" id="exportWizBtn" onclick="openExportWizard('donors')" title="אשף ייצוא מורחב">🧙 אשף</button>
    <button class="btn btn-outline btn-sm" onclick="openSelfServicePanel()">🔗 עמוד עצמי לתורם</button>
    <button class="btn btn-outline btn-sm" onclick="openBulkEmail()" id="donorsEmailBtn">📧 מייל לתורמים</button>
    <button class="btn btn-outline btn-sm" onclick="window.print()">🖨️</button>
    <button class="btn btn-outline btn-sm" onclick="openLabelsModal()">🏷️ מדבקות</button>
    <button class="btn btn-gold btn-sm" onclick="toggleColPicker()" id="colPickerBtn" title="בחר עמודות להצגה">⚙️ עמודות</button>
  </div>

  <!-- Column picker dropdown -->
  <div id="colPickerDropdown" style="display:none;background:white;border:1.5px solid var(--border);border-radius:10px;padding:14px 16px;margin:0 18px 10px;box-shadow:0 4px 20px rgba(0,0,0,.1)">
    <div style="font-weight:700;font-size:13px;color:var(--navy);margin-bottom:10px">⚙️ בחר עמודות להצגה</div>
    <div style="display:flex;flex-wrap:wrap;gap:8px" id="colCheckboxes">
      <label class="col-pick-cb"><input type="checkbox" value="code" checked onchange="applyColVis()"> קוד</label>
      <label class="col-pick-cb"><input type="checkbox" value="name" checked onchange="applyColVis()"> שם</label>
      <label class="col-pick-cb"><input type="checkbox" value="address" checked onchange="applyColVis()"> כתובת</label>
      <label class="col-pick-cb"><input type="checkbox" value="phones" checked onchange="applyColVis()"> טלפונים</label>
      <label class="col-pick-cb"><input type="checkbox" value="email" checked onchange="applyColVis()"> מייל</label>
      <label class="col-pick-cb"><input type="checkbox" value="affil" checked onchange="applyColVis()"> שיוך</label>
      <label class="col-pick-cb"><input type="checkbox" value="prefTime" checked onchange="applyColVis()"> מועד תרמה</label>
      <label class="col-pick-cb"><input type="checkbox" value="total" checked onchange="applyColVis()"> סך תרומות</label>
      <label class="col-pick-cb"><input type="checkbox" value="lastDon" checked onchange="applyColVis()"> תרומה אחרונה</label>
      <label class="col-pick-cb"><input type="checkbox" value="maxDon" onchange="applyColVis()"> גבוהה ביותר</label>
      <label class="col-pick-cb"><input type="checkbox" value="createdAt" onchange="applyColVis()"> תאריך יצירה</label>
      <label class="col-pick-cb"><input type="checkbox" value="updatedAt" onchange="applyColVis()"> עדכון אחרון</label>
      <label class="col-pick-cb"><input type="checkbox" value="idNumber" onchange="applyColVis()"> ת"ז</label>
    </div>
    <div style="margin-top:10px;display:flex;gap:8px">
      <button class="btn btn-outline btn-sm" onclick="selectAllCols(true)">בחר הכל</button>
      <button class="btn btn-outline btn-sm" onclick="selectAllCols(false)">נקה הכל</button>
      <button class="btn btn-outline btn-sm" onclick="document.getElementById('colPickerDropdown').style.display='none'">סגור</button>
    </div>
  </div>

  <!-- Bulk action bar -->
  <div id="bulkActionBar" style="display:none;background:#fff3cd;border:1px solid #ffc107;border-radius:8px;padding:8px 14px;margin:0 18px 8px;align-items:center;gap:10px;flex-wrap:wrap">
    <span id="bulkCount" style="font-size:13px;font-weight:700;color:#856404">0 נבחרו</span>
    <button class="btn btn-danger btn-sm" onclick="deleteSelectedDonors()">🗑️ מחק נבחרים</button>
    <button class="btn btn-outline btn-sm" onclick="clearAllSelections()">✕ בטל בחירה</button>
  </div>

  <!-- Advanced filters row -->
  <div style="background:var(--cream);border-bottom:1px solid var(--border);padding:10px 18px;display:flex;flex-wrap:wrap;gap:8px;align-items:flex-end" id="filtersRow">
    <!-- Multi-select: שיוך -->
    <div style="position:relative">
      <button class="filter-select" style="cursor:pointer;min-width:120px;text-align:right;display:flex;align-items:center;justify-content:space-between;gap:6px" onclick="toggleMultiFilter('affilFilter')" id="affilFilterBtn">
        <span id="affilFilterLabel">כל השיוכים</span><span>▾</span>
      </button>
      <div id="affilFilter" class="multi-filter-drop" style="display:none">
        <input class="multi-filter-search" placeholder="🔍 חיפוש..." oninput="filterMultiOpts(this,'affilOpts')">
        <div id="affilOpts" class="multi-filter-opts"></div>
        <div class="multi-filter-footer">
          <button onclick="selectAllMulti('affilOpts',true)">הכל</button>
          <button onclick="selectAllMulti('affilOpts',false)">נקה</button>
        </div>
      </div>
    </div>

    <!-- Multi-select: מועד תרמה -->
    <div style="position:relative">
      <button class="filter-select" style="cursor:pointer;min-width:130px;text-align:right;display:flex;align-items:center;justify-content:space-between;gap:6px" onclick="toggleMultiFilter('prefFilter')" id="prefFilterBtn">
        <span id="prefFilterLabel">כל מועדי תרמה</span><span>▾</span>
      </button>
      <div id="prefFilter" class="multi-filter-drop" style="display:none">
        <input class="multi-filter-search" placeholder="🔍 חיפוש..." oninput="filterMultiOpts(this,'prefOpts')">
        <div id="prefOpts" class="multi-filter-opts"></div>
        <div class="multi-filter-footer">
          <button onclick="selectAllMulti('prefOpts',true)">הכל</button>
          <button onclick="selectAllMulti('prefOpts',false)">נקה</button>
        </div>
      </div>
    </div>

    <!-- Multi-select: עיר -->
    <div style="position:relative">
      <button class="filter-select" style="cursor:pointer;min-width:120px;text-align:right;display:flex;align-items:center;justify-content:space-between;gap:6px" onclick="toggleMultiFilter('cityFilter')" id="cityFilterBtn">
        <span id="cityFilterLabel">כל הערים</span><span>▾</span>
      </button>
      <div id="cityFilter" class="multi-filter-drop" style="display:none">
        <input class="multi-filter-search" placeholder="🔍 חיפוש..." oninput="filterMultiOpts(this,'cityOpts')">
        <div id="cityOpts" class="multi-filter-opts"></div>
        <div class="multi-filter-footer">
          <button onclick="selectAllMulti('cityOpts',true)">הכל</button>
          <button onclick="selectAllMulti('cityOpts',false)">נקה</button>
        </div>
      </div>
    </div>

    <!-- Amount range -->
    <div style="display:flex;align-items:center;gap:4px">
      <span style="font-size:12px;color:var(--muted);white-space:nowrap">₪ מינימום</span>
      <input type="number" class="filter-select" id="fMinAmt" placeholder="0" min="0" style="width:90px" onchange="applyFilters()">
    </div>
    <div style="display:flex;align-items:center;gap:4px">
      <span style="font-size:12px;color:var(--muted);white-space:nowrap">עד ₪</span>
      <input type="number" class="filter-select" id="fMaxAmt" placeholder="ללא הגבלה" min="0" style="width:110px" onchange="applyFilters()">
    </div>

    <button class="filter-clear" onclick="clearFilters()">✕ נקה סינון</button>
    <span style="margin-right:auto;font-size:12px;color:var(--muted)" id="filterInfo"></span>
  </div>

  <!-- Table -->
  <div class="quick-export-bar" style="display:flex;align-items:center;gap:8px;padding:6px 0 10px">
    <span style="font-size:12px;color:var(--muted);font-weight:600">⚡ ייצוא מהיר:</span>
    <button class="btn btn-outline btn-sm" onclick="quickExcelExport('donors')" title="ייצוא לאקסל לפי מסנן פעיל">📊 Excel</button>
    <button class="btn btn-outline btn-sm" onclick="quickPdfExport('donors')" title="הדפסת טבלה כ-PDF">🖨️ PDF</button>
    <button class="btn btn-outline btn-sm" onclick="openExportWizard('donors')">🧙 אשף ייצוא</button>
  </div>
  <div class="table-wrap">
    <div class="table-info"><span id="tableCount">0 תורמים</span><span id="tableSum" style="font-weight:700;color:var(--navy)"></span></div>
    <div class="table-scroll">
      <table id="donorsTable">
        <thead id="donorsTableHead">
          <tr>
            <th style="width:36px;padding:6px"><input type="checkbox" id="selectAllDonors" onclick="toggleSelectAllDonors(this)" title="בחר הכל"></th>
            <th data-col="code" onclick="sortTable('code')"><span class="si">⇅</span>קוד</th>
            <th data-col="name" onclick="sortTable('name')"><span class="si">⇅</span>שם</th>
            <th data-col="address">כתובת</th>
            <th data-col="phones">טלפון / סלולרי</th>
            <th data-col="email">מייל</th>
            <th data-col="affil" onclick="sortTable('affil')"><span class="si">⇅</span>שיוך</th>
            <th data-col="prefTime" onclick="sortTable('prefTime')"><span class="si">⇅</span>מועד תרמה</th>
            <th data-col="total" onclick="sortTable('total')"><span class="si">⇅</span>סך תרומות</th>
            <th data-col="lastDon" onclick="sortTable('lastDon')"><span class="si">⇅</span>תרומה אחרונה</th>
            <th data-col="maxDon" style="display:none" onclick="sortTable('maxDon')"><span class="si">⇅</span>גבוהה</th>
            <th data-col="createdAt" style="display:none" onclick="sortTable('createdAt')"><span class="si">⇅</span>יצירה</th>
            <th data-col="updatedAt" style="display:none" onclick="sortTable('updatedAt')"><span class="si">⇅</span>עדכון</th>
            <th data-col="idNumber" style="display:none">ת"ז</th>
            <th>פעולות</th>
          </tr>
        </thead>
        <tbody id="donorsBody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- ════ CAMPAIGN PAGE ════ -->
<div class="page" id="pageCampaign">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
    <h2 style="font-family:'Frank Ruhl Libre',serif;font-size:24px">🎯 מגביות</h2>
    <span style="font-size:12px;color:var(--muted)">ניהול מגביות זמין בפאנל ניהול</span>
  </div>
  <div id="campaignContent"></div>
</div>

<!-- ════ FUTURE PAGE ════ -->
<div class="page" id="pageFuture">
  <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px">
    <h2 style="font-family:'Frank Ruhl Libre',serif;font-size:22px">⭐ תרומות עתידיות מתוכננות</h2>
  </div>
  <div class="toolbar" style="gap:8px">
    <input type="text" class="search-input" id="futureSearch" placeholder="🔍 חיפוש שם / הערות..." oninput="renderFuturePage()" style="max-width:280px">
    <select class="filter-select" id="futureSort" onchange="renderFuturePage()">
      <option value="date">מיון: תאריך</option><option value="name">מיון: שם</option><option value="amount">מיון: סכום</option>
    </select>
    <select class="filter-select" id="futureSortDir" onchange="renderFuturePage()">
      <option value="asc">עולה ↑</option><option value="desc">יורד ↓</option>
    </select>
    <span id="futureCount" style="font-size:13px;color:var(--muted)"></span>
  </div>
  <div class="table-wrap">
    <div class="table-scroll">
      <table>
        <thead><tr>
          <th onclick="setFSort('name')"><span class="si">⇅</span>שם תורם</th>
          <th>קוד</th><th>שיוך</th>
          <th onclick="setFSort('date')"><span class="si">⇅</span>תאריך יעד</th>
          <th>תאריך עברי</th>
          <th onclick="setFSort('amount')"><span class="si">⇅</span>סכום צפוי</th>
          <th>הערות</th><th>סלולרי</th><th>פעולות</th>
        </tr></thead>
        <tbody id="futureBody"></tbody>
      </table>
    </div>
  </div>
</div>


<!-- ════ FUNDRAISERS PAGE ════ -->
<div class="page" id="pageFundraisers">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:10px">
    <h2 style="font-family:'Frank Ruhl Libre',serif;font-size:24px">🎓 מתרימים</h2>
    <div style="display:flex;gap:8px;flex-wrap:wrap" id="frBtns">
      <button class="btn btn-outline btn-sm" onclick="quickExcelExport('fundraisers')" title="ייצוא לאקסל">📊 Excel</button>
      <button class="btn btn-outline btn-sm" onclick="quickPdfExport('fundraisers')" title="הדפסת רשימת מתרימים">🖨️ PDF</button>
      <button class="btn btn-outline btn-sm" onclick="openExportWizard('fundraisers')">🧙 אשף</button>
      <button class="btn btn-outline" onclick="openGroupModal()">👥 קבוצה חדשה</button>
      <button class="btn btn-gold" onclick="openFRModal()">+ הוסף מתרים</button>
    </div>
  </div>
  <!-- Sub-tab buttons (prominent) -->
  <div style="display:flex;gap:10px;margin-bottom:18px;flex-wrap:wrap">
    <button class="fr-tab-btn active" id="frtab-list" onclick="switchFRTab('list')" 
      style="display:flex;align-items:center;gap:8px;padding:10px 20px;border-radius:10px;border:2px solid var(--navy);background:var(--navy);color:white;font-size:14px;font-weight:700;cursor:pointer;transition:all .2s">
      <span style="font-size:20px">👨‍👩‍👧‍👦</span>
      <div style="text-align:right">
        <div>רשימת מתרימים</div>
        <div style="font-size:11px;opacity:.75;font-weight:400">פרטי המתרימים</div>
      </div>
    </button>
    <button class="fr-tab-btn" id="frtab-groups" onclick="switchFRTab('groups')"
      style="display:flex;align-items:center;gap:8px;padding:10px 20px;border-radius:10px;border:2px solid var(--border);background:white;color:var(--text);font-size:14px;font-weight:700;cursor:pointer;transition:all .2s">
      <span style="font-size:20px">👥</span>
      <div style="text-align:right">
        <div>קבוצות התרמה</div>
        <div style="font-size:11px;color:var(--muted);font-weight:400">ניהול קבוצות</div>
      </div>
    </button>
  </div>

  <div id="frcontent-list">
    <div class="toolbar" style="gap:8px">
      <input type="text" class="search-input" id="frSearch" placeholder="🔍 שם, קוד, וועד..." oninput="renderFRList()" style="max-width:260px">
      <select class="filter-select" id="frVaad" onchange="renderFRList()">
        <option value="">כל הוועדים</option>
        <option>וועד א</option><option>וועד ב</option><option>וועד ג</option>
        <option>וועד ד</option><option>וועד ה</option><option>וועד ו</option>
      </select>
      <label class="btn btn-outline btn-sm" style="cursor:pointer" title="פורמט אקסל נדרש: קוד | שם פרטי | שם משפחה | וועד | קוד קבוצה | טלפון בית | פלאפון | יעד">
        📥 ייבוא אקסל ℹ
        <input type="file" accept=".xlsx,.xls" style="display:none" onchange="importFR(this)">
      </label>
      <button class="btn btn-outline btn-sm" onclick="showFRImportFormat()" title="מה פורמט הקובץ?">📋 פורמט קובץ</button>
      <button class="btn btn-danger btn-sm" id="frBulkDeleteBtn" onclick="deleteSelectedFR()" style="display:none">🗑️ מחק נבחרים</button>
      <span id="frCountLabel" style="font-size:12px;color:var(--muted)"></span>
    </div>
    <div class="table-wrap">
      <div class="table-scroll">
        <table>
          <thead><tr>
            <th style="width:36px;padding:6px"><input type="checkbox" id="selectAllFR" onclick="toggleSelectAllFR(this)" title="בחר הכל"></th>
            <th onclick="sortFRL('code')"><span class="sort-icon">⇅</span>קוד</th>
            <th onclick="sortFRL('name')"><span class="sort-icon">⇅</span>שם</th>
            <th onclick="sortFRL('vaad')"><span class="sort-icon">⇅</span>וועד</th>
            <th onclick="sortFRL('groupCode')"><span class="sort-icon">⇅</span>קוד קבוצה</th>
            <th>טלפון בית</th>
            <th>פלאפון</th>
            <th>טל' זמין</th>
            <th onclick="sortFRL('target')"><span class="sort-icon">⇅</span>יעד אישי</th>
            <th onclick="sortFRL('raised')"><span class="sort-icon">⇅</span>גייס</th>
            <th>התקדמות</th>
            <th>פעולות</th>
          </tr></thead>
          <tbody id="frListBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- GROUPS TAB -->
  <div id="frcontent-groups" style="display:none">
    <div class="toolbar" style="gap:8px">
      <input type="text" class="search-input" id="grpSearch" placeholder="🔍 חיפוש קבוצה..." oninput="renderGroupsList()" style="max-width:260px">
    </div>
    <div id="groupsListContainer"></div>
  </div>
</div>


<!-- ════ DONATIONS PAGE ════ -->
<div class="page" id="pageDonations">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;flex-wrap:wrap;gap:10px">
    <h2 style="font-family:'Frank Ruhl Libre',serif;font-size:22px">💰 פאנל תרומות</h2>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="btn btn-gold" onclick="openQuickDonationModal()">+ הוסף תרומה</button>
      <button class="btn btn-outline btn-sm" onclick="quickExcelExport('donations')">📊 Excel</button>
      <button class="btn btn-outline btn-sm" onclick="quickPdfExport('donations')">🖨️ PDF</button>
      <button class="btn btn-outline btn-sm" onclick="openExportWizard('donations')">🧙 אשף</button>
      <button class="btn btn-outline btn-sm" id="donsPanelCreditBtn" onclick="openNedarimPayment()">💳 אשראי</button>
    </div>
  </div>

  <!-- Donations filters -->
  <div style="background:var(--cream);border-radius:10px;padding:12px 16px;margin-bottom:14px;display:flex;flex-wrap:wrap;gap:8px;align-items:flex-end">
    <!-- Free search -->
    <input type="text" class="search-input" id="donsSearch" placeholder="🔍 חיפוש חופשי..." oninput="renderDonationsPanel()" style="flex:1;min-width:160px;max-width:220px">

    <!-- Multi-select: שם תורם -->
    <div style="position:relative">
      <button class="filter-select" style="cursor:pointer;min-width:130px;display:flex;align-items:center;justify-content:space-between;gap:4px" onclick="toggleMultiFilter('donsDonorFilter')" id="donsDonorFilterBtn">
        <span id="donsDonorFilterLabel">כל התורמים</span><span>▾</span>
      </button>
      <div id="donsDonorFilter" class="multi-filter-drop" style="display:none">
        <input class="multi-filter-search" placeholder="🔍 חיפוש תורם..." oninput="filterMultiOpts(this,'donsDonorOpts')">
        <div id="donsDonorOpts" class="multi-filter-opts"></div>
        <div class="multi-filter-footer">
          <button onclick="selectAllMulti('donsDonorOpts',true)">הכל</button>
          <button onclick="selectAllMulti('donsDonorOpts',false)">נקה</button>
        </div>
      </div>
    </div>

    <!-- Multi-select: אופן תרומה -->
    <div style="position:relative">
      <button class="filter-select" style="cursor:pointer;min-width:130px;display:flex;align-items:center;justify-content:space-between;gap:4px" onclick="toggleMultiFilter('donsMethodFilter')" id="donsMethodFilterBtn">
        <span id="donsMethodFilterLabel">כל אופני תשלום</span><span>▾</span>
      </button>
      <div id="donsMethodFilter" class="multi-filter-drop" style="display:none">
        <input class="multi-filter-search" placeholder="🔍..." oninput="filterMultiOpts(this,'donsMethodOpts')">
        <div id="donsMethodOpts" class="multi-filter-opts"></div>
        <div class="multi-filter-footer">
          <button onclick="selectAllMulti('donsMethodOpts',true)">הכל</button>
          <button onclick="selectAllMulti('donsMethodOpts',false)">נקה</button>
        </div>
      </div>
    </div>

    <!-- Multi-select: מגבית -->
    <div style="position:relative">
      <button class="filter-select" style="cursor:pointer;min-width:120px;display:flex;align-items:center;justify-content:space-between;gap:4px" onclick="toggleMultiFilter('donsCampFilter')" id="donsCampFilterBtn">
        <span id="donsCampFilterLabel">כל המגביות</span><span>▾</span>
      </button>
      <div id="donsCampFilter" class="multi-filter-drop" style="display:none">
        <input class="multi-filter-search" placeholder="🔍..." oninput="filterMultiOpts(this,'donsCampOpts')">
        <div id="donsCampOpts" class="multi-filter-opts"></div>
        <div class="multi-filter-footer">
          <button onclick="selectAllMulti('donsCampOpts',true)">הכל</button>
          <button onclick="selectAllMulti('donsCampOpts',false)">נקה</button>
        </div>
      </div>
    </div>

    <!-- Multi-select: מתרים -->
    <div style="position:relative">
      <button class="filter-select" style="cursor:pointer;min-width:120px;display:flex;align-items:center;justify-content:space-between;gap:4px" onclick="toggleMultiFilter('donsFRFilter')" id="donsFRFilterBtn">
        <span id="donsFRFilterLabel">כל המתרימים</span><span>▾</span>
      </button>
      <div id="donsFRFilter" class="multi-filter-drop" style="display:none">
        <input class="multi-filter-search" placeholder="🔍..." oninput="filterMultiOpts(this,'donsFROpts')">
        <div id="donsFROpts" class="multi-filter-opts"></div>
        <div class="multi-filter-footer">
          <button onclick="selectAllMulti('donsFROpts',true)">הכל</button>
          <button onclick="selectAllMulti('donsFROpts',false)">נקה</button>
        </div>
      </div>
    </div>

    <!-- Date range -->
    <div style="display:flex;align-items:center;gap:4px;white-space:nowrap">
      <span style="font-size:12px;color:var(--muted)">מתאריך</span>
      <input type="date" class="filter-select" id="donsFrom" onchange="renderDonationsPanel()" style="width:130px">
    </div>
    <div style="display:flex;align-items:center;gap:4px;white-space:nowrap">
      <span style="font-size:12px;color:var(--muted)">עד</span>
      <input type="date" class="filter-select" id="donsTo" onchange="renderDonationsPanel()" style="width:130px">
    </div>

    <button class="filter-clear" onclick="clearDonsFilters()">✕ נקה</button>
    <span id="donsPanelCount" style="font-size:12px;color:var(--muted);margin-right:auto"></span>
  </div>

  <!-- Stats row -->
  <div class="sg" style="grid-template-columns:repeat(4,1fr);margin-bottom:14px" id="donsPanelStats"></div>

  <!-- Table -->
  <div class="table-wrap">
    <div class="table-scroll">
      <table id="donsPanelTable">
        <thead><tr>
          <th onclick="sortDonsPanel('date')">תאריך ⇅</th>
          <th>ת' עברי</th>
          <th onclick="sortDonsPanel('donor')">תורם ⇅</th>
          <th onclick="sortDonsPanel('amount')">סכום ⇅</th>
          <th>אופן</th>
          <th>מגבית</th>
          <th>מתרים / קבוצה</th>
          <th>הערות</th>
          <th></th>
        </tr></thead>
        <tbody id="donsPanelBody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- ════ ADMIN PAGE ════ -->
<div class="page" id="pageAdmin">
  <h2 style="font-family:'Frank Ruhl Libre',serif;font-size:24px;margin-bottom:20px">⚙️ פאנל ניהול</h2>
  <div class="admin-grid">
    <div class="card" style="border:2px solid #6ee7b7">
      <div class="card-header" style="background:linear-gradient(135deg,#065f46,#047857)">
        <h3>☁️ סנכרון ענן</h3>
      </div>
      <div class="card-body">
        <div id="cloudSyncInfo" style="font-size:12px;color:var(--muted);margin-bottom:10px">בדיקת חיבור לשרת...</div>
        <button class="btn btn-gold" onclick="migrateLocalToCloud()" style="margin-bottom:6px;width:100%">⬆️ העלה נתונים מקומיים לענן</button>
        <button class="btn btn-outline btn-sm" onclick="checkCloudStatus()" style="width:100%">🔄 בדוק חיבור</button>
      </div>
    </div>

    <div class="admin-card" onclick="openUsersModal()"><div class="ac-icon">👤</div><h3>ניהול משתמשים</h3><p>הוספה, עריכה, הרשאות</p></div>
    <div class="admin-card" onclick="openSettingsModal()"><div class="ac-icon">📋</div><h3>נתונים קשיחים</h3><p>עריכת רשימות</p></div>
    <div class="admin-card" onclick="openImportModal()"><div class="ac-icon">📥</div><h3>ייבוא מאקסל</h3><p>טעינת תורמים</p></div>
    <div class="admin-card" onclick="exportExcel()"><div class="ac-icon">📤</div><h3>ייצוא לאקסל</h3><p>כל המידע</p></div>
    
    <div class="admin-card" style="cursor:default">
      <div class="ac-icon">🎯</div><h3>מגביות</h3><p>ניהול מגביות שנתיות</p>
      <div style="display:flex;gap:6px;margin-top:10px">
        <button class="btn btn-outline btn-sm" onclick="showPage('campaign')" style="flex:1">צפייה</button>
        <button class="btn btn-gold btn-sm" onclick="openCampaignMgmtModal()" style="flex:1">ניהול</button>
      </div>
    </div>
    
    <div class="admin-card" onclick="openExportWizard()"><div class="ac-icon">🖨️</div><h3>אשף ייצוא והדפסה</h3><p>Excel, PDF, מדבקות, דוחות קבוצות</p></div>
    <div class="admin-card" onclick="openAuditLog()"><div class="ac-icon">📜</div><h3>לוג פעולות</h3><p>היסטוריה מלאה + שחזור</p></div>
    <div class="admin-card" onclick="openNedarimSettings()"><div class="ac-icon">💳</div><h3>נדרים פלוס</h3><p>הגדרות אשראי</p></div>
    <div class="admin-card" onclick="openNedarimImport()"><div class="ac-icon">📥</div><h3>ייבוא נדרים פלוס</h3><p>שייוך תרומות אוטומטי</p></div>
    <div class="admin-card" onclick="openDonationFormPage()"><div class="ac-icon">🌐</div><h3>טופס תרומה</h3><p>דף תרומה עצמאי לשיתוף</p></div>
    <div class="admin-card" onclick="openEmailSettings()"><div class="ac-icon">📧</div><h3>מערכת מיילים</h3><p>EmailJS — שליחת מיילים לתורמים</p></div>
    <div class="admin-card" onclick="openYemotSettings()"><div class="ac-icon">📞</div><h3>ימות המשיח</h3><p>API טלפוני — עדכון, תרומה, מגבית</p></div>
    <div class="admin-card" onclick="openDuplicateDetection()"><div class="ac-icon">🔍</div><h3>בדיקת כפילויות</h3><p>איתור ואיחוד רשומות כפולות</p></div>
    <div class="admin-card" onclick="openPendingEdits()" id="pendingEditsCard"><div class="ac-icon">📝</div><h3>בקשות עדכון <span id="pendingEditsCount" style="display:none;background:var(--danger);color:white;border-radius:10px;padding:1px 6px;font-size:11px"></span></h3><p>עדכוני תורמים הממתינים לאישור</p></div>
  </div>
</div>

<!-- ════ MESSAGES PAGE ════ -->
<div class="page" id="pageMessages">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:10px">
    <h2 style="font-family:'Frank Ruhl Libre',serif;font-size:24px">✉️ הודעות פנימיות</h2>
    <button class="btn btn-gold" onclick="openComposeMsg()">✉️ הודעה חדשה</button>
  </div>
  <div style="display:grid;grid-template-columns:280px 1fr;gap:16px;min-height:500px">
    <!-- Threads list -->
    <div class="card" style="margin:0">
      <div class="card-header"><h3>שיחות</h3></div>
      <div id="msgThreadList" style="overflow-y:auto;max-height:600px"></div>
    </div>
    <!-- Thread view -->
    <div class="card" style="margin:0">
      <div id="msgThreadView" style="padding:20px;height:100%;display:flex;flex-direction:column">
        <div style="flex:1;color:var(--muted);text-align:center;padding-top:60px;font-size:14px">בחר שיחה מהרשימה</div>
      </div>
    </div>
  </div>
</div>


<!-- ════ EXPORT WIZARD MODAL ════ -->
<div class="modal-overlay" id="exportWizardModal">
  <div class="modal" style="width:760px;max-width:96vw;max-height:92vh;display:flex;flex-direction:column">
    <div class="modal-header" style="background:var(--navy);color:white;border-radius:14px 14px 0 0">
      <h3 style="color:white">🖨️ אשף ייצוא והדפסה</h3>
      <button class="modal-close" style="color:white;opacity:.8" onclick="closeModal('exportWizardModal')">✕</button>
    </div>

    <!-- Step indicator -->
    <div id="wizSteps" style="display:flex;gap:0;background:#f8f6f2;border-bottom:1px solid var(--border);padding:0 24px">
      <div class="wiz-step active" id="ws1" style="flex:1;padding:12px 8px;text-align:center;border-bottom:3px solid var(--navy);font-size:13px;font-weight:700;color:var(--navy)">1. סוג התוצר</div>
      <div class="wiz-step" id="ws2" style="flex:1;padding:12px 8px;text-align:center;border-bottom:3px solid transparent;font-size:13px;font-weight:600;color:var(--muted)">2. סינון ומיון</div>
      <div class="wiz-step" id="ws3" style="flex:1;padding:12px 8px;text-align:center;border-bottom:3px solid transparent;font-size:13px;font-weight:600;color:var(--muted)">3. הגדרות תוצר</div>
      <div class="wiz-step" id="ws4" style="flex:1;padding:12px 8px;text-align:center;border-bottom:3px solid transparent;font-size:13px;font-weight:600;color:var(--muted)">4. תצוגה מקדימה</div>
    </div>

    <div class="modal-body" style="flex:1;overflow-y:auto;padding:24px">

      <!-- STEP 1: output type -->
      <div id="wizPage1">
        <h3 style="margin-bottom:16px;font-size:16px">בחר סוג התוצר הרצוי</h3>
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:14px">
          <div class="wiz-type-card" id="wt_excel" onclick="selectWizType('excel')"
            style="border:2px solid var(--border);border-radius:12px;padding:18px 16px;cursor:pointer;transition:all .2s;text-align:center">
            <div style="font-size:36px;margin-bottom:8px">📊</div>
            <div style="font-weight:700;font-size:15px;color:var(--navy)">ייצוא נתונים — Excel / CSV</div>
            <div style="font-size:12px;color:var(--muted);margin-top:4px">בחר עמודות, סינון מתקדם, הורדת קובץ</div>
          </div>
          <div class="wiz-type-card" id="wt_pdf_donors" onclick="selectWizType('pdf_donors')"
            style="border:2px solid var(--border);border-radius:12px;padding:18px 16px;cursor:pointer;transition:all .2s;text-align:center">
            <div style="font-size:36px;margin-bottom:8px">📋</div>
            <div style="font-weight:700;font-size:15px;color:var(--navy)">הדפסת רשימת תורמים — PDF</div>
            <div style="font-size:12px;color:var(--muted);margin-top:4px">כולל כותרת מוסד, מספור עמודים</div>
          </div>
          <div class="wiz-type-card" id="wt_fundraiser_packets" onclick="selectWizType('fundraiser_packets')"
            style="border:2px solid var(--border);border-radius:12px;padding:18px 16px;cursor:pointer;transition:all .2s;text-align:center">
            <div style="font-size:36px;margin-bottom:8px">📦</div>
            <div style="font-weight:700;font-size:15px;color:var(--navy)">דוחות לקבוצות איסוף — PDF + מפות</div>
            <div style="font-size:12px;color:var(--muted);margin-top:4px">חבילת דפים לכל קבוצה כולל מפת תורמים</div>
          </div>
          <div class="wiz-type-card" id="wt_labels" onclick="selectWizType('labels')"
            style="border:2px solid var(--border);border-radius:12px;padding:18px 16px;cursor:pointer;transition:all .2s;text-align:center">
            <div style="font-size:36px;margin-bottom:8px">🏷️</div>
            <div style="font-weight:700;font-size:15px;color:var(--navy)">מדבקות דיוור — TANEX</div>
            <div style="font-size:12px;color:var(--muted);margin-top:4px">עיצוב גרירה, תצוגה מקדימה, הדפסה מכויילת</div>
          </div>
        </div>
      </div>

      <!-- STEP 2: Filter & Sort -->
      <div id="wizPage2" style="display:none">
        <h3 style="margin-bottom:16px;font-size:16px">סינון ומיון האוכלוסייה</h3>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:16px">
          <div class="fg">
            <label class="form-label">שיוך</label>
            <select class="form-control" id="wiz_affil">
              <option value="">כל השיוכים</option>
              <option>תלמיד</option><option>בוגר</option><option>הורה תלמיד</option><option>הורה בוגר</option><option>מכר</option><option>עסקי</option>
            </select>
          </div>
          <div class="fg">
            <label class="form-label">מגבית</label>
            <select class="form-control" id="wiz_campaign">
              <option value="">כל המגביות</option>
            </select>
          </div>
          <div class="fg">
            <label class="form-label">קבוצת איסוף</label>
            <select class="form-control" id="wiz_group">
              <option value="">כל הקבוצות</option>
            </select>
          </div>
          <div class="fg">
            <label class="form-label">מועד תרמה מועדף</label>
            <select class="form-control" id="wiz_pref">
              <option value="">ללא מגבלה</option>
              <option>טלפוני לפני פורים</option><option>פורים בבית</option><option>טלפוני בפורים</option>
            </select>
          </div>
          <div class="fg">
            <label class="form-label">תרומה מינימלית (₪)</label>
            <input type="number" class="form-control" id="wiz_minAmount" placeholder="0">
          </div>
          <div class="fg">
            <label class="form-label">עיר</label>
            <input type="text" class="form-control" id="wiz_city" placeholder="כל הערים">
          </div>
          <div class="fg">
            <label class="form-label">תאריך תרומה מ-</label>
            <input type="date" class="form-control" id="wiz_dateFrom">
          </div>
          <div class="fg">
            <label class="form-label">תאריך תרומה עד</label>
            <input type="date" class="form-control" id="wiz_dateTo">
          </div>
          <div class="fg">
            <label class="form-label">מיון</label>
            <select class="form-control" id="wiz_sort">
              <option value="name">לפי שם</option>
              <option value="code">לפי קוד</option>
              <option value="city">לפי עיר</option>
              <option value="amount_desc">לפי סכום (גבוה לנמוך)</option>
              <option value="amount_asc">לפי סכום (נמוך לגבוה)</option>
            </select>
          </div>
        </div>
        <div id="wiz_filter_result" style="background:var(--cream);border-radius:8px;padding:10px 14px;font-size:13px;color:var(--muted)">
          ← שנה פילטרים לעדכון ספירה
        </div>
      </div>

      <!-- STEP 3: Output settings (changes per type) -->
      <div id="wizPage3" style="display:none">

        <!-- Excel settings -->
        <div id="wiz_settings_excel" style="display:none">
          <h3 style="margin-bottom:12px;font-size:16px">בחר עמודות לייצוא</h3>
          <div style="display:flex;gap:8px;margin-bottom:12px">
            <button class="btn btn-outline btn-sm" onclick="wizSelectAllCols(true)">✅ הכל</button>
            <button class="btn btn-outline btn-sm" onclick="wizSelectAllCols(false)">❌ נקה</button>
          </div>
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:0">
            <div style="padding:8px 0;border-bottom:1px solid var(--border)">
              <strong style="font-size:12px;color:var(--muted);text-transform:uppercase">פרטים אישיים</strong>
            </div>
            <div style="padding:8px 0;border-bottom:1px solid var(--border)">
              <strong style="font-size:12px;color:var(--muted);text-transform:uppercase">פרטי קשר</strong>
            </div>
            <div>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="code" checked> קוד תורם</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="firstName" checked> שם פרטי</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="lastName" checked> שם משפחה</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="affiliation"> שיוך</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="prefTime"> מועד תרמה</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="notes"> הערות</label>
            </div>
            <div>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="street" checked> רחוב</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="city" checked> עיר</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="zip"> מיקוד</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="phone" checked> טלפון בית</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="mobile" checked> פלאפון</label>
              <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="email"> מייל</label>
            </div>
          </div>
          <div style="margin-top:12px;padding:8px 0;border-top:1px solid var(--border)">
            <strong style="font-size:12px;color:var(--muted);display:block;margin-bottom:8px">היסטוריית תרומות</strong>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="totalDonations" checked> סך תרומות</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="lastDonation"> תרומה אחרונה</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="maxDonation"> תרומה מקסימלית</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="donationCount"> מספר תרומות</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="exc_col" value="lastCampaign"> מגבית אחרונה</label>
          </div>
          <div style="margin-top:12px">
            <label class="form-label">פורמט פלט</label>
            <div style="display:flex;gap:12px;margin-top:4px">
              <label style="display:flex;align-items:center;gap:6px;font-size:13px"><input type="radio" name="exc_format" value="xlsx" checked> Excel (.xlsx)</label>
              <label style="display:flex;align-items:center;gap:6px;font-size:13px"><input type="radio" name="exc_format" value="csv"> CSV</label>
            </div>
          </div>
        </div>

        <!-- PDF Donors settings -->
        <div id="wiz_settings_pdf_donors" style="display:none">
          <h3 style="margin-bottom:12px;font-size:16px">הגדרות הדפסת רשימת תורמים</h3>
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:16px">
            <div class="fg"><label class="form-label">שם המוסד (לכותרת)</label>
              <input class="form-control" id="wiz_pdf_institution" value="עזר תורה - תושיה"></div>
            <div class="fg"><label class="form-label">שם המגבית</label>
              <select class="form-control" id="wiz_pdf_campaign2"><option value="">ללא מגבית</option></select></div>
            <div class="fg"><label class="form-label">כיוון</label>
              <select class="form-control" id="wiz_pdf_orient"><option value="portrait">לאורך</option><option value="landscape">לרוחב</option></select></div>
            <div class="fg"><label class="form-label">גובה שורה מקסימלי (מ"מ)</label>
              <input type="number" class="form-control" id="wiz_pdf_rowH" value="15" min="8" max="40"></div>
          </div>
          <strong style="font-size:12px;color:var(--muted);display:block;margin-bottom:8px">עמודות להצגה בטבלה</strong>
          <div style="display:flex;flex-wrap:wrap;gap:6px">
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pdf_col" value="code" checked> קוד</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pdf_col" value="name" checked> שם</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pdf_col" value="address" checked> כתובת</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pdf_col" value="phone" checked> טלפון</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pdf_col" value="mobile" checked> פלאפון</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pdf_col" value="affil"> שיוך</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pdf_col" value="totalDonations" checked> סך תרומות</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pdf_col" value="notes"> הערות</label>
          </div>
        </div>

        <!-- Fundraiser Packets settings -->
        <div id="wiz_settings_fundraiser_packets" style="display:none">
          <h3 style="margin-bottom:12px;font-size:16px">הגדרות דוחות קבוצות איסוף</h3>
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:16px">
            <div class="fg"><label class="form-label">שם המוסד</label>
              <input class="form-control" id="wiz_pkt_institution" value="עזר תורה - תושיה"></div>
            <div class="fg"><label class="form-label">מגבית</label>
              <select class="form-control" id="wiz_pkt_campaign"><option value="">ללא מגבית</option></select></div>
            <div class="fg"><label class="form-label">Google Maps API Key</label>
              <input class="form-control" id="wiz_maps_key" placeholder="מפתח API למפות (אופציונלי)"></div>
            <div class="fg"><label class="form-label">קבוצות לכלול</label>
              <select class="form-control" id="wiz_pkt_groups" multiple size="4" style="height:90px"></select></div>
          </div>
          <strong style="font-size:12px;color:var(--muted);display:block;margin-bottom:8px">עמודות בטבלת תורמים (שורה כפולה)</strong>
          <div style="display:flex;flex-wrap:wrap;gap:6px">
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="code" checked> קוד</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="name" checked> שם</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="address" checked> כתובת</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="phone" checked> טלפון</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="mobile" checked> פלאפון</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="maxDonation" checked> תרומה מקסימלית</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="lastDonation" checked> תרומה אחרונה</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="notes" checked> הערות</label>
            <label class="col-pick-cb wiz-col-cb"><input type="checkbox" name="pkt_col" value="empty" checked> עמודה ריקה (לרשום)</label>
          </div>
        </div>

        <!-- Labels settings -->
        <div id="wiz_settings_labels" style="display:none">
          <h3 style="margin-bottom:16px;font-size:16px">הגדרות מדבקות TANEX</h3>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
            <!-- Left: settings -->
            <div>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px">
                <div class="fg">
                  <label class="form-label">דגם TANEX</label>
                  <select class="form-control" id="wiz_tanex_model" onchange="updateTanexConfig();renderLabelPreview()">
                    <option value="3100">TANEX 3100 — 3×8 (24/דף)</option>
                    <option value="3101">TANEX 3101 — 2×7 (14/דף)</option>
                    <option value="3102">TANEX 3102 — 3×10 (30/דף)</option>
                    <option value="3106">TANEX 3106 — 4×11 (44/דף)</option>
                  </select>
                </div>
                <div class="fg">
                  <label class="form-label">גודל גופן</label>
                  <select class="form-control" id="wiz_label_font" onchange="renderLabelPreview()">
                    <option value="8">8pt</option><option value="9">9pt</option>
                    <option value="10" selected>10pt</option><option value="11">11pt</option><option value="12">12pt</option>
                  </select>
                </div>
              </div>
              <div id="tanex_config_info" style="background:var(--cream);border-radius:8px;padding:8px 12px;font-size:12px;color:var(--navy);margin-bottom:16px;font-weight:600"></div>

              <!-- Drag & Drop row builder -->
              <div style="margin-bottom:10px">
                <label class="form-label" style="margin-bottom:8px;display:flex;align-items:center;gap:8px">
                  <span>🏷️ שורות המדבקה</span>
                  <span style="font-size:11px;color:var(--muted);font-weight:400">(גרור לשינוי סדר, לחץ ✕ להסרה)</span>
                </label>
                <div id="lblRowBuilder" style="min-height:40px;border:2px dashed var(--border);border-radius:8px;padding:8px;display:flex;flex-direction:column;gap:6px"></div>
                <div style="margin-top:10px">
                  <label class="form-label">הוסף שורה:</label>
                  <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px">
                    <button class="btn btn-outline btn-sm" onclick="addLabelRow('fullName','שם מלא',true)">+ שם מלא</button>
                    <button class="btn btn-outline btn-sm" onclick="addLabelRow('title_name','כבוד + שם',true)">+ כבוד + שם</button>
                    <button class="btn btn-outline btn-sm" onclick="addLabelRow('street_num','רחוב + מספר',false)">+ רחוב + מס'</button>
                    <button class="btn btn-outline btn-sm" onclick="addLabelRow('address_full','כתובת מלאה',false)">+ כתובת מלאה</button>
                    <button class="btn btn-outline btn-sm" onclick="addLabelRow('city_zip','עיר + מיקוד',false)">+ עיר + מיקוד</button>
                    <button class="btn btn-outline btn-sm" onclick="addLabelRow('phone','טלפון',false)">+ טלפון</button>
                    <button class="btn btn-outline btn-sm" onclick="addLabelRow('mobile','פלאפון',false)">+ פלאפון</button>
                    <button class="btn btn-outline btn-sm" onclick="addLabelRow('code','קוד תורם',false)">+ קוד</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right: live preview -->
            <div>
              <label class="form-label">תצוגה מקדימה של מדבקה</label>
              <div id="lblSinglePreview" style="border:2px solid var(--navy);border-radius:6px;padding:10px 12px;min-height:80px;background:white;font-family:Heebo,sans-serif;max-width:220px;margin-top:4px">
                <div style="text-align:center;color:var(--muted);font-size:12px;padding:20px 0">הוסף שורות לתצוגה</div>
              </div>
              <div style="margin-top:16px">
                <label class="form-label">📐 דגימה — פריסת דף</label>
                <div id="lblPageSample" style="border:1px solid #ccc;border-radius:6px;background:white;padding:6px;margin-top:4px;overflow:hidden"></div>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- STEP 4: Preview -->
      <div id="wizPage4" style="display:none">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px">
          <h3 style="font-size:16px">תצוגה מקדימה</h3>
          <span id="wizPreviewCount" style="font-size:13px;color:var(--muted)"></span>
        </div>
        <div id="wizPreviewContent" style="border:1px solid var(--border);border-radius:10px;overflow:auto;max-height:400px;background:white;padding:16px;font-size:12px">
          <div style="text-align:center;color:var(--muted);padding:40px">לחץ "הצג תצוגה מקדימה" לצפייה</div>
        </div>
      </div>

    </div><!-- /modal-body -->

    <!-- Footer nav -->
    <div class="modal-footer" style="justify-content:space-between">
      <div style="display:flex;gap:8px">
        <button class="btn btn-outline" id="wizBackBtn" onclick="wizStep(-1)" style="display:none">← חזרה</button>
      </div>
      <div style="display:flex;gap:8px">
        <button class="btn btn-outline btn-sm" onclick="closeModal('exportWizardModal')">ביטול</button>
        <button class="btn btn-outline" id="wizPreviewBtn" onclick="wizGeneratePreview()" style="display:none">👁️ תצוגה מקדימה</button>
        <button class="btn btn-navy" id="wizNextBtn" onclick="wizStep(1)">הבא ←</button>
        <button class="btn btn-gold" id="wizExportBtn" onclick="wizExecuteExport()" style="display:none">⬇️ ייצוא / הדפסה</button>
      </div>
    </div>
  </div>
</div>

<!-- FUNDRAISER MODAL -->
<div class="modal-overlay" id="frModal">
  <div class="modal" style="width:600px">
    <div class="modal-header"><h3 id="frModalTitle">הוספת מתרים</h3><button class="modal-close" onclick="closeModal('frModal')">✕</button></div>
    <div class="modal-body">
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px">
        <div class="fg"><label class="form-label">קוד מתרים</label><input class="form-control" id="fr_code" readonly></div>
        <div class="fg"><label class="form-label">שם פרטי <span class="required">*</span></label><input class="form-control" id="fr_firstName" placeholder="שם פרטי" onkeydown="if(event.key==='Enter')saveFR()"></div>
        <div class="fg"><label class="form-label">שם משפחה <span class="required">*</span></label><input class="form-control" id="fr_lastName" placeholder="שם משפחה" onkeydown="if(event.key==='Enter')saveFR()"></div>
        <div class="fg"><label class="form-label">וועד (שיעור)</label>
          <select class="form-control" id="fr_vaad">
            <option value="">-</option>
            <option>וועד א</option><option>וועד ב</option><option>וועד ג</option>
            <option>וועד ד</option><option>וועד ה</option><option>וועד ו</option>
            <option>וועד ז</option><option>וועד ח</option><option>וועד ט</option>
          </select>
        </div>
        <div class="fg"><label class="form-label">קוד קבוצה</label><input class="form-control" id="fr_groupCode" placeholder="למשל: 101" maxlength="3" onkeydown="if(event.key==='Enter')saveFR()"></div>
        <div class="fg"><label class="form-label">יעד אישי (₪)</label><input class="form-control" id="fr_target" type="number" placeholder="0" min="0" onkeydown="if(event.key==='Enter')saveFR()"></div>
        <div class="fg"><label class="form-label">טלפון בית</label><input class="form-control" id="fr_homePhone" onkeydown="if(event.key==='Enter')saveFR()"></div>
        <div class="fg"><label class="form-label">פלאפון</label><input class="form-control" id="fr_mobile" onkeydown="if(event.key==='Enter')saveFR()"></div>
        <div class="fg"><label class="form-label">טלפון זמין</label>
          <select class="form-control" id="fr_availPhone">
            <option value="mobile">פלאפון</option>
            <option value="home">טלפון בית</option>
          </select>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-danger btn-sm" id="frDeleteBtn" onclick="deleteFR()" style="margin-left:auto;display:none">🗑️ מחק</button>
      <button class="btn btn-outline btn-sm" onclick="closeModal('frModal')">ביטול</button>
      <button class="btn btn-outline btn-sm" onclick="saveFRandNew()">💾 שמור וחדש</button>
      <button class="btn btn-navy" onclick="saveFR()">שמור</button>
      <input type="hidden" id="fr_editId">
    </div>
  </div>
</div>

<!-- GROUP MODAL -->
<div class="modal-overlay" id="groupModal">
  <div class="modal modal-lg">
    <div class="modal-header"><h3 id="grpModalTitle">קבוצה חדשה</h3><button class="modal-close" onclick="closeModal('groupModal')">✕</button></div>
    <div class="modal-body">
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:18px">
        <div class="fg"><label class="form-label">קוד קבוצה</label><input class="form-control" id="grp_code" readonly></div>
        <div class="fg" style="grid-column:span 2"><label class="form-label">שם קבוצה <span class="required">*</span></label><input class="form-control" id="grp_name" placeholder="שם הקבוצה" onkeydown="if(event.key==='Enter')saveGroup()"></div>
        <div class="fg"><label class="form-label">וועד עיקרי</label>
          <select class="form-control" id="grp_vaad" onchange="updateGrpCode()">
            <option value="">מעורב (9xx)</option>
            <option>וועד א</option><option>וועד ב</option><option>וועד ג</option>
            <option>וועד ד</option><option>וועד ה</option><option>וועד ו</option>
          </select>
        </div>
        <div class="fg"><label class="form-label">יעד קבוצתי (₪)</label><input class="form-control" id="grp_target" type="number" placeholder="0" min="0" onkeydown="if(event.key==='Enter')saveGroup()"></div>
        <div class="fg"><label class="form-label">הערות</label><input class="form-control" id="grp_notes" onkeydown="if(event.key==='Enter')saveGroup()"></div>
      </div>

      <!-- Members section -->
      <div style="margin-bottom:18px">
        <strong style="font-size:14px">חברי הקבוצה (<span id="grpMemberCount">0</span>)</strong>
        <div style="display:flex;gap:6px;margin-top:8px;margin-bottom:6px">
          <input class="form-control" id="grp_member_search" placeholder="הוסף מתרים לפי שם או קוד..." oninput="searchFRforGroup()" style="flex:1">
        </div>
        <div class="pick-results" id="grp_member_results"></div>
        <div id="grpMembersList" style="margin-top:8px;display:flex;flex-wrap:wrap;gap:6px"></div>
      </div>

      <!-- Donors section -->
      <div>
        <strong style="font-size:14px">תורמים משוייכים (<span id="grpDonorCount">0</span>)</strong>
        <div style="display:flex;gap:6px;margin-top:8px;margin-bottom:6px">
          <input class="form-control" id="grp_donor_search" placeholder="הוסף תורם לפי שם, כתובת או קוד..." oninput="searchDonorForGroup()" style="flex:1">
        </div>
        <div class="pick-results" id="grp_donor_results"></div>
        <div id="grpDonorsList" style="margin-top:8px;display:flex;flex-wrap:wrap;gap:6px"></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-danger btn-sm" id="grpDeleteBtn" onclick="deleteGroup()" style="margin-left:auto;display:none">🗑️ מחק קבוצה</button>
      <button class="btn btn-outline btn-sm" onclick="closeModal('groupModal')">ביטול</button>
      <button class="btn btn-navy" onclick="saveGroup()">שמור קבוצה</button>
      <input type="hidden" id="grp_editId">
    </div>
  </div>
</div>




<!-- FIRST LOGIN / CHANGE PASSWORD MODAL -->
<div class="modal-overlay" id="changePassModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>🔐 שינוי סיסמה</h3></div>
    <div class="modal-body">
      <p id="changePassInfo" style="font-size:13px;color:var(--muted);margin-bottom:16px;padding:10px;background:var(--gold-bg);border-radius:8px;border-right:3px solid var(--gold)">כניסה ראשונה — נא הגדר סיסמה חדשה ומאובטחת</p>
      <div class="fg3" style="display:flex;flex-direction:column;gap:12px">
        <div class="fg"><label class="form-label">סיסמה חדשה <span class="req">*</span></label><input class="form-control" type="password" id="newPass1" placeholder="לפחות 8 תווים"></div>
        <div class="fg"><label class="form-label">אימות סיסמה <span class="req">*</span></label><input class="form-control" type="password" id="newPass2" placeholder="חזור על הסיסמה"></div>
        <div id="changePassErr" style="color:var(--danger);font-size:12px;display:none"></div>
      </div>
    </div>
    <div class="modal-footer"><button class="btn btn-navy" onclick="saveNewPassword()">שמור סיסמה</button></div>
  </div>
</div>

<!-- EMAILJS SETTINGS MODAL -->
<div class="modal-overlay" id="emailSettingsModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>📧 הגדרות מיילים (EmailJS)</h3><button class="modal-close" onclick="closeModal('emailSettingsModal')">✕</button></div>
    <div class="modal-body">
      <div style="background:var(--gold-bg);border-radius:8px;padding:10px 14px;font-size:12px;margin-bottom:14px">
        <strong>Template IDs שהוגדרו:</strong><br>
        ✉️ הודעה לתורם: <code>template_iz8no2o</code><br>
        🔑 שחזור סיסמה: <code>template_amj12tr</code>
      </div>
      <div style="display:flex;flex-direction:column;gap:11px">
        <div class="fg"><label class="form-label">Public Key</label><input class="form-control" id="ejPublicKey" placeholder="wZ0dkVoeeimiBD_gx"></div>
        <div class="fg"><label class="form-label">Service ID</label><input class="form-control" id="ejServiceId" placeholder="service_wohacxp"></div>
        <div style="background:var(--cream);border-radius:8px;padding:10px;font-size:12px">
          <strong>מזהי תבניות:</strong>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
            <div class="fg"><label class="form-label" style="font-size:11px">✉️ הודעה לתורם (template_iz8no2o)</label><input class="form-control" id="ejTplMessage" placeholder="template_iz8no2o"></div>
            <div class="fg"><label class="form-label" style="font-size:11px">🔑 שחזור סיסמה (template_amj12tr)</label><input class="form-control" id="ejTplReset" placeholder="template_amj12tr"></div>
          </div>
        </div>
        <div class="fg"><label class="form-label">שם הארגון</label><input class="form-control" id="ejOrgName" placeholder="עזר תורה"></div>
      </div>
      <div id="ejTestResult" style="margin-top:10px;font-size:12px;display:none"></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline btn-sm" onclick="testEmailSettings()">🧪 מייל בדיקה</button>
      <button class="btn btn-outline" onclick="closeModal('emailSettingsModal')">ביטול</button>
      <button class="btn btn-navy" onclick="saveEmailSettings()">שמור</button>
    </div>
  </div>
</div>

<!-- SEND EMAIL TO DONORS MODAL -->
<div class="modal-overlay" id="sendEmailModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>📧 שליחת מייל לתורמים</h3><button class="modal-close" onclick="closeModal('sendEmailModal')">✕</button></div>
    <div class="modal-body" dir="rtl">
      <div style="display:flex;flex-direction:column;gap:12px">
        <div class="fg">
          <label class="form-label">נמענים</label>
          <select class="form-control" id="emailRecipientType" onchange="updateEmailRecipientCount()">
            <option value="all">כל התורמים עם מייל</option>
            <option value="campaign">תורמי מגבית נוכחית</option>
            <option value="single">תורם ספציפי</option>
          </select>
        </div>
        <div id="singleDonorEmailWrap" style="display:none" class="fg">
          <label class="form-label">בחר תורם</label>
          <input class="form-control" id="singleDonorEmailSearch" placeholder="חפש תורם..." oninput="searchDonorForEmail(this.value)">
          <div id="emailDonorResults" class="pick-results" style="max-height:120px"></div>
          <input type="hidden" id="singleDonorEmailId">
        </div>
        <div style="font-size:12px;color:var(--muted)">מספר נמענים: <strong id="emailRecipientCount">0</strong></div>
        <div class="fg"><label class="form-label">סוג מייל</label>
          <select class="form-control" id="emailType" onchange="toggleEmailType()">
            <option value="announce">הודעה כללית</option>
            <option value="donor_link">קישור עדכון פרטים אישי</option>
          </select>
        </div>
        <div id="emailAnnounceFields">
          <div class="fg"><label class="form-label">נושא</label><input class="form-control" id="emailSubjectField" placeholder="נושא המייל" style="direction:rtl"></div>
          <div class="fg"><label class="form-label">תוכן</label><textarea class="form-control" id="emailBodyField" rows="4" placeholder="תוכן ההודעה..." style="direction:rtl;text-align:right"></textarea></div>
        </div>
        <div id="emailDonorLinkNote" style="display:none;background:var(--cream);border-radius:8px;padding:10px;font-size:12px">
          כל תורם יקבל קישור אישי ייחודי לעדכון פרטיו. קישורים אלה מאובטחים אישית לכל תורם.
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('sendEmailModal')">ביטול</button>
      <button class="btn btn-navy" onclick="openBulkEmail()">שלח 📧</button>
    </div>
  </div>
</div>

<!-- SEND EMAIL TO DONOR MODAL — Rich editor + RTL -->
<div class="modal-overlay" id="sendDonorEmailModal">
  <div class="modal" style="max-width:560px">
    <div class="modal-header"><h3>📧 שליחת מייל לתורם</h3><button class="modal-close" onclick="closeModal('sendDonorEmailModal')">✕</button></div>
    <div class="modal-body" dir="rtl">
      <div id="sendDonorNoEmail" style="display:none;background:#fee2e2;padding:10px;border-radius:8px;font-size:12px;color:#dc2626;margin-bottom:10px">
        ⚠️ לתורם זה אין כתובת מייל שמורה
      </div>
      <div class="fg"><label class="form-label">סוג מייל</label>
        <select class="form-control" id="donorEmailType" onchange="updateDonorEmailPreview()">
          <option value="link">🔗 קישור עדכון עצמי אישי</option>
          <option value="message">📩 הודעה חופשית</option>
        </select>
      </div>
      <div class="fg"><label class="form-label">כתובת מייל</label>
        <input class="form-control" id="donorEmailTo" readonly style="background:var(--cream);direction:ltr">
      </div>
      <div id="donorEmailMsgFields">
        <div class="fg"><label class="form-label">נושא</label><input class="form-control" id="donorEmailSubject" placeholder="נושא ההודעה" style="direction:rtl"></div>
        <div class="fg">
          <label class="form-label">תוכן <span style="font-size:11px;color:var(--muted)">(לחץ כפתור להוסיף שדה אישי)</span></label>
          <div style="display:flex;flex-wrap:wrap;gap:4px;padding:6px 8px;background:var(--cream);border:1px solid var(--border);border-bottom:none;border-radius:8px 8px 0 0">
            <button type="button" class="re-btn" onclick="execRichFmt('donorRichBody','bold')"><b>B</b></button>
            <button type="button" class="re-btn" onclick="execRichFmt('donorRichBody','italic')"><i>I</i></button>
            <button type="button" class="re-btn" onclick="execRichFmt('donorRichBody','underline')"><u>U</u></button>
            <button type="button" class="re-btn" onclick="execRichFmt('donorRichBody','insertUnorderedList')">≡</button>
            <span style="width:1px;background:var(--border);margin:2px 4px;display:inline-block"></span>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('donorRichBody','{{שם}}')">👤 שם</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('donorRichBody','{{שם_פרטי}}')">פרטי</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('donorRichBody','{{קוד}}')">קוד</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('donorRichBody','{{סך_תרומות}}')">₪ סך</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('donorRichBody','{{תרומה_אחרונה}}')">₪ אחרון</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('donorRichBody','{{שיוך}}')">שיוך</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('donorRichBody','{{עיר}}')">עיר</button>
          </div>
          <div id="donorRichBody" contenteditable="true"
            data-placeholder="תוכן ההודעה..."
            style="min-height:120px;border:1px solid var(--border);border-radius:0 0 8px 8px;padding:10px 12px;font-size:13px;font-family:Heebo,sans-serif;direction:rtl;text-align:right;outline:none;line-height:1.6;background:white"></div>
          <textarea id="donorEmailBody" style="display:none"></textarea>
          <div style="font-size:10px;color:var(--muted);margin-top:4px">שדות {{...}} יוחלפו אוטומטית בנתוני התורם בשליחה</div>
        </div>
      </div>
      <div id="donorEmailPreview" style="background:var(--cream);border-radius:8px;padding:12px;font-size:12px;margin-top:8px;display:none;direction:rtl"></div>
      <div id="donorEmailResult" style="margin-top:10px;font-size:13px;text-align:center;display:none"></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('sendDonorEmailModal')">ביטול</button>
      <button class="btn btn-navy" id="sendDonorEmailBtn" onclick="sendEmailToDonorNow()">✉️ שלח</button>
    </div>
  </div>
</div>

<!-- BULK EMAIL MODAL — Rich editor + RTL -->
<div class="modal-overlay" id="bulkEmailModal">
  <div class="modal" style="max-width:560px">
    <div class="modal-header"><h3>📨 שליחת מייל לכל התורמים</h3><button class="modal-close" onclick="closeModal('bulkEmailModal')">✕</button></div>
    <div class="modal-body" dir="rtl">
      <div style="background:var(--gold-bg);padding:10px;border-radius:8px;font-size:12px;margin-bottom:12px">
        ישלח מייל לכל התורמים שיש להם כתובת מייל ברשומות (<strong><span id="bulkEmailCount">0</span></strong>)
      </div>
      <div class="fg"><label class="form-label">סוג מייל</label>
        <select class="form-control" id="bulkEmailType" onchange="toggleBulkEmailBody()">
          <option value="link">🔗 קישור עדכון עצמי (קישור אישי לכל תורם)</option>
          <option value="message">📩 הודעה אחידה לכולם</option>
        </select>
      </div>
      <div id="bulkEmailFields">
        <div class="fg"><label class="form-label">נושא</label><input class="form-control" id="bulkEmailSubject" placeholder="נושא המייל" style="direction:rtl"></div>
        <div class="fg">
          <label class="form-label">תוכן <span style="font-size:11px;color:var(--muted)">(שדות יוחלפו לכל תורם)</span></label>
          <div style="display:flex;flex-wrap:wrap;gap:4px;padding:6px 8px;background:var(--cream);border:1px solid var(--border);border-bottom:none;border-radius:8px 8px 0 0">
            <button type="button" class="re-btn" onclick="execRichFmt('bulkRichBody','bold')"><b>B</b></button>
            <button type="button" class="re-btn" onclick="execRichFmt('bulkRichBody','italic')"><i>I</i></button>
            <button type="button" class="re-btn" onclick="execRichFmt('bulkRichBody','underline')"><u>U</u></button>
            <button type="button" class="re-btn" onclick="execRichFmt('bulkRichBody','insertUnorderedList')">≡</button>
            <span style="width:1px;background:var(--border);margin:2px 4px;display:inline-block"></span>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('bulkRichBody','{{שם}}')">👤 שם</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('bulkRichBody','{{שם_פרטי}}')">פרטי</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('bulkRichBody','{{קוד}}')">קוד</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('bulkRichBody','{{סך_תרומות}}')">₪ סך</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('bulkRichBody','{{תרומה_אחרונה}}')">₪ אחרון</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('bulkRichBody','{{שיוך}}')">שיוך</button>
            <button type="button" class="re-btn re-field" onclick="insertMergeField('bulkRichBody','{{עיר}}')">עיר</button>
          </div>
          <div id="bulkRichBody" contenteditable="true"
            data-placeholder="תוכן ההודעה..."
            style="min-height:120px;border:1px solid var(--border);border-radius:0 0 8px 8px;padding:10px 12px;font-size:13px;font-family:Heebo,sans-serif;direction:rtl;text-align:right;outline:none;line-height:1.6;background:white"></div>
          <textarea id="bulkEmailBody" style="display:none"></textarea>
          <div style="font-size:10px;color:var(--muted);margin-top:4px">שדות {{...}} יוחלפו אוטומטית בנתוני כל תורם בשליחה</div>
        </div>
      </div>
      <div id="bulkEmailProgress" style="display:none;margin-top:12px">
        <div style="background:var(--cream-d,#e5e7eb);border-radius:4px;overflow:hidden;height:8px">
          <div id="bulkEmailProgressBar" style="background:var(--navy);height:100%;width:0%;transition:width .4s"></div>
        </div>
        <div id="bulkEmailStatus" style="font-size:12px;color:var(--muted);margin-top:6px;text-align:center"></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('bulkEmailModal')">ביטול</button>
      <button class="btn btn-navy" id="bulkEmailSendBtn" onclick="sendBulkEmails()">✉️ שלח לכולם</button>
    </div>
  </div>
</div>

<!-- DUPLICATE DETECTION MODAL -->
<div class="modal-overlay" id="duplicateModal">
  <div class="modal modal-lg">
    <div class="modal-header"><h3>🔍 בדיקת כפילויות</h3><button class="modal-close" onclick="closeModal('duplicateModal')">✕</button></div>
    <div class="modal-body" style="padding:0">
      <div style="padding:14px 16px;border-bottom:1px solid var(--border);font-size:12px;color:var(--muted)">
        סורק כפילויות לפי: טלפון, סלולרי, מייל (שמות וכתובות כפולות אינן נחשבות לבעיה)
      </div>
      <div style="max-height:520px;overflow-y:auto;padding:16px" id="dupBody"></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('duplicateModal')">סגור</button></div>
  </div>
</div>

<!-- MERGE DONOR MODAL -->
<div class="modal-overlay" id="mergeModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>🔀 מיזוג כרטיסי תורם</h3><button class="modal-close" onclick="closeModal('mergeModal')">✕</button></div>
    <div class="modal-body" id="mergeOptions"></div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('mergeModal')">ביטול</button>
      <button class="btn btn-navy" onclick="confirmMerge()">🔀 מזג</button>
    </div>
  </div>
</div>

<!-- NEDARIM IMPORT MODAL -->
<div class="modal-overlay" id="nedarimImportModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>📥 ייבוא מנדרים פלוס</h3><button class="modal-close" onclick="closeModal('nedarimImportModal')">✕</button></div>
    <div class="modal-body">
      <div style="background:var(--teal-bg);border-radius:8px;padding:12px 14px;font-size:12px;color:#0e7490;margin-bottom:14px">
        <strong>הנחיות:</strong> ייצא דוח תרומות מנדרים פלוס כקובץ Excel, ואז העלה אותו כאן.<br>
        שדות מזוהים: טלפון, סלולרי, מייל, שם פרטי, שם משפחה, סכום, תאריך, כתובת.
      </div>
      <label class="btn btn-outline" style="cursor:pointer;display:block;text-align:center;padding:20px;border-style:dashed">
        📂 בחר קובץ Excel מנדרים פלוס (.xlsx / .xls / .csv)
        <input type="file" id="ndImportFile" accept=".xlsx,.xls,.csv" style="display:none" onchange="processNedarimImport(this)">
      </label>
      <div id="ndImportStatus" style="margin-top:10px;font-size:12px;text-align:center"></div>
      <div id="ndImportResult" style="margin-top:12px;display:none"></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('nedarimImportModal')">סגור</button></div>
  </div>
</div>

<!-- YEMOT SETTINGS MODAL -->
<div class="modal-overlay" id="yemotSettingsModal">
  <div class="modal">
    <div class="modal-header"><h3>📞 ימות המשיח — הגדרות API</h3><button class="modal-close" onclick="closeModal('yemotSettingsModal')">✕</button></div>
    <div class="modal-body">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
        <!-- Connection settings -->
        <div>
          <h4 style="font-size:13px;font-weight:700;margin-bottom:12px;color:var(--navy)">🔌 חיבור</h4>
          <div style="display:flex;flex-direction:column;gap:10px">
            <div class="fg"><label class="form-label">מספר מערכת</label><input class="form-control" id="ymUsername" placeholder="0700000000"></div>
            <div class="fg"><label class="form-label">API Key (מפתח קבוע)</label><input class="form-control" id="ymApiKey" placeholder="מפתח מממשק חומת האש" type="password"></div>
            <div class="fg"><label class="form-label">מזהה תבנית קמפיין (templateId)</label><input class="form-control" id="ymTemplateId" placeholder="מספר תבנית לסנכרון"></div>
            <div id="ymStatus" style="font-size:12px;padding:8px;border-radius:6px;display:none"></div>
            <button class="btn btn-outline btn-sm" onclick="testYemotConnection()">🔍 בדוק חיבור</button>
          </div>
        </div>
        <!-- Webhook / IVR settings -->
        <div>
          <h4 style="font-size:13px;font-weight:700;margin-bottom:12px;color:var(--navy)">🔗 Webhook לשלוחה טלפונית</h4>
          <div style="background:var(--cream);border-radius:8px;padding:12px;font-size:12px">
            <p style="margin-bottom:8px">כדי לאפשר פעולות טלפוניות (עדכון פרטים, תרומה, יעד מתרים) יש להגדיר שלוחה חיצונית במערכת ימות שתפנה לכתובת ה-Webhook:</p>
            <div style="font-family:monospace;font-size:11px;background:white;padding:8px;border-radius:5px;word-break:break-all;border:1px solid var(--border);direction:ltr" id="ymWebhookUrl">
              הכנס Supabase Project URL לקבלת כתובת...
            </div>
            <div class="fg" style="margin-top:10px"><label class="form-label" style="font-size:11px">Supabase Project URL</label>
              <input class="form-control" id="ymSupabaseUrl" placeholder="https://xxx.supabase.co" oninput="updateWebhookUrl()">
            </div>
          </div>
          <div style="margin-top:12px">
            <h5 style="font-size:12px;font-weight:600;margin-bottom:6px">קוד Edge Function להעתקה:</h5>
            
          </div>
        </div>
      </div>
      <hr style="border:none;border-top:1px solid var(--border);margin:16px 0">
      <!-- Actions -->
      <h4 style="font-size:13px;font-weight:700;margin-bottom:12px;color:var(--navy)">⚡ פעולות</h4>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        
        
      </div>
      <div id="ymActionResult" style="margin-top:10px;font-size:12px;display:none"></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('yemotSettingsModal')">ביטול</button>
      <button class="btn btn-navy" onclick="saveYemotSettings()">שמור</button>
    </div>
  </div>
</div>

<!-- YEMOT EDGE FUNCTION CODE MODAL -->
<div class="modal-overlay" id="edgeFnModal">
  <div class="modal modal-lg">
    <div class="modal-header"><h3>📋 קוד Supabase Edge Function — ימות המשיח IVR</h3><button class="modal-close" onclick="closeModal('edgeFnModal')">✕</button></div>
    <div class="modal-body" style="padding:0">
      <div style="padding:12px 16px;background:var(--gold-bg);font-size:12px;border-bottom:1px solid var(--border)">
        <strong>הוראות:</strong> 1. פתח Supabase Dashboard → Edge Functions → New Function → שם: <code>yemot-ivr</code> 2. הדבק את הקוד הבא 3. Deploy 4. הגדר את הURL בשלוחה החיצונית בימות המשיח
      </div>
      <div style="position:relative">
        
        <pre id="edgeFnCode" style="background:#1e293b;color:#e2e8f0;padding:20px;font-size:11px;overflow-x:auto;max-height:500px;margin:0;border-radius:0 0 12px 12px;direction:ltr;text-align:left"></pre>
      </div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('edgeFnModal')">סגור</button></div>
  </div>
</div>

<!-- AUDIT LOG MODAL -->
<div class="modal-overlay" id="auditModal">
  <div class="modal modal-lg">
    <div class="modal-header"><h3>📜 לוג פעולות מלא</h3><button class="modal-close" onclick="closeModal('auditModal')">✕</button></div>
    <div class="modal-body" style="padding:0">
      <div style="display:flex;gap:8px;padding:14px 16px;border-bottom:1px solid var(--border);flex-wrap:wrap">
        <input type="text" class="search-input" id="auditSearch" placeholder="🔍 חיפוש..." oninput="renderAuditLog()" style="max-width:200px">
        <select class="filter-select" id="auditUser" onchange="renderAuditLog()"><option value="">כל המשתמשים</option></select>
        <select class="filter-select" id="auditType" onchange="renderAuditLog()">
          <option value="">כל הפעולות</option>
          <option value="create">יצירה</option><option value="edit">עריכה</option><option value="delete">מחיקה</option>
          <option value="import">ייבוא</option><option value="export">ייצוא</option><option value="print">הדפסה</option><option value="login">כניסה</option>
        </select>
        <button class="btn btn-outline btn-sm" onclick="clearAuditLog()">🗑️ נקה לוג</button>
      </div>
      <div class="table-scroll" style="max-height:500px">
        <table style="width:100%">
          <thead><tr>
            <th style="width:140px">תאריך ושעה</th>
            <th style="width:100px">משתמש</th>
            <th style="width:100px">סוג פעולה</th>
            <th>תיאור</th>
            <th style="width:80px">שחזור</th>
          </tr></thead>
          <tbody id="auditBody"></tbody>
        </table>
      </div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('auditModal')">סגור</button></div>
  </div>
</div>

<!-- NEDARIM PLUS SETTINGS MODAL -->
<div class="modal-overlay" id="nedarimSettingsModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>💳 הגדרות נדרים פלוס</h3><button class="modal-close" onclick="closeModal('nedarimSettingsModal')">✕</button></div>
    <div class="modal-body">
      <div style="background:var(--teal-bg);border-radius:8px;padding:10px 14px;font-size:12px;color:#0e7490;margin-bottom:14px">הגדר את פרטי הארגון שלך בנדרים פלוס. הפרטים נדרשים לביצוע תרומות אשראי.</div>
      <div style="display:flex;flex-direction:column;gap:12px">
        <div class="fg"><label class="form-label">קוד מוסד (Mosad)</label><input class="form-control" id="ndMosad" placeholder="קוד המוסד שלך בנדרים פלוס"></div>
        <div class="fg"><label class="form-label">מפתח API (ApiValid)</label><input class="form-control" id="ndApiKey" placeholder="מפתח ה-API"></div>
        <div class="fg"><label class="form-label">תיאור ברירת מחדל</label><input class="form-control" id="ndDefaultDesc" placeholder="תרומה לעזר תורה"></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('nedarimSettingsModal')">ביטול</button>
      <button class="btn btn-navy" onclick="saveNedarimSettings()">שמור</button>
    </div>
  </div>
</div>

<!-- NEDARIM PLUS PAYMENT MODAL -->
<div class="modal-overlay" id="nedarimPayModal">
  <div class="modal modal-lg">
    <div class="modal-header"><h3>💳 תרומה באשראי — נדרים פלוס</h3><button class="modal-close" onclick="closeNedarimModal()">✕</button></div>
    <div class="modal-body" style="padding:12px">
      <div id="nedarimIframeWrap" style="min-height:500px;position:relative">
        <iframe id="nedarimIframe" style="width:100%;height:550px;border:none;border-radius:8px" allow="payment"></iframe>
        <div id="nedarimLoading" style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:white;flex-direction:column;gap:12px">
          <div style="font-size:30px">💳</div>
          <div>טוען ממשק תשלום...</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- COMPOSE MESSAGE MODAL -->
<div class="modal-overlay" id="composeMsgModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>✉️ הודעה חדשה</h3><button class="modal-close" onclick="closeModal('composeMsgModal')">✕</button></div>
    <div class="modal-body">
      <div style="display:flex;flex-direction:column;gap:12px">
        <div class="fg"><label class="form-label">אל <span class="req">*</span></label>
          <select class="form-control" id="msgTo"><option value="">בחר משתמש...</option><option value="__ALL__" style="font-weight:700;color:#c00">📢 כל המשתמשים (שידור)</option></select>
        </div>
        <div class="fg"><label class="form-label">כותרת <span class="req">*</span></label><input class="form-control" id="msgSubject" placeholder="נושא ההודעה"></div>
        <div class="fg"><label class="form-label">תוכן</label><textarea class="form-control" id="msgBody" rows="5" placeholder="תוכן ההודעה..."></textarea></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('composeMsgModal')">ביטול</button>
      <button class="btn btn-navy" onclick="sendMessage()">שלח ✉️</button>
    </div>
  </div>
</div>

<!-- DONOR SELF-SERVICE EXPORT MODAL -->
<div class="modal-overlay" id="selfServiceModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>🔗 קישור עצמי לתורם</h3><button class="modal-close" onclick="closeModal('selfServiceModal')">✕</button></div>
    <div class="modal-body">
      <div style="background:var(--purple-bg);border-radius:8px;padding:12px;font-size:13px;margin-bottom:14px">
        <strong>איך זה עובד:</strong> התורם מקבל קישור ייחודי לעדכון פרטיו. השינויים נשמרים כבקשות ממתינות לאישור המנהל.
      </div>
      <div id="selfServiceContent"></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('selfServiceModal')">סגור</button></div>
  </div>
</div>

<!-- PENDING EDITS APPROVAL MODAL -->
<div class="modal-overlay" id="pendingEditsModal">
  <div class="modal modal-lg">
    <div class="modal-header"><h3>📝 בקשות עדכון ממתינות</h3><button class="modal-close" onclick="closeModal('pendingEditsModal')">✕</button></div>
    <div class="modal-body" style="padding:0">
      <div id="pendingEditsList" style="padding:16px"></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('pendingEditsModal')">סגור</button></div>
  </div>
</div>

<!-- CAMPAIGN MGMT MODAL -->
<div class="modal-overlay" id="campMgmtModal">
  <div class="modal modal-lg">
    <div class="modal-header"><h3>🎯 ניהול מגביות</h3><button class="modal-close" onclick="closeModal('campMgmtModal')">✕</button></div>
    <div class="modal-body">
      <div style="margin-bottom:14px;text-align:left"><button class="btn btn-gold" onclick="openNewCampaignModal()">+ מגבית חדשה</button></div>
      <div id="campMgmtList"></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('campMgmtModal')">סגור</button></div>
  </div>
</div>

<!-- EXPORT WIZARD MODAL -->
<div class="modal-overlay" id="exportWizard">
  <div class="modal modal-lg">
    <div class="modal-header"><h3>📤 אשף ייצוא</h3><button class="modal-close" onclick="closeModal('exportWizard')">✕</button></div>
    <div class="modal-body">
      <h4 style="font-size:13px;font-weight:700;margin-bottom:12px">פילטרים</h4>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px">
        <div class="fg"><label class="form-label">שיוך</label>
          <select class="form-control" id="ex_affil"><option value="">הכל</option></select></div>
        <div class="fg"><label class="form-label">מגבית</label>
          <select class="form-control" id="ex_camp"><option value="">הכל</option></select></div>
        <div class="fg"><label class="form-label">סכום מינימלי כולל (₪)</label>
          <input class="form-control" id="ex_minTotal" type="number" placeholder="0" min="0"></div>
        <div class="fg"><label class="form-label">סכום מינ' במגבית (₪)</label>
          <input class="form-control" id="ex_minCamp" type="number" placeholder="0" min="0"></div>
        <div class="fg"><label class="form-label">מתאריך</label>
          <input class="form-control" id="ex_from" type="date"></div>
        <div class="fg"><label class="form-label">עד תאריך</label>
          <input class="form-control" id="ex_to" type="date"></div>
      </div>
      <h4 style="font-size:13px;font-weight:700;margin-bottom:8px">עמודות לייצוא</h4>
      <div style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:12px" id="ex_cols">
        <label class="col-pick"><input type="checkbox" value="קוד" checked> קוד</label>
        <label class="col-pick"><input type="checkbox" value="שם" checked> שם</label>
        <label class="col-pick"><input type="checkbox" value="שיוך" checked> שיוך</label>
        <label class="col-pick"><input type="checkbox" value="כתובת" checked> כתובת</label>
        <label class="col-pick"><input type="checkbox" value="טלפון" checked> טלפון</label>
        <label class="col-pick"><input type="checkbox" value="סלולרי" checked> סלולרי</label>
        <label class="col-pick"><input type="checkbox" value="מייל"> מייל</label>
        <label class="col-pick"><input type="checkbox" value="מועד תרמה"> מועד תרמה</label>
        <label class="col-pick"><input type="checkbox" value="סך תרומות" checked> סך תרומות</label>
        <label class="col-pick"><input type="checkbox" value="תרומה גבוהה"> תרומה גבוהה</label>
        <label class="col-pick"><input type="checkbox" value="מספר תרומות"> מספר תרומות</label>
        <label class="col-pick"><input type="checkbox" value="הערות"> הערות</label>
      </div>
      <div id="ex_preview" style="font-size:12px;background:var(--cream);padding:8px 12px;border-radius:7px;color:var(--muted)">לחץ על תצוגה מקדימה לפני הייצוא</div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline btn-sm" onclick="closeModal('exportWizard')">ביטול</button>
      <button class="btn btn-outline btn-sm" onclick="previewExport()">👁 תצוגה מקדימה</button>
      <button class="btn btn-navy" onclick="runExportWizard()">📥 ייצא לאקסל</button>
    </div>
  </div>
</div>

<!-- REPORTS MODAL -->
<div class="modal-overlay" id="reportsModal">
  <div class="modal modal-xl" style="width:780px">
    <div class="modal-header"><h3>📊 דוחות וסינון מתקדם</h3><button class="modal-close" onclick="closeModal('reportsModal')">✕</button></div>
    <div class="modal-body">
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:14px">
        <div class="fg"><label class="form-label">עיר</label><input class="form-control" id="rpt_city" placeholder="תל אביב..."></div>
        <div class="fg"><label class="form-label">שכונה / רחוב</label><input class="form-control" id="rpt_neigh" placeholder="שכונה / רחוב..."></div>
        <div class="fg"><label class="form-label">מספר קבוצה</label><input class="form-control" id="rpt_grpcode" placeholder="101..."></div>
        <div class="fg"><label class="form-label">שם תורם</label><input class="form-control" id="rpt_name" placeholder="חלק משם..."></div>
        <div class="fg"><label class="form-label">שיוך</label><select class="form-control" id="rpt_affil"><option value="">הכל</option></select></div>
        <div class="fg"><label class="form-label">התאמות (קשר)</label><select class="form-control" id="rpt_reltype"><option value="">הכל</option></select></div>
        <div class="fg"><label class="form-label">מועד תרמה</label><select class="form-control" id="rpt_preftime"><option value="">הכל</option></select></div>
        <div class="fg"><label class="form-label">מגבית</label><select class="form-control" id="rpt_camp"><option value="">הכל</option></select></div>
        <div class="fg"><label class="form-label">תרומה מינ' (₪)</label><input class="form-control" id="rpt_minamt" type="number" placeholder="0" min="0"></div>
        <div class="fg"><label class="form-label">הוסף מ-תאריך</label><input class="form-control" id="rpt_addfrom" type="date"></div>
        <div class="fg"><label class="form-label">הוסף עד-תאריך</label><input class="form-control" id="rpt_addto" type="date"></div>
        <div class="fg"><label class="form-label">תרומה אחרונה מ-</label><input class="form-control" id="rpt_lastfrom" type="date"></div>
      </div>
      <div id="rpt_count" style="font-size:13px;color:var(--muted);margin-bottom:10px"></div>
      <div style="overflow-x:auto;max-height:300px;overflow-y:auto">
        <table id="rpt_table" style="width:100%;min-width:600px;border-collapse:collapse;font-size:12px">
          <thead style="background:var(--navy);color:white;position:sticky;top:0">
            <tr>
              <th style="padding:7px 10px;text-align:right">שם</th>
              <th style="padding:7px 10px;text-align:right">כתובת</th>
              <th style="padding:7px 10px;text-align:right">טלפון</th>
              <th style="padding:7px 10px;text-align:right">שיוך</th>
              <th style="padding:7px 10px;text-align:right">סך תרומות</th>
              <th style="padding:7px 10px;text-align:right">תרומה אחרונה</th>
            </tr>
          </thead>
          <tbody id="rpt_body"></tbody>
        </table>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline btn-sm" onclick="closeModal('reportsModal')">סגור</button>
      <button class="btn btn-outline btn-sm" onclick="runReport()">🔍 הפעל סינון</button>
      <button class="btn btn-outline btn-sm" onclick="openExportWizard('donors')">📥 ייצוא לאקסל</button>
      <button class="btn btn-navy" onclick="printReport()">🖨️ הדפסה</button>
    </div>
  </div>
</div>

<!-- PRINT MODAL -->
<div class="modal-overlay" id="printModal">
  <div class="modal" style="width:560px">
    <div class="modal-header"><h3>🖨️ מרכז הדפסות</h3><button class="modal-close" onclick="closeModal('printModal')">✕</button></div>
    <div class="modal-body">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        
        <div class="admin-card" onclick="openLabelsWizard()" style="cursor:pointer">
          <div class="ac-icon">🏷️</div>
          <div class="ac-title">מדבקות</div>
          <div class="ac-sub">Tanex — בחירת נתונים ועיצוב</div>
        </div>
        
        <div class="admin-card" onclick="openFundraisingPrint()" style="cursor:pointer">
          <div class="ac-icon">📋</div>
          <div class="ac-title">גיליון התרמה</div>
          <div class="ac-sub">לפי עיר / שכונה / קבוצה</div>
        </div>
        
        <div class="admin-card" onclick="printGroupsOverview()" style="cursor:pointer">
          <div class="ac-icon">👥</div>
          <div class="ac-title">סקירת קבוצות</div>
          <div class="ac-sub">כל הקבוצות והחברים</div>
        </div>
        
        <div class="admin-card" onclick="printCampaignSummary()" style="cursor:pointer">
          <div class="ac-icon">📈</div>
          <div class="ac-title">סיכום מגבית</div>
          <div class="ac-sub">נתוני המגבית הפעילה</div>
        </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline btn-sm" onclick="closeModal('printModal')">סגור</button>
    </div>
  </div>
</div>

<!-- LABELS WIZARD MODAL -->
<div class="modal-overlay" id="labelsWizardModal">
  <div class="modal modal-lg" style="width:680px">
    <div class="modal-header"><h3>🏷️ אשף הדפסת מדבקות</h3><button class="modal-close" onclick="closeModal('labelsWizardModal')">✕</button></div>
    <div class="modal-body">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
        <div>
          <h4 style="font-size:13px;font-weight:700;margin-bottom:10px">1. מקור נתונים</h4>
          <select class="form-control" id="lb_source" style="margin-bottom:8px">
            <option value="all">כל התורמים</option>
            <option value="filtered">תורמים מסוננים (לפי פאנל ניהול)</option>
            <option value="group">קבוצה ספציפית</option>
          </select>
          <select class="form-control" id="lb_group_sel" style="display:none;margin-bottom:8px">
            <option value="">-- בחר קבוצה --</option>
          </select>
          
          <h4 style="font-size:13px;font-weight:700;margin:10px 0 8px">2. פורמט Tanex</h4>
          <div style="display:flex;flex-direction:column;gap:6px">
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:7px;border:1px solid var(--border);border-radius:7px">
              <input type="radio" name="lb_fmt" value="70x42" checked> 
              <div><strong>70×42 מ"מ</strong> — 21 מדבקות לדף (3×7)</div>
            </label>
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:7px;border:1px solid var(--border);border-radius:7px">
              <input type="radio" name="lb_fmt" value="70x29">
              <div><strong>70×29.7 מ"מ</strong> — 30 מדבקות לדף (3×10)</div>
            </label>
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:7px;border:1px solid var(--border);border-radius:7px">
              <input type="radio" name="lb_fmt" value="105x42">
              <div><strong>105×42 מ"מ</strong> — 14 מדבקות לדף (2×7)</div>
            </label>
          </div>
        </div>
        <div>
          <h4 style="font-size:13px;font-weight:700;margin-bottom:10px">3. תוכן המדבקה</h4>
          <div style="display:flex;flex-direction:column;gap:5px" id="lb_fields">
            <label class="lb-field-opt"><input type="checkbox" id="lbf_greeting" checked> פתיח (לכבוד...)</label>
            <label class="lb-field-opt"><input type="checkbox" id="lbf_title" checked> תואר</label>
            <label class="lb-field-opt"><input type="checkbox" id="lbf_name" checked> שם מלא</label>
            <label class="lb-field-opt"><input type="checkbox" id="lbf_closing" checked> שם סגירה</label>
            <label class="lb-field-opt"><input type="checkbox" id="lbf_address" checked> כתובת</label>
            <label class="lb-field-opt"><input type="checkbox" id="lbf_city"> עיר בנפרד</label>
            <label class="lb-field-opt"><input type="checkbox" id="lbf_phone"> טלפון</label>
          </div>
          <h4 style="font-size:13px;font-weight:700;margin:12px 0 8px">4. עיצוב</h4>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:7px">
            <div class="fg"><label class="form-label">גודל גופן</label>
              <select class="form-control" id="lb_fontsize">
                <option value="8">8pt</option><option value="9" selected>9pt</option><option value="10">10pt</option><option value="11">11pt</option>
              </select>
            </div>
            <div class="fg"><label class="form-label">גופן</label>
              <select class="form-control" id="lb_font">
                <option value="Arial" selected>Arial</option><option value="David">David</option><option value="Tahoma">Tahoma</option>
              </select>
            </div>
          </div>
          <div id="lb_preview_box" style="margin-top:10px;border:1px solid var(--border);border-radius:7px;padding:10px;background:white;font-size:12px;min-height:60px">
            <div style="font-size:10px;color:var(--muted);margin-bottom:4px">תצוגה מקדימה:</div>
            <div id="lb_preview"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline btn-sm" onclick="closeModal('labelsWizardModal')">ביטול</button>
      <button class="btn btn-outline btn-sm" onclick="previewLabel()">👁 תצוגה מקדימה</button>
      <button class="btn btn-navy" onclick="runPrintLabels()">🖨️ הדפס</button>
    </div>
  </div>
</div>

<!-- FUNDRAISING PRINT MODAL -->
<div class="modal-overlay" id="frPrintModal">
  <div class="modal modal-lg" style="width:640px">
    <div class="modal-header"><h3>📋 הדפסת גיליון התרמה</h3><button class="modal-close" onclick="closeModal('frPrintModal')">✕</button></div>
    <div class="modal-body">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
        <div class="fg"><label class="form-label">סוג חלוקה</label>
          <select class="form-control" id="frp_type" onchange="onFrpTypeChange()">
            <option value="group">לפי קבוצה</option>
            <option value="city">לפי עיר</option>
            <option value="neigh">לפי שכונה / רחוב</option>
          </select>
        </div>
        <div class="fg" id="frp_group_row">
          <label class="form-label">קבוצה</label>
          <select class="form-control" id="frp_group">
            <option value="">כל הקבוצות</option>
          </select>
        </div>
        <div class="fg" id="frp_city_row" style="display:none">
          <label class="form-label">עיר</label>
          <input class="form-control" id="frp_city" placeholder="תל אביב...">
        </div>
        <div class="fg" id="frp_neigh_row" style="display:none">
          <label class="form-label">שכונה / רחוב</label>
          <input class="form-control" id="frp_neigh" placeholder="שכונה...">
        </div>
        <div class="fg" style="grid-column:span 2">
          <label class="form-label">מגבית (להצגת נתונים)</label>
          <select class="form-control" id="frp_camp">
            <option value="">מגבית פעילה</option>
          </select>
        </div>
      </div>
      <div id="frp_preview" style="margin-top:10px;font-size:12px;color:var(--muted)"></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline btn-sm" onclick="closeModal('frPrintModal')">ביטול</button>
      <button class="btn btn-outline btn-sm" onclick="previewFrPrint()">👁 תצוגה מקדימה</button>
      <button class="btn btn-navy" onclick="runFrPrint()">🖨️ הדפס</button>
    </div>
  </div>
</div>

</div><!-- /app -->
</div><!-- /mainContent -->
</div><!-- /appWrapper -->
</div><!-- /mainContent -->
</div><!-- /appWrapper -->

<!-- ══════════════ MODALS ══════════════ -->

<!-- DONOR MODAL -->
<div class="modal-overlay" id="donorModal">
  <div class="modal modal-lg">
    <div class="modal-header">
      <h3 id="donorModalTitle">תורם חדש</h3>
      <div style="display:flex;gap:6px;align-items:center;flex-wrap:wrap">
        <button class="btn btn-danger btn-sm" id="deleteDonorBtn" onclick="deleteCurrentDonor()" style="display:none">🗑️ מחק</button>
        <button class="btn btn-outline btn-sm" id="donorCreditBtn" onclick="openNedarimForCurrentDonor()" style="background:rgba(255,255,255,.15);border-color:rgba(255,255,255,.4);color:white;display:none">💳 אשראי</button>
        <button class="btn btn-outline btn-sm" id="donorSelfLinkBtn" onclick="openSelfServiceForDonor(currentDonorId)" style="background:rgba(255,255,255,.15);border-color:rgba(255,255,255,.4);color:white;display:none">🔗 קישור עצמי</button>
        <button class="btn btn-outline btn-sm" id="donorEmailBtn" onclick="openSendEmailModal(currentDonorId)" style="background:rgba(255,255,255,.15);border-color:rgba(255,255,255,.4);color:white;display:none">📧 שלח מייל</button>
        <button class="btn btn-outline btn-sm" id="saveNewDonorBtn" onclick="saveDonorAndNew()" style="background:rgba(255,255,255,.15);border-color:rgba(255,255,255,.4);color:white">💾 שמור + חדש</button>
        <button class="btn btn-gold btn-sm" id="saveDonorBtnTop" onclick="saveDonor()">✔ שמור</button>
        <button class="modal-close" onclick="closeModal('donorModal')">✕</button>
      </div>
    </div>
    <div class="modal-body">
      <div class="tabs">
        <div class="tab active" id="dt-details" onclick="switchDTab('details')">📋 פרטים</div>
        <div class="tab" id="dt-donations" onclick="switchDTab('donations')">💰 תרומות</div>
        <div class="tab" id="dt-future" onclick="switchDTab('future')">⭐ עתידיות</div>
        <div class="tab" id="dt-relations" onclick="switchDTab('relations')">🔗 התאמות</div>
      </div>

      <!-- DETAILS TAB -->
      <div id="dc-details">
        <div class="fg3">
          <div class="fg"><label class="form-label">קוד תורם</label><input class="form-control" id="f_code" readonly></div>
          <div class="fg"><label class="form-label">ת"ז / דרכון <span style="font-size:10px;color:var(--muted)">(לא חובה)</span></label>
            <div class="ig"><input class="form-control" id="f_idNumber" placeholder="מספר ת״ז (9 ספרות)" maxlength="9" inputmode="numeric" oninput="validateIdField(this)" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_title').focus()}"><span id="f_idValidIcon" style="padding:0 8px;font-size:14px;line-height:36px"></span></div>
            <div id="f_idError" style="color:var(--danger);font-size:11px;margin-top:2px;display:none">מספר תעודת זהות לא תקין</div>
          </div>

          <div class="fg"><label class="form-label">תואר</label>
            <select class="form-control" id="f_title" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_firstName').focus()}"><option value="">ללא</option><option>הרב</option><option>ד"ר</option><option>פרופ'</option><option>מר</option><option>גב'</option><option>הרבנית</option><option>האדמו"ר</option></select>
          </div>
          <div class="fg"><label class="form-label">שם פרטי <span class="req">*</span></label><input class="form-control" id="f_firstName" placeholder="שם פרטי" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_lastName').focus()}"></div>
          <div class="fg"><label class="form-label">שם משפחה <span class="req">*</span></label><input class="form-control" id="f_lastName" placeholder="שם משפחה" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_closingName').focus()}"></div>
          <div class="fg"><label class="form-label">שם סגירה</label>
            <select class="form-control" id="f_closingName" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_affil').focus()}"><option value="">-</option><option>בברכה</option><option>בכבוד רב</option><option>בהוקרה</option><option>בידידות</option><option>בתודה</option><option>יישר כח</option></select>
          </div>
          <div class="fg"><label class="form-label">שיוך</label>
            <select class="form-control" id="f_affil" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_address').focus()}"><option value="">-</option><option>תלמיד</option><option>בוגר</option><option>הורה תלמיד</option><option>הורה בוגר</option><option>מכר</option><option>עסקי</option><option>אחר</option></select>
          </div>
          <div class="fg half"><label class="form-label">כתובת מלאה</label>
            <div style="position:relative">
              <input class="form-control" id="f_address" placeholder="רחוב, מספר, עיר" autocomplete="off" oninput="addressAutocomplete(this.value)" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_entrance').focus()}">
              <div id="addressSuggestions" style="position:absolute;top:100%;right:0;left:0;background:white;border:1.5px solid var(--border);border-top:none;border-radius:0 0 8px 8px;z-index:100;max-height:200px;overflow-y:auto;display:none"></div>
            </div>
            <div id="addressMapPreview" style="margin-top:6px;display:none;border-radius:8px;overflow:hidden;height:120px"></div>
          </div>
          <div class="fg"><label class="form-label">כניסה / קומה</label><input class="form-control" id="f_entrance" placeholder="כניסה א', קומה 3" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_phone').focus()}"></div>
          <div class="fg"><label class="form-label">טלפון</label><input class="form-control" id="f_phone" placeholder="02-..." onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_mobile').focus()}"></div>
          <div class="fg"><label class="form-label">סלולרי</label>
            <div class="ig"><input class="form-control" id="f_mobile" placeholder="05X-..." onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_email').focus()}"><button class="btn-icon wa" onclick="openWA()" title="WhatsApp">💬</button></div>
          </div>
          <div class="fg"><label class="form-label">מייל</label>
            <div class="ig"><input class="form-control" id="f_email" placeholder="email@example.com" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_prefTime').focus()}"><button class="btn-icon em" onclick="openMail()" title="שלח מייל">✉️</button></div>
          </div>

          <div class="fg"><label class="form-label">מועד תרמה רצוי</label>
            <select class="form-control" id="f_prefTime" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_marriageYear').focus()}"><option value="">לא נקבע</option><option>טלפוני לפני פורים</option><option>פורים בבית</option><option>טלפוני בפורים</option></select>
          </div>
          <div class="fg"><label class="form-label">שנת נישואין (עברי)</label><input class="form-control" id="f_marriageYear" placeholder="תשנ״ה" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_cohort').focus()}"></div>
          <div class="fg"><label class="form-label">מחזור (שנה עברית)</label><input class="form-control" id="f_cohort" placeholder="תשנ״ה" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_createdAt').focus()}"></div>
          <div class="fg"><label class="form-label">תאריך יצירה</label><input class="form-control" id="f_createdAt" type="date" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('f_notes').focus()}"></div>
          <div class="fg"><label class="form-label">עדכון אחרון</label><input class="form-control" id="f_updatedAt" type="text" readonly style="background:var(--cream);font-size:12px;color:var(--muted)" placeholder="טרם עודכן"></div>
          <div class="fg full"><label class="form-label">הערות</label><textarea class="form-control" id="f_notes" rows="2" placeholder="הערות..."></textarea></div>
        </div>
        <!-- Quick add donation button at bottom of details tab -->
        <div id="detailsTabDonSummary" style="margin-top:16px;padding:12px 14px;background:linear-gradient(135deg,#1a2744,#243358);border-radius:10px;color:white;display:none">
          <div style="display:flex;align-items:center;justify-content:space-between">
            <div>
              <div style="font-size:11px;opacity:.7;margin-bottom:2px">סך תרומות</div>
              <div id="detailsTabTotal" style="font-size:20px;font-weight:700;color:#c9a84c"></div>
            </div>
            <button class="btn btn-gold" onclick="openDonorAddDonation()" style="font-size:13px">+ הוסף תרומה</button>
          </div>
        </div>
      </div>

      <!-- DONATIONS TAB -->
      <div id="dc-donations" style="display:none">
        <div class="d-stats" id="donorStatsBox"></div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <strong style="font-size:14px">היסטוריית תרומות</strong>
          <button class="btn btn-gold btn-sm" onclick="toggleDonForm()" id="donFormBtn">+ הוסף תרומה</button>
        </div>
        <div id="donationFormBox" style="display:none;transition:all .2s;background:var(--cream);border-radius:10px;padding:16px;margin-bottom:14px">
          <div style="font-size:13px;font-weight:700;color:var(--navy);margin-bottom:10px">💰 <span id="donFormTitle">הוספת תרומה</span></div>
          <div class="fg2" style="gap:10px;margin-bottom:10px">
            <div class="fg"><label class="form-label">סכום (₪) <span class="req">*</span></label><input class="form-control" id="nd_amount" type="number" placeholder="0" min="0"></div>
            <div class="fg"><label class="form-label">תאריך תרומה</label><input class="form-control" id="nd_date" type="date"></div>
            <div class="fg"><label class="form-label">אופן תרומה</label>
              <select class="form-control" id="nd_method"><option>מזומן</option><option>אשראי</option><option>צ'ק</option><option>העברה בנקאית</option><option>אחר</option></select>
            </div>
            <div class="fg"><label class="form-label">מגבית</label><select class="form-control" id="nd_campaign"></select></div>
            <div class="fg"><label class="form-label">שיוך תרומה</label>
              <select class="form-control" id="nd_don_type" onchange="toggleDonAssignType()">
                <option value="fr">מתרים ספציפי</option>
                <option value="group">קבוצה (חלוקה שווה)</option>
                <option value="none">ללא שיוך</option>
              </select>
            </div>
            <div id="nd_fr_box" class="fg"><label class="form-label">שייך ל: 
                <span style="font-size:11px;font-weight:400">
                  <label style="cursor:pointer"><input type="radio" name="nd_mode" value="fr" checked onchange="toggleDonMode('nd')"> מתרים</label> &nbsp;
                  <label style="cursor:pointer"><input type="radio" name="nd_mode" value="grp" onchange="toggleDonMode('nd')"> קבוצה</label>
                </span>
              </label>
              <div id="nd_fr_wrap">
              <div class="input-group">
                <input class="form-control" id="nd_fr_search" placeholder="חפש שם / קוד מתרים..." oninput="searchFRinForm('nd_fr_search','nd_fr_results','nd_fr_id')">
                <button class="btn btn-outline btn-sm" onclick="clearFRSel('nd_fr_search','nd_fr_results','nd_fr_id')">✕</button>
              </div>
              </div>
              <div class="pick-results" id="nd_fr_results"></div>
              <input type="hidden" id="nd_fr_id">
              </div><!-- /nd_fr_wrap -->
              <div id="nd_grp_wrap" style="display:none">
                <input class="form-control" id="nd_grp_search" placeholder="חפש שם קבוצה / קוד..." oninput="searchGroupInForm('nd_grp')" style="margin-bottom:5px">
                <div id="nd_grp_results" class="pick-results" style="max-height:140px"></div>
                <input type="hidden" id="nd_grp_id">
                <div id="nd_grp_info" style="font-size:11px;color:var(--teal,#0891b2);margin-top:4px;padding:5px 8px;background:var(--cream);border-radius:5px;display:none"></div>
              </div>
            </div>
            <div class="fg full"><label class="form-label">הערות</label><input class="form-control" id="nd_notes" placeholder="הערות" onkeydown="if(event.key==='Enter')saveDonation()"></div>
          </div>
          <div style="display:flex;gap:8px;justify-content:flex-end">
            <button class="btn btn-outline btn-sm" onclick="cancelDonForm()">ביטול</button>
            <button class="btn btn-gold btn-sm" onclick="saveDonation()">שמור תרומה</button>
          </div>
          <input type="hidden" id="nd_editIdx" value="">
        </div>
        <table style="width:100%;border-collapse:collapse;font-size:13px">
          <thead style="background:var(--cream)"><tr>
            <th style="padding:8px 10px;text-align:right;font-size:11px;font-weight:700;color:var(--muted);border-bottom:2px solid var(--border)">תאריך</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;font-weight:700;color:var(--muted);border-bottom:2px solid var(--border)">ת' עברי</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;font-weight:700;color:var(--muted);border-bottom:2px solid var(--border)">סכום</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;font-weight:700;color:var(--muted);border-bottom:2px solid var(--border)">אופן</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;font-weight:700;color:var(--muted);border-bottom:2px solid var(--border)">מגבית</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;font-weight:700;color:var(--muted);border-bottom:2px solid var(--border)">מתרים</th>
            <th style="padding:8px 10px;text-align:right;font-size:11px;font-weight:700;color:var(--muted);border-bottom:2px solid var(--border)">הערות</th>
            <th style="padding:8px 10px;border-bottom:2px solid var(--border)"></th>
          </tr></thead>
          <tbody id="donationsBody"></tbody>
        </table>
      </div>

      <!-- FUTURE DONATIONS TAB -->
      <div id="dc-future" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
          <strong style="font-size:14px">תרומות עתידיות / תזכורות</strong>
          <button class="btn btn-purple btn-sm" onclick="toggleFutureForm()" id="futureFormBtn">⭐ הוסף תרומה עתידית</button>
        </div>
        <div id="futureFormBox" style="display:none;background:var(--purple-bg);border:1px solid #c4b5fd;border-radius:10px;padding:16px;margin-bottom:14px">
          <div style="font-size:13px;font-weight:700;color:var(--purple);margin-bottom:10px">⭐ <span id="futureFormTitle">הוספת תרומה עתידית</span></div>
          <div class="fg3" style="gap:10px;margin-bottom:10px">
            <div class="fg"><label class="form-label">תאריך יעד <span class="req">*</span></label><input class="form-control" id="nf_date" type="date"></div>
            <div class="fg"><label class="form-label">סכום צפוי (₪)</label><input class="form-control" id="nf_amount" type="number" placeholder="לא חובה" min="0"></div>
            <div class="fg"><label class="form-label">מגבית</label><select class="form-control" id="nf_campaign"></select></div>
            <div class="fg full"><label class="form-label">הערות / תזכורת</label><input class="form-control" id="nf_notes" placeholder="למשל: לתאם לאחר פורים..."></div>
          </div>
          <div style="display:flex;gap:8px;justify-content:flex-end">
            <button class="btn btn-outline btn-sm" onclick="cancelFutureForm()">ביטול</button>
            <button class="btn btn-purple btn-sm" onclick="saveFutureDonation()">שמור</button>
          </div>
          <input type="hidden" id="nf_editIdx" value="">
        </div>
        <div id="futureItemsList"></div>
      </div>

      <!-- RELATIONS TAB -->
      <div id="dc-relations" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;flex-wrap:wrap;gap:6px">
          <strong>התאמות — קשרים עם תורמים ומתרימים</strong>
          <div style="display:flex;gap:6px">
            <button class="btn btn-outline btn-sm" onclick="showRelSearch('donor')">🔗 הוסף תורם</button>
            <button class="btn btn-gold btn-sm" onclick="showRelSearch('fr')">👤 הוסף מתרים</button>
          </div>
        </div>
        <div id="relSearchBox" style="display:none;background:var(--cream);border-radius:10px;padding:14px;margin-bottom:14px">
          <div class="fg" style="margin-bottom:10px">
            <label class="form-label" id="relSearchLabel">חיפוש תורם</label>
            <input class="form-control" id="relSearch" placeholder="חפש לפי שם או קוד..." oninput="searchRelDonors()">
          </div>
          <div id="relResults" style="max-height:160px;overflow-y:auto;margin-bottom:8px"></div>
          <div id="relSelected" style="display:none">
            <div style="margin-bottom:8px;font-size:12px;font-weight:600;color:var(--navy)">נבחרו:</div>
            <div id="relSelectedList" style="margin-bottom:10px"></div>
            <div class="fg" style="margin-bottom:10px">
              <label class="form-label">סיבת שיוך</label>
              <select class="form-control" id="relType"><option>הורה</option><option>סבא</option><option>בן</option><option>שווער</option><option>אח</option><option>קרוב</option><option>מתרים</option></select>
            </div>
            <div style="display:flex;gap:8px;justify-content:flex-end">
              <button class="btn btn-outline btn-sm" onclick="cancelRel()">ביטול</button>
              <button class="btn btn-gold btn-sm" onclick="confirmRel()">הוסף שיוך</button>
            </div>
          </div>
        </div>
        <div id="relList"></div>
      </div>
    </div>
    <!-- footer replaced: buttons in header -->
  </div>
</div>

<!-- QUICK DONATION MODAL -->
<div class="modal-overlay" id="quickDonModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>💰 הוספת תרומה מהירה</h3><button class="modal-close" onclick="closeModal('quickDonModal')">✕</button></div>
    <div class="modal-body">
      <div class="fg" style="margin-bottom:12px">
        <label class="form-label">חיפוש תורם <span class="req">*</span></label>
        <input class="form-control" id="qd_search" placeholder="הזן שם או קוד תורם..." oninput="searchQDDonor()">
        <div id="qd_results" style="max-height:150px;overflow-y:auto;margin-top:6px"></div>
        <div id="qd_selected" style="display:none;margin-top:6px;padding:8px;background:var(--success-bg);border-radius:7px;font-size:13px"></div>
      </div>
      <div class="fg2" style="gap:10px;margin-bottom:10px">
        <div class="fg"><label class="form-label">סכום (₪) <span class="req">*</span></label><input class="form-control" id="qd_amount" type="number" placeholder="0" min="0"></div>
        <div class="fg"><label class="form-label">תאריך</label><input class="form-control" id="qd_date" type="date"></div>
        <div class="fg"><label class="form-label">אופן תרומה</label>
          <select class="form-control" id="qd_method"><option>מזומן</option><option>אשראי</option><option>צ'ק</option><option>העברה בנקאית</option><option>אחר</option></select>
        </div>
        <div class="fg"><label class="form-label">מגבית</label><select class="form-control" id="qd_campaign"></select></div>
        <div class="fg"><label class="form-label">מתרים</label>
          <div style="font-size:12px;margin-bottom:5px">
            <label style="cursor:pointer"><input type="radio" name="qd_mode" value="fr" checked onchange="toggleDonMode('qd')"> 👤 מתרים ספציפי</label>&nbsp;&nbsp;
            <label style="cursor:pointer"><input type="radio" name="qd_mode" value="grp" onchange="toggleDonMode('qd')"> 👥 קבוצה</label>
          </div>
          <div id="qd_fr_wrap">
            <div class="input-group">
              <input class="form-control" id="qd_fr_search" placeholder="חפש מתרים..." oninput="searchFRinForm('qd_fr_search','qd_fr_results','qd_fr_id')">
              <button class="btn btn-outline btn-sm" onclick="clearFRSel('qd_fr_search','qd_fr_results','qd_fr_id')" title="נקה">✕</button>
            </div>
            <div class="pick-results" id="qd_fr_results"></div>
            <input type="hidden" id="qd_fr_id">
          </div>
          <div id="qd_grp_wrap" style="display:none">
            <input class="form-control" id="qd_grp_search" placeholder="חפש שם קבוצה / קוד..." oninput="searchGroupInForm('qd_grp')" style="margin-bottom:5px">
            <div id="qd_grp_results" class="pick-results" style="max-height:130px"></div>
            <input type="hidden" id="qd_grp_id">
            <div id="qd_grp_info" style="font-size:11px;color:var(--teal,#0891b2);margin-top:4px;padding:5px 8px;background:var(--cream);border-radius:5px;display:none"></div>
          </div>
        </div>
        <div class="fg full"><label class="form-label">הערות</label><input class="form-control" id="qd_notes" placeholder="הערות" onkeydown="if(event.key==='Enter')saveQuickDonation()"></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline btn-sm" onclick="closeModal('quickDonModal')">ביטול</button>
      <button class="btn btn-outline btn-sm" onclick="saveQuickDonationAndNew()">💾 שמור וחדש</button>
      <button class="btn btn-navy" onclick="saveQuickDonation()">שמור תרומה</button>
    </div>
  </div>
</div>

<!-- CAMPAIGN MODAL -->
<div class="modal-overlay" id="campaignModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3 id="campModalTitle">מגבית חדשה</h3><button class="modal-close" onclick="closeModal('campaignModal')">✕</button></div>
    <div class="modal-body">
      <div class="fg3" style="gap:12px">
        <div class="fg half"><label class="form-label">שם המגבית <span class="req">*</span></label><input class="form-control" id="cm_name" placeholder="למשל: מגבית פורים תשפ"ה"></div>
        <div class="fg"><label class="form-label">שנה עברית</label><input class="form-control" id="cm_year" placeholder="תשפ"ה"></div>
        <div class="fg"><label class="form-label">סכום יעד (₪)</label><input class="form-control" id="cm_goal" type="number" placeholder="0" min="0"></div>
        <div class="fg">
          <label class="form-label">תאריך יעד</label>
          <div style="display:flex;gap:6px">
            <input class="form-control" id="cm_deadline" type="date" style="flex:2">
            <input class="form-control" id="cm_deadline_time" type="time" value="23:59" style="flex:1" placeholder="שעה">
          </div>
        </div>
        <div class="fg"><label class="form-label">סטטוס</label>
          <select class="form-control" id="cm_active">
            <option value="true">פעילה</option>
            <option value="false">לא פעילה</option>
          </select>
        </div>
        <div class="fg full"><label class="form-label">תיאור</label><textarea class="form-control" id="cm_desc" rows="2" placeholder="תיאור קצר..."></textarea></div>
      </div>
      <div style="background:var(--gold-bg);border-radius:8px;padding:10px;margin-top:12px;font-size:12px;color:#7a5c00">
        ⚠️ רק מגבית אחת יכולה להיות פעילה בו זמנית. סימון מגבית זו כפעילה תבטל את הפעילה הנוכחית.
      </div>
    </div>
    <div class="modal-footer">
      <input type="hidden" id="cm_editId">
      <button class="btn btn-outline btn-sm" onclick="closeModal('campaignModal')">ביטול</button>
      <button class="btn btn-navy" onclick="saveCampaign()">שמור מגבית</button>
    </div>
  </div>
</div>

<!-- USERS MODAL -->
<div class="modal-overlay" id="usersModal">
  <div class="modal">
    <div class="modal-header"><h3>👤 ניהול משתמשים</h3><button class="modal-close" onclick="closeModal('usersModal')">✕</button></div>
    <div class="modal-body">
      <div style="background:var(--teal-bg);border-radius:8px;padding:10px 14px;font-size:12px;color:#0e7490;margin-bottom:12px">
        4 רמות הרשאה: <strong>מנהל ראשי</strong> (הרשאות מלאות + ניהול משתמשים) | <strong>מנהל</strong> (עריכה מלאה) | <strong>עורך</strong> (עריכת תורמים ותרומות) | <strong>מבקר</strong> (צפייה בלבד)
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
        <span style="font-size:12px;color:var(--muted)">זיהוי המשתמש הוא לפי כתובת מייל</span>
        <button class="btn btn-gold btn-sm" onclick="addUserRow()">+ הוסף משתמש</button>
      </div>
      <div style="overflow-x:auto">
        <table class="users-table"><thead><tr><th>מייל</th><th>שם לתצוגה</th><th>סיסמה ראשונית</th><th>הרשאה</th><th>כניסה ראשונה</th><th></th></tr></thead><tbody id="usersBody"></tbody></table>
      </div>
    </div>
    <div class="modal-footer"><button class="btn btn-navy" onclick="saveUsers()">שמור</button></div>
  </div>
</div>

<!-- SETTINGS MODAL -->
<div class="modal-overlay" id="settingsModal">
  <div class="modal">
    <div class="modal-header"><h3>📋 עריכת נתונים קשיחים</h3><button class="modal-close" onclick="closeModal('settingsModal')">✕</button></div>
    <div class="modal-body" id="settingsBody"></div>
    <div class="modal-footer"><button class="btn btn-navy" onclick="saveSettings()">שמור וסגור</button></div>
  </div>
</div>

<!-- IMPORT MODAL -->
<div class="modal-overlay" id="importModal">
  <div class="modal modal-sm">
    <div class="modal-header"><h3>📥 ייבוא מאקסל</h3><button class="modal-close" onclick="closeModal('importModal')">✕</button></div>
    <div class="modal-body">
      <div style="background:var(--cream);border-radius:10px;padding:14px;margin-bottom:16px;font-size:12px">
        <strong style="font-size:13px">📋 מבנה קובץ האקסל לייבוא תורמים:</strong>
        <div style="margin-top:8px;font-family:monospace;font-size:11px;background:white;border-radius:6px;padding:10px;overflow-x:auto;white-space:nowrap;border:1px solid var(--border)">
          קוד תורם | תואר | שם פרטי | שם משפחה | שם סגירה | שיוך | כתובת | כניסה קומה | טלפון | סלולרי | מייל | שנת נישואין | מחזור | מועד תרמה | הערות
        </div>
        <div style="margin-top:8px;color:var(--muted)">
          <strong>שדות חובה:</strong> שם פרטי ו/או שם משפחה<br>
          <strong>קוד תורם:</strong> ייווצר אוטומטית אם ריק<br>
          <strong>שיוך:</strong> תלמיד / בוגר / הורה תלמיד / הורה בוגר / מכר / עסקי / אחר
        </div>
      </div>
      <label class="btn btn-outline" style="cursor:pointer;display:block;text-align:center;padding:20px">
        📂 בחר קובץ Excel (.xlsx / .xls)
        <input type="file" accept=".xlsx,.xls" style="display:none" onchange="importExcel(this)">
      </label>
      <div id="importStatus" style="margin-top:12px;font-size:13px"></div>
    </div>
  </div>
</div>

<script>
// ════════════════════════════════════════════════════
// DB
// ════════════════════════════════════════════════════
let DB = { donors:[], users:[], campaigns:[], nextCode:1001,
  yemotSettings: {
    apiKey: 'WU1BUElL.apik_WGPrDr7Q2qO5QhviKFYO9Q.mCDT1a-0fOYqnj3uMXVF9tjmi546QoXPwNQpVldaCm8',
    webhookUrl: 'https://bgnjupxlslelynbgyggt.supabase.co/functions/v1/yemot-ivr',
    pinType: 'none',
    orgName: 'עזר תורה',
  },
  emailSettings: {
    publicKey: 'wZ0dkVoeeimiBD_gx',
    serviceId: 'service_wohacxp',
    tplMessage: 'template_iz8no2o',
    tplReset: 'template_amj12tr',
    orgName: 'עזר תורה',
  }
};
let currentUser = null;
let currentDonorId = null;
let currentDTab = 'details';
let sortCol = 'name', sortDir = 1;
let filteredRows = [];
let _lastDonsRows = [];
let qd_selectedId = null;
let editingDonorFinal = false;

const DEFAULT_USERS = [
  { username:'admin', displayName:'מנהל ראשי', password:'admin123', role:'admin' },
  { username:'editor', displayName:'עורך', password:'edit123', role:'editor' },
  { username:'viewer', displayName:'מבקר', password:'view123', role:'viewer' },
];

async function loadDB() {
  // Try Supabase first (authoritative cloud data)
  let loadedFromCloud = false;
  try {
    const { data, error } = await _sb
      .from('app_state')
      .select('data')
      .eq('id', 'main')
      .single();

    if (data && data.data && !error) {
      DB = data.data;
      // Update local cache
      try { localStorage.setItem('donorDB_v6', JSON.stringify(DB)); } catch(e){}
      loadedFromCloud = true;
      _showSyncStatus('ok');
    }
  } catch(e) {
    console.warn('Supabase load failed, using local cache:', e.message);
    _showSyncStatus('offline');
  }

  // Fallback: localStorage
  if (!loadedFromCloud) {
    const s = localStorage.getItem('donorDB_v6');
    if (s) { try { DB = JSON.parse(s); } catch(e){} }
    // Migration from v5
    if (!DB.donors || !DB.donors.length) {
      const old = localStorage.getItem('donorDB_v5');
      if (old) { try { const o = JSON.parse(old); DB = {...DB, ...o}; } catch(e){} }
    }
  }
  // Ensure emailSettings defaults are always present
  if (!DB.emailSettings || !DB.emailSettings.publicKey) {
    DB.emailSettings = DB.emailSettings || {};
    if (!DB.emailSettings.publicKey) DB.emailSettings.publicKey = 'wZ0dkVoeeimiBD_gx';
    if (!DB.emailSettings.serviceId) DB.emailSettings.serviceId = 'service_wohacxp';
    if (!DB.emailSettings.tplMessage) DB.emailSettings.tplMessage = 'template_iz8no2o';
    if (!DB.emailSettings.tplReset) DB.emailSettings.tplReset = 'template_amj12tr';
    if (!DB.emailSettings.orgName) DB.emailSettings.orgName = 'עזר תורה';
  }
  // Ensure all required fields exist
  if (!DB.users   || !DB.users.length)  DB.users       = DEFAULT_USERS;
  if (!DB.donors)    DB.donors    = [];
  if (!DB.campaigns) DB.campaigns = [];
  if (!DB.fundraisers) DB.fundraisers = [];
  if (!DB.groups)    DB.groups    = [];
  if (!DB.nextCode)  DB.nextCode  = 1001;
  if (!DB.nextFRCode) DB.nextFRCode = 1;
  if (!DB.nextGrpSeq) DB.nextGrpSeq = {};
  if (!DB.settings)  DB.settings  = JSON.parse(JSON.stringify(DEFAULT_SETTINGS));
  // ── Load audit log from dedicated localStorage key (persists across upgrades) ──
  _loadAuditLog();
}

// Sync LOCAL → Cloud (first-time migration from localStorage to Supabase)
async function migrateLocalToCloud() {
  const s = localStorage.getItem('donorDB_v6');
  if (!s) return;
  try {
    const localDB = JSON.parse(s);
    if (!localDB.donors || !localDB.donors.length) return;
    const { error } = await _sb.from('app_state').upsert({
      id: 'main', data: localDB, updated_at: new Date().toISOString()
    });
    if (!error) {
      toast('✅ נתונים מקומיים הועלו לענן בהצלחה!');
      _showSyncStatus('ok');
    }
  } catch(e) { console.warn('Migration failed:', e); }
}
function saveDB() {
  // Save locally immediately (fast, offline fallback)
  try { localStorage.setItem('donorDB_v6', JSON.stringify(DB)); } catch(e){}
  // Sync to Supabase in background
  _syncToSupabase();
}

let _syncTimer = null;
function _syncToSupabase() {
  // Debounce: wait 800ms after last change before sending to server
  clearTimeout(_syncTimer);
  _syncTimer = setTimeout(async () => {
    try {
      // Serialize through JSON to strip non-cloneable values
      const safeData = JSON.parse(JSON.stringify(DB));
      // Strip large undoData snapshots — kept only in localStorage (donorAuditLog_v1)
      if (safeData.auditLog) {
        safeData.auditLog = safeData.auditLog.map(e => ({
          ...e, undoData: e.undoData ? {_hasUndo: true} : null
        }));
      }
      const payload = { id: 'main', data: safeData, updated_at: new Date().toISOString() };
      const { error } = await _sb.from('app_state').upsert(payload);
      if (error) {
        console.warn('Supabase sync error:', error.message);
        _showSyncStatus('error');
      } else {
        _showSyncStatus('ok');
      }
    } catch(e) {
      console.warn('Supabase unreachable, using local cache:', e.message);
      _showSyncStatus('offline');
    }
  }, 800);
}

function _showSyncStatus(status) {
  let el = document.getElementById('syncStatusDot');
  if (!el) return;
  const map = {
    'ok':      { color: '#16a34a', title: 'מסונכרן עם השרת ✓' },
    'error':   { color: '#dc2626', title: 'שגיאת סנכרון — שמור מקומי' },
    'offline': { color: '#d97706', title: 'לא מחובר — שמור מקומי' },
    'loading': { color: '#6b7a9a', title: 'מסנכרן...' },
  };
  const s = map[status] || map['loading'];
  el.style.background = s.color;
  el.title = s.title;
}
function donorName(d){return dName(d);}
function genCode() { return 'T'+String(DB.nextCode++).padStart(4,'0'); }

// Global Enter key = Save in open modal (save-and-new as default for new records)
document.addEventListener('keydown', function(e) {
  if (e.key !== 'Enter') return;
  if (e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') return;
  const open = document.querySelector('.modal-overlay.open');
  if (!open) return;
  // Don't intercept if in pick-results or address suggestions
  if (e.target.closest('.pick-results') || e.target.closest('#addressSuggestions')) return;
  e.preventDefault();
  const id = open.id;
  if (id === 'donorModal') {
    // Save and new for new donors, just save for edits
    if (!currentDonorId) saveDonorAndNew(); else saveDonor();
  }
  else if (id === 'campaignModal') saveCampaign();
  else if (id === 'frModal') {
    if (!document.getElementById('fr_editId').value) saveFRandNew(); else saveFR();
  }
  else if (id === 'groupModal') saveGroup();
  else if (id === 'quickDonModal') saveQuickDonation();
});

// ════════════════════════════════════════════════════
// SESSION & INACTIVITY
// ════════════════════════════════════════════════════
let _inactivityTimer = null;
let _inactivityWarnTimer = null;
const INACTIVITY_MS = 5 * 60 * 1000; // 5 minutes
const WARN_BEFORE_MS = 30 * 1000; // warn 30s before logout

function startInactivityTimer() {
  clearInactivityTimer();
  _inactivityWarnTimer = setTimeout(() => {
    showInactivityWarning();
  }, INACTIVITY_MS - WARN_BEFORE_MS);
  _inactivityTimer = setTimeout(() => {
    hideInactivityWarning();
    toast('יצאת מהמערכת עקב חוסר פעילות');
    setTimeout(doLogout, 1500);
  }, INACTIVITY_MS);
}

function clearInactivityTimer() {
  clearTimeout(_inactivityTimer);
  clearTimeout(_inactivityWarnTimer);
  hideInactivityWarning();
}

function resetInactivityTimer() {
  if (!currentUser) return;
  clearInactivityTimer();
  startInactivityTimer();
}

function showInactivityWarning() {
  let w = document.getElementById('inactivityWarn');
  if (!w) {
    w = document.createElement('div');
    w.id = 'inactivityWarn';
    w.style.cssText = 'position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:#1a2744;color:white;padding:14px 24px;border-radius:12px;font-size:14px;z-index:9999;display:flex;align-items:center;gap:12px;box-shadow:0 4px 20px rgba(0,0,0,.3)';
    w.innerHTML = '<span>⏱️ תצא מהמערכת בעוד 30 שניות</span><button onclick="resetInactivityTimer()" style="background:var(--gold);color:var(--navy);border:none;padding:6px 14px;border-radius:8px;font-weight:700;cursor:pointer;font-family:Heebo,sans-serif">הישאר</button>';
    document.body.appendChild(w);
  }
  w.style.display = 'flex';
}

function hideInactivityWarning() {
  const w = document.getElementById('inactivityWarn');
  if (w) w.style.display = 'none';
}

// Reset timer on any user interaction
['click','keydown','mousemove','touchstart'].forEach(ev => {
  document.addEventListener(ev, () => { if(currentUser) resetInactivityTimer(); }, {passive:true});
});

// ── Auto-login from saved session ──
window.addEventListener('DOMContentLoaded', async () => {
  await loadDB();
  // Check if this is a self-service link first
  const params = new URLSearchParams(window.location.search);
  if (params.get('selfService')) {
    checkSelfServiceMode();
    return;
  }
  // Check password reset token
  if (params.get('reset')) {
    if (checkResetToken()) return;
  }
  // Init EmailJS if configured
  _initEmailJS();
  // Restore saved session
  const saved = localStorage.getItem('savedSession');
  if (saved) {
    try {
      const s = JSON.parse(saved);
      await doLogin(s);
    } catch(e) { localStorage.removeItem('savedSession'); }
  }
});

// Supabase Auth not used - local auth only

const ROLES = { superadmin:'מנהל ראשי', admin:'מנהל', editor:'עורך', viewer:'מבקר' };

function can(p) {
  if (!currentUser) return false;
  const r = currentUser.role;
  if (p === 'view') return true;
  if (p === 'edit') return ['superadmin','admin','editor'].includes(r);
  if (p === 'export' || p === 'print') return ['superadmin','admin','editor'].includes(r);
  if (p === 'import') return ['superadmin','admin'].includes(r);
  if (p === 'admin') return ['superadmin','admin'].includes(r);
  if (p === 'superadmin') return r === 'superadmin';
  return false;
}


// Editor can add/edit donors and donations but NOT access admin panel or export

// Version upgrade notification
function checkVersionUpgrade() {
  const APP_VER = 'v16';
  const stored = localStorage.getItem('lastSeenVersion');
  if(stored && stored !== APP_VER) {
    const bar = document.createElement('div');
    bar.id = 'versionBanner';
    bar.innerHTML = `<div style="position:fixed;top:0;left:0;right:0;z-index:99999;background:#1a2744;color:white;text-align:center;padding:9px 16px;font-size:13px;display:flex;align-items:center;justify-content:center;gap:14px;box-shadow:0 2px 8px rgba(0,0,0,.3)">
      🚀 <strong>גרסה חדשה ${APP_VER} זמינה!</strong> חלק מהשינויים ייכנסו לתוקף לאחר רענון.
      <button onclick="location.reload()" style="background:var(--gold,#d4a017);color:#1a2744;border:none;padding:5px 14px;border-radius:6px;font-weight:700;cursor:pointer;font-size:13px">🔄 ריענון</button>
      <button onclick="document.getElementById('versionBanner').remove()" style="background:transparent;border:1px solid rgba(255,255,255,.4);color:white;padding:5px 10px;border-radius:6px;cursor:pointer;font-size:12px">לאחר כך</button>
    </div>`;
    document.body.prepend(bar);
  }
  localStorage.setItem('lastSeenVersion', APP_VER);
}

function setupNavForRole() {
  if (!can('admin')) {
    const navAdmin = document.getElementById('navAdmin');
    const sbAdmin = document.getElementById('sb-admin');
    if (navAdmin) navAdmin.style.display='none';
    if (sbAdmin) sbAdmin.style.display='none';
  }
  if (!can('edit')) { const da = document.getElementById('dashActions'); if(da) da.style.display='none'; }
  // Editor can see frBtns (add fundraiser/group)
  if (!can('edit') && document.getElementById('frBtns')) document.getElementById('frBtns').style.display='none';
}

async function doLogin(savedUser) {
  const loginBtn = document.getElementById('loginBtn');
  const loginErr = document.getElementById('loginError');
  let email, password, remember;

  if (savedUser) {
    email = savedUser.email; password = savedUser.password; remember = true;
  } else {
    email = document.getElementById('loginEmail')?.value.trim();
    password = document.getElementById('loginPass')?.value;
    remember = document.getElementById('rememberMe')?.checked;
    if (!email || !password) { loginErr.style.display='block'; loginErr.textContent='נא למלא מייל וסיסמה'; return; }
    loginErr.style.display='none';
    if(loginBtn) { loginBtn.disabled=true; loginBtn.textContent='מתחבר...'; }
  }

  await loadDB();

  // Authenticate against local DB.users (match by email OR username for backward compat)
  const user = DB.users.find(x =>
    (x.email === email || x.username === email) && x.password === password
  );
  if (!user) {
    if (!savedUser) {
      if(loginErr) { loginErr.style.display='block'; loginErr.textContent='כתובת מייל או סיסמה שגויים'; }
      if(loginBtn) { loginBtn.disabled=false; loginBtn.textContent='כניסה'; }
    }
    localStorage.removeItem('savedSession');
    return;
  }

  if (remember) localStorage.setItem('savedSession', JSON.stringify({email, password}));
  else localStorage.removeItem('savedSession');

  if(loginBtn) { loginBtn.disabled=false; loginBtn.textContent='כניסה'; }
  _setupSession(user);
}

async function _onAuthSuccess(sbUser) {
  // Get role from local DB users by email
  const localUser = DB.users.find(u => u.email === sbUser.email) || {};
  const user = {
    id: sbUser.id || ('U' + Date.now()),
    email: sbUser.email,
    username: localUser.username || sbUser.email,
    displayName: localUser.displayName || localUser.username || sbUser.email.split('@')[0],
    role: localUser.role || 'viewer',
    firstLogin: localUser.firstLogin ?? false,
  };
  _setupSession(user);
  if (user.firstLogin) {
    openChangePasswordModal('כניסה ראשונה — נא הגדר סיסמה אישית');
  }
}

function _setupSession(user) {
  _initEmailJS();
  currentUser = user;
  auditLog('login', 'כניסה למערכת');
  document.getElementById('loginScreen').style.display = 'none';
  const aw = document.getElementById('appWrapper');
  if(aw) aw.style.display = 'flex';
  document.getElementById('topUserName').textContent = user.displayName || user.username;
  document.getElementById('topUserRole').textContent = ROLES[user.role] || user.role;
  const dot = document.getElementById('syncStatusDot');
  if(dot) dot.style.display = 'inline-block';
  setupNavForRole();
  loadDemoIfEmpty();
  initSidebar();
  showPage('dash');
  startInactivityTimer();
  // Show Nedarim Plus buttons if configured
  const nd = getNedarimSettings();
  ['dashCreditBtn','donsPanelCreditBtn'].forEach(id => {
    const el = document.getElementById(id);
    if(el) el.style.display = nd.mosad ? '' : 'none';
  });
  updateUnreadBadge();
  updatePendingEditsCount();
  setTimeout(checkVersionUpgrade, 800);
}

async function doLogout() {
  auditLog('logout', 'יציאה מהמערכת');
  currentUser = null;
  clearInactivityTimer();
  localStorage.removeItem('savedSession');
  document.getElementById('loginScreen').style.display='flex';
  document.getElementById('appWrapper').style.display='none';
  _showSyncStatus('loading');
  const ef = document.getElementById('loginEmail');
  if(ef) ef.value='';
  const pf = document.getElementById('loginPass');
  if(pf) pf.value='';
  const le = document.getElementById('loginError');
  if(le) le.style.display='none';
}

// ── Forgot Password ──
function showForgotPassword() {
  document.getElementById('loginFormBox').style.display='none';
  document.getElementById('forgotPassBox').style.display='';
}
function showLoginForm() {
  document.getElementById('forgotPassBox').style.display='none';
  document.getElementById('loginFormBox').style.display='';
}
// sendForgotPassword — defined below with EmailJS

// ── Change Password Modal ──
function openChangePasswordModal(info) {
  document.getElementById('changePassInfo').textContent = info || 'שינוי סיסמה';
  document.getElementById('newPass1').value='';
  document.getElementById('newPass2').value='';
  document.getElementById('changePassErr').style.display='none';
  openModal('changePassModal');
}
async function saveNewPassword() {
  const p1 = document.getElementById('newPass1').value;
  const p2 = document.getElementById('newPass2').value;
  const err = document.getElementById('changePassErr');
  if (p1.length < 8) { err.style.display='block'; err.textContent='הסיסמה חייבת להכיל לפחות 8 תווים'; return; }
  if (p1 !== p2) { err.style.display='block'; err.textContent='הסיסמאות אינן תואמות'; return; }
  // Update local DB user
  if (currentUser) {
    const u = DB.users.find(x => x.email === currentUser.email || x.username === currentUser.username);
    if (u) { u.password = p1; u.firstLogin = false; }
    if (currentUser) currentUser.firstLogin = false;
    saveDB();
  }
  closeModal('changePassModal');
  toast('✓ הסיסמה עודכנה בהצלחה');
  auditLog('edit', 'שינוי סיסמה');
}

// ════════════════════════════════════════════════════
// USERS MANAGEMENT (enhanced with email + Supabase)
// ════════════════════════════════════════════════════


// ════════════════════════════════════════════════════
// DATES
// ════════════════════════════════════════════════════
function toHeb(d) {
  if (!d) return '';
  try {
    const dt = new Date(d+'T12:00:00');
    if (isNaN(dt)) return '';
    const parts = new Intl.DateTimeFormat('he-IL-u-ca-hebrew',{
      day:'numeric', month:'long', year:'numeric'
    }).formatToParts(dt);
    let day='', month='', year='';
    parts.forEach(p => {
      if(p.type==='day') day=p.value;
      if(p.type==='month') month=p.value;
      if(p.type==='year') year=p.value;
    });
    // Convert day number to Hebrew letters (יד, כ, ל...)
    const hebDay = numToHebLet(parseInt(day));
    // Year: Intl may return numeric (5785) or already Hebrew - ensure Hebrew
    const hebYear = /^[0-9]+$/.test(year.trim()) ? gregToHebYear(parseInt(year)) : year;
    return hebDay + ' ' + month + ' ' + hebYear;
  } catch(e){ return ''; }
}
function numToHebLet(n) {
  // Converts numbers 1-30 to Hebrew day letters
  if (!n || n<=0) return '';
  const tbl=['','א','ב','ג','ד','ה','ו','ז','ח','ט','י','יא','יב','יג','יד','טו','טז','יז','יח','יט','כ',
             'כא','כב','כג','כד','כה','כו','כז','כח','כט','ל'];
  return (n>=1&&n<=30) ? tbl[n] : String(n);
}
function gregToHebYear(hebNumericYear) {
  // Convert Hebrew numeric year (e.g. 5785) to Hebrew letter notation (תשפ"ה)
  const y = hebNumericYear % 1000; // take last 3 digits (e.g. 785)
  const hundreds = Math.floor(y/100); // 7
  const tens_ones = y % 100;           // 85
  const H = ['','ק','ר','ש','ת'];    // 100-400
  const hundreds5 = ['','תק','תר','תש','תת','תתק']; // 500-900
  let prefix = '';
  if (hundreds <= 4) prefix = H[hundreds];
  else prefix = hundreds5[Math.round(hundreds/1)] || H[4]; // fallback
  // Actually handle 100-999 properly:
  const H2 = {1:'ק',2:'ר',3:'ש',4:'ת',5:'תק',6:'תר',7:'תש',8:'תת',9:'תתק'};
  prefix = H2[hundreds] || '';
  const T = {
    1:'א',2:'ב',3:'ג',4:'ד',5:'ה',6:'ו',7:'ז',8:'ח',9:'ט',
    10:'י',11:'יא',12:'יב',13:'יג',14:'יד',15:'טו',16:'טז',
    17:'יז',18:'יח',19:'יט',20:'כ',21:'כא',22:'כב',23:'כג',
    24:'כד',25:'כה',26:'כו',27:'כז',28:'כח',29:'כט',30:'ל',
    31:'לא',32:'לב',33:'לג',34:'לד',35:'לה',36:'לו',37:'לז',
    38:'לח',39:'לט',40:'מ',41:'מא',42:'מב',43:'מג',44:'מד',
    45:'מה',46:'מו',47:'מז',48:'מח',49:'מט',50:'נ',51:'נא',
    52:'נב',53:'נג',54:'נד',55:'נה',56:'נו',57:'נז',58:'נח',
    59:'נט',60:'ס',61:'סא',62:'סב',63:'סג',64:'סד',65:'סה',
    66:'סו',67:'סז',68:'סח',69:'סט',70:'ע',71:'עא',72:'עב',
    73:'עג',74:'עד',75:'עה',76:'עו',77:'עז',78:'עח',79:'עט',
    80:'פ',81:'פא',82:'פב',83:'פג',84:'פד',85:'פה',86:'פו',
    87:'פז',88:'פח',89:'פט',90:'צ',91:'צא',92:'צב',93:'צג',
    94:'צד',95:'צה',96:'צו',97:'צז',98:'צח',99:'צט'
  };
  const suffix = tens_ones > 0 ? (T[tens_ones]||String(tens_ones)) : '';
  let result = 'ה\''+prefix+suffix;
  // Add geresh: insert " before last letter
  if (result.length > 2) {
    result = result.slice(0,-1) + '"' + result.slice(-1);
  }
  return result;
}
function toHebYear(gregYear) {
  // Convert Gregorian year to approximate Hebrew year text
  if (!gregYear) return '';
  const n = parseInt(gregYear);
  if (isNaN(n)) return gregYear; // already Hebrew text
  // Hebrew year offset: add 3760 for years before Tishrei, 3761 after
  const hy = n + 3760;
  return hebYearStr(hy);
}
const HEB_ONES=['','א','ב','ג','ד','ה','ו','ז','ח','ט'];
const HEB_TENS=['','י','כ','ל','מ','נ','ס','ע','פ','צ'];
const HEB_HUNDREDS=['','ק','ר','ש','ת','תק','תר','תש','תת','תתק'];
function hebYearStr(n) {
  if (!n) return '';
  n = n % 1000; // last 3 digits in current millennium
  let s='';
  const h=Math.floor(n/100); n%=100;
  const t=Math.floor(n/10); n%=10;
  s+=HEB_HUNDREDS[h]||'';
  // skip 15=טו, 16=טז
  if(t===1&&n===5){s+='טו';}
  else if(t===1&&n===6){s+='טז';}
  else{s+=(HEB_TENS[t]||'')+(HEB_ONES[n]||'');}
  return 'תש'+s.slice(2)||s; // just return as is
}
function toHebYearLabel(val) {
  if (!val) return '';
  // If it looks like a 4-digit Gregorian year, convert
  if (/^\d{4}$/.test(val.toString().trim())) {
    const hy = parseInt(val) + 3760;
    return 'תש' + numberToHebLetters(hy % 1000);
  }
  return val; // already Hebrew
}
function numberToHebLetters(n) {
  if (n<=0) return '';
  const hundreds=['','ק','ר','ש','ת'];
  const rest=n%100;
  const h=Math.floor(n/100);
  let s=(h>0&&h<=4)?hundreds[h]:'';
  if(rest===15) s+='טו';
  else if(rest===16) s+='טז';
  else {
    const t=Math.floor(rest/10), o=rest%10;
    const tens=['','י','כ','ל','מ','נ','ס','ע','פ','צ'];
    const ones=['','א','ב','ג','ד','ה','ו','ז','ח','ט'];
    s+=(tens[t]||'')+(ones[o]||'');
  }
  return s;
}
function fmt(d) { if(!d) return ''; const p=d.split('-'); return p[2]+'/'+p[1]+'/'+p[0]; }
function dateCell(d) { if(!d) return ''; return `<div class="date-cell"><span>${fmt(d)}</span><span class="date-heb">${toHeb(d)}</span></div>`; }
function today() { return new Date().toISOString().split('T')[0]; }

// ════════════════════════════════════════════════════
// HELPERS
// ════════════════════════════════════════════════════
function getTotal(d) { return (d.donations||[]).reduce((s,x)=>s+parseFloat(x.amount||0),0); }
function getMax(d) { const a=(d.donations||[]).map(x=>parseFloat(x.amount||0)); return a.length?Math.max(...a):0; }
function dName(d) { return `${d.title?d.title+' ':''}${d.firstName||''} ${d.lastName||''}`.trim(); }
function activeCampaign() { return DB.campaigns.find(c=>c.active===true||c.active==='true'); }
function campName(id) { if(!id) return ''; const c=DB.campaigns.find(x=>x.id===id); return c?c.name:''; }
function methodBadge(m) {
  const map={'מזומן':'cash','אשראי':'credit',"צ'ק":'check','העברה בנקאית':'bank','אחר':'other'};
  return `<span class="badge b-${map[m]||'other'}">${m||''}</span>`;
}

// ════════════════════════════════════════════════════
// PAGES
// ════════════════════════════════════════════════════
function showPage(name) {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
  const pg = document.getElementById('page'+name.charAt(0).toUpperCase()+name.slice(1));
  if(pg) pg.classList.add('active');
  const nb = document.getElementById('nav'+name.charAt(0).toUpperCase()+name.slice(1));
  if(nb) nb.classList.add('active');
  if(name==='dash') renderDash();
  if(name==='donors') renderAll();
  if(name==='campaign') renderCampaignPage();
  if(name==='future') { setTimeout(renderFuturePage,50); }
  if(name==='fundraisers') { renderFRPage(); }
  if(name==='donations') { renderDonationsPanel(); }
  if(name==='campaign') { setTimeout(startCampaignCountdown, 200); }
  if(name==='messages') _initMessagesPage();
  if(name==='admin') { setTimeout(checkCloudStatus, 300); updatePendingEditsCount(); }
  setSidebarActive(name);
}

// ════════════════════════════════════════════════════
// DASHBOARD
// ════════════════════════════════════════════════════
function renderDash() {
  const now = new Date();
  document.getElementById('dashGreet').textContent = `שלום, ${currentUser.displayName}!`;
  document.getElementById('dashDate').textContent = now.toLocaleDateString('he-IL',{weekday:'long',year:'numeric',month:'long',day:'numeric'}) + ' | ' + toHeb(today());
  renderGlobalStats();

  // Active campaign mini
  const ac = activeCampaign();
  const box = document.getElementById('dashCampaignBox');
  if (ac) {
    const raised = DB.donors.reduce((s,d)=>{
      return s+(d.donations||[]).filter(dn=>dn.campaignId===ac.id).reduce((ss,dn)=>ss+parseFloat(dn.amount||0),0);
    },0);
    const goal = parseFloat(ac.goal)||0;
    const pct = goal>0?Math.min((raised/goal)*100,100):0;
    const over = raised>=goal&&goal>0;
    box.innerHTML = `<div class="card" style="margin-bottom:20px">
      <div class="card-header"><h3>🎯 מגבית פעילה: ${ac.name}</h3><button class="btn btn-outline btn-sm" onclick="showPage('campaign')">לפאנל המגבית</button></div>
      <div class="card-body">${typeof countdownHtml !== 'undefined' ? countdownHtml : ''}
        <div class="stat-grid" style="grid-template-columns:repeat(4,1fr);margin-bottom:12px">
          <div class="stat-card ${over?'green':'red'}" style="padding:12px 16px">
            <div class="sv ${over?'green':'red'}" style="font-size:22px">${goal>0?'₪'+goal.toLocaleString():'-'}</div><div class="sl">יעד</div>
          </div>
          <div class="stat-card gold" style="padding:12px 16px">
            <div class="sv gold" style="font-size:22px">₪${raised.toLocaleString()}</div><div class="sl">נתרם עד כה</div>
          </div>
          <div class="stat-card" style="padding:12px 16px">
            <div class="sv" style="font-size:22px;color:${over?'var(--success)':'var(--danger)'}">₪${Math.abs(goal-raised).toLocaleString()}</div><div class="sl">${over?'עברנו את היעד ב':'נותר לאיסוף'}</div>
          </div>
          <div class="stat-card" style="padding:12px 16px">
            <div class="sv" style="font-size:22px">${Math.round(pct)}%</div><div class="sl">מאחוז היעד</div>
          </div>
        </div>
        <div class="progress-bar"><div class="progress-fill ${over?'over':''}" style="width:${pct}%"></div></div>
      </div>
    </div>`;
  } else { box.innerHTML = ''; }

  // Recent donations
  const allDons = [];
  DB.donors.forEach(d=>(d.donations||[]).forEach(dn=>allDons.push({...dn,donor:d})));
  allDons.sort((a,b)=>(b.date||'').localeCompare(a.date||''));
  const recent = allDons.slice(0,8);
  document.getElementById('recentDonations').innerHTML = recent.length===0
    ? '<tr><td colspan="6" style="text-align:center;padding:24px;color:var(--muted)">אין תרומות רשומות</td></tr>'
    : recent.map(dn=>`<tr>
        <td><strong>${donorName(dn.donor)}</strong></td>
        <td style="font-size:12px;color:var(--muted)">${campName(dn.campaignId)||'-'}</td>
        <td style="font-size:12px;color:var(--muted)">${frNameById(dn.fundraiserId)||dn.groupId?grpNameById(dn.groupId||''):''||'-'}</td>
        <td><strong>₪${parseFloat(dn.amount||0).toLocaleString()}</strong></td>
        <td>${dateCell(dn.date)}</td>
        <td>${methodBadge(dn.method)}</td>
      </tr>`).join('');
  startCampaignCountdown();
}

// ── Live campaign countdown (ticks every second) ──
let _cdTimer = null;
function startCampaignCountdown() {
  if(_cdTimer) clearInterval(_cdTimer);
  const ac = activeCampaign();
  const el = document.getElementById('campCountdown');
  if(!el || !ac || !ac.deadline) return;
  
  function tick() {
    const deadline = new Date(ac.deadline + 'T' + (ac.deadlineTime||'23:59') + ':00');
    const now = new Date();
    const diff = deadline - now;
    if(diff <= 0) {
      el.innerHTML = '<div style="font-weight:700;color:var(--danger)">⏰ המגבית הסתיימה!</div>';
      clearInterval(_cdTimer); return;
    }
    const days  = Math.floor(diff / 86400000);
    const hrs   = Math.floor((diff % 86400000) / 3600000);
    const mins  = Math.floor((diff % 3600000) / 60000);
    const secs  = Math.floor((diff % 60000) / 1000);
    const urg   = days < 2 ? 'var(--danger)' : days < 7 ? 'var(--gold)' : 'var(--teal,#0891b2)';
    el.innerHTML = `<span style="font-size:22px">⏳</span>
      <div>
        <div style="font-weight:700;color:var(--navy);font-size:12px">נותרו לסיום המגבית</div>
        <div style="display:flex;gap:10px;align-items:baseline">
          <span style="font-size:24px;font-weight:900;color:${urg}">${days}</span><span style="font-size:11px;color:var(--muted)">ימים</span>
          <span style="font-size:20px;font-weight:300;color:var(--muted)">:</span>
          <span style="font-size:24px;font-weight:900;color:${urg}">${String(hrs).padStart(2,'0')}</span><span style="font-size:11px;color:var(--muted)">שעות</span>
          <span style="font-size:20px;font-weight:300;color:var(--muted)">:</span>
          <span style="font-size:24px;font-weight:900;color:${urg}">${String(mins).padStart(2,'0')}</span><span style="font-size:11px;color:var(--muted)">דקות</span>
          <span style="font-size:20px;font-weight:300;color:var(--muted)">:</span>
          <span style="font-size:20px;font-weight:700;color:${urg}">${String(secs).padStart(2,'0')}</span><span style="font-size:10px;color:var(--muted)">שניות</span>
        </div>
      </div>`;
  }
  tick();
  _cdTimer = setInterval(tick, 1000);
}

function renderGlobalStats() {
  const allTotal = DB.donors.reduce((s,d)=>s+getTotal(d),0);
  const allDonCount = DB.donors.reduce((s,d)=>s+(d.donations||[]).length,0);
  const futureCount = DB.donors.reduce((s,d)=>s+(d.futureDonations||[]).length,0);
  document.getElementById('ds-count').textContent = DB.donors.length;
  document.getElementById('ds-total').textContent = '₪'+allTotal.toLocaleString();
  document.getElementById('ds-donations').textContent = allDonCount;
  document.getElementById('ds-future').textContent = futureCount;
}

// ════════════════════════════════════════════════════
// DONORS TABLE
// ════════════════════════════════════════════════════
function renderAll() { renderGlobalStats(); rebuildDonorFilters(); rebuildDonsFilters(); applyFilters(); setTimeout(loadColVis,50); }

// applyFilters — new version injected in ITEM 9 section below
// sortCol/sortDir declared above

function sortAndRender() {
  filteredRows.sort((a, b) => {
    let av, bv;
    switch(sortCol) {
      case 'code':      av=a.code||''; bv=b.code||''; break;
      case 'name':      av=donorName(a); bv=donorName(b); break;
      case 'affil':     av=a.affil||''; bv=b.affil||''; break;
      case 'prefTime':  av=a.prefTime||''; bv=b.prefTime||''; break;
      case 'total':     av=getTotal(a); bv=getTotal(b); break;
      case 'maxDon':    av=getMax(a); bv=getMax(b); break;
      case 'lastDon':   av=(a.donations||[]).map(dn=>dn.date||'').sort().pop()||''; bv=(b.donations||[]).map(dn=>dn.date||'').sort().pop()||''; break;
      case 'createdAt': av=a.createdAt||''; bv=b.createdAt||''; break;
      case 'updatedAt': av=a.updatedAt||''; bv=b.updatedAt||''; break;
      default:          av=donorName(a); bv=donorName(b);
    }
    if (typeof av === 'number' && typeof bv === 'number') return sortDir * (av - bv);
    return sortDir * String(av).localeCompare(String(bv), 'he');
  });
  const body = document.getElementById('donorsBody'); if (!body) return;
  const ce = can('edit');
  body.innerHTML = filteredRows.map(d => {
    const total = getTotal(d), maxD = getMax(d);
    const lastDon = (d.donations||[]).map(dn=>dn.date||'').filter(Boolean).sort().pop()||'';
    const waBtn = d.mobile ? `<button class="btn-icon wa" style="width:26px;height:26px;font-size:12px" data-mobile="${d.mobile}" onclick="openWAfor(this.dataset.mobile);event.stopPropagation()" title="WhatsApp">💬</button>` : '';
    const emBtn = d.email  ? `<button class="btn-icon em" style="width:26px;height:26px;font-size:12px" onclick="openSendEmailModal('${d.id}');event.stopPropagation()" title="שלח מייל">✉️</button>` : '';
    const cbHtml = can('admin') ? `<td style="width:36px;padding:4px;text-align:center" onclick="event.stopPropagation()"><input type="checkbox" class="donor-row-cb" data-id="${d.id}" onchange="updateBulkBar()" style="cursor:pointer;transform:scale(1.1)"></td>` : '<td></td>';
    return `<tr onclick="openDonorModal('${d.id}')">
      ${cbHtml}
      <td data-col="code"><strong>${d.code||''}</strong></td>
      <td data-col="name">${donorName(d)}</td>
      <td data-col="address" style="max-width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${d.address||''}${d.entrance?' '+d.entrance:''}</td>
      <td data-col="phones"><div style="display:flex;gap:4px;align-items:center;flex-wrap:wrap">${d.phone?`<span style="font-size:11px">${d.phone}</span>`:''} ${d.mobile?`<span style="font-size:11px">${d.mobile}</span>`:''} ${waBtn}</div></td>
      <td data-col="email"><div style="display:flex;gap:4px;align-items:center">${d.email?`<span style="font-size:11px;max-width:130px;overflow:hidden;text-overflow:ellipsis;display:block">${d.email}</span>`:''} ${emBtn}</div></td>
      <td data-col="affil"><span class="badge" style="background:var(--cream-d);color:var(--muted)">${d.affil||''}</span></td>
      <td data-col="prefTime">${d.prefTime||''}</td>
      <td data-col="total"><strong style="color:var(--success)">₪${total.toLocaleString()}</strong></td>
      <td data-col="lastDon">${lastDon ? dateCell(lastDon) : ''}</td>
      <td data-col="maxDon">₪${maxD.toLocaleString()}</td>
      <td data-col="createdAt">${dateCell(d.createdAt?.split('T')[0]||'')}</td>
      <td data-col="updatedAt">${d.updatedAt ? dateCell(d.updatedAt.split('T')[0]) : '—'}</td>
      <td data-col="idNumber">${d.idNumber||''}</td>
      <td onclick="event.stopPropagation()"><div class="row-actions">
        ${ce ? `<button class="btn btn-outline btn-sm" onclick="openDonorModal('${d.id}')">✏️</button>` : ''}
        ${ce ? `<button class="btn btn-danger btn-sm" onclick="deleteDonorRow('${d.id}')">🗑️</button>` : ''}
      </div></td>
    </tr>`;
  }).join('') || `<tr><td colspan="14" style="text-align:center;padding:32px;color:var(--muted)">אין תורמים להצגה</td></tr>`;
  applyColVis();
}



function sortTable(col) {
  if(sortCol===col) sortDir*=-1; else{sortCol=col;sortDir=1;}
  document.querySelectorAll('th[data-col]').forEach(th=>{
    if(th.querySelector('.si')) {
      th.classList.toggle('sorted',th.dataset.col===col);
      th.querySelector('.si').textContent=th.dataset.col===col?(sortDir===1?'↑':'↓'):'⇅';
    }
  });
  sortAndRender();
}
// clearFilters replaced — see new version below

// ════════════════════════════════════════════════════
// DONOR MODAL
// ════════════════════════════════════════════════════
function openNewDonorModal() {
  // Reset pending buffers
  _pendingDonations = [];
  _pendingFuture = [];
  _pendingRelations = [];
  currentDonorId = '__new__';
  if(!can('edit')) return;
  currentDonorId=null; currentDTab='details';
  document.getElementById('donorModalTitle').textContent='תורם חדש';
  document.getElementById('deleteDonorBtn').style.display='none';
  document.getElementById('saveDonorBtnTop').style.display='';
  fillForm({});
  document.getElementById('f_code').value=genCode(); saveDB();
  document.getElementById('f_createdAt').value=today();
  switchDTab('details');
  openModal('donorModal'); setTimeout(initSelectsAddable, 100);
}

function openDonorModal(id) {
  const d=DB.donors.find(x=>x.id===id); if(!d) return;
  currentDonorId=id; currentDTab='details';
  document.getElementById('donorModalTitle').textContent=donorName(d);
  document.getElementById('deleteDonorBtn').style.display=can('edit')?'':'none';
  document.getElementById('saveDonorBtnTop').style.display=can('edit')?'':'none';
  // Show credit/self-service buttons for existing donors
  document.getElementById('donorCreditBtn').style.display = '';
  document.getElementById('donorSelfLinkBtn').style.display = '';
  document.getElementById('donorEmailBtn').style.display = getEmailSettings().publicKey ? '' : 'none';
  fillForm(d);
  switchDTab('details');
  updateDetailsTabSummary();
  openModal('donorModal');
}

function fillForm(d) {
  ['code','title','firstName','lastName','closingName','affil','address','entrance','phone','mobile','email','idNumber','prefTime','marriageYear','cohort','notes'].forEach(k=>{
    const e=document.getElementById('f_'+k); if(e) e.value=d[k]||'';
  });
  document.getElementById('f_createdAt').value=d.createdAt?d.createdAt.split('T')[0]:today();
  const updEl=document.getElementById('f_updatedAt');
  if(updEl) {
    if(d.updatedAt) {
      const ud=new Date(d.updatedAt);
      const src=d.updatedBy==='self'?' (עדכון עצמי)':d.updatedBy?' ('+d.updatedBy+')':'';
      updEl.value=ud.toLocaleString('he-IL',{day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit'})+src;
    } else { updEl.value=''; }
  }
  window._lastGeoLat = d.lat || null;
  window._lastGeoLng = d.lng || null;
  // Show map if coordinates exist
  const mapDiv = document.getElementById('addressMapPreview');
  if(mapDiv) {
    if(d.lat && d.lng) {
      mapDiv.innerHTML = `<iframe width="100%" height="120" frameborder="0" scrolling="no" src="https://www.openstreetmap.org/export/embed.html?bbox=${d.lng-.0018},${d.lat-.0018},${d.lng+.0018},${d.lat+.0018}&layer=mapnik&marker=${d.lat},${d.lng}" style="border-radius:8px"></iframe>`;
      mapDiv.style.display='';
    } else {
      mapDiv.style.display='none';
    }
  }
  const sugg = document.getElementById('addressSuggestions');
  if(sugg) sugg.style.display='none';
}

function switchDTab(tab) {
  currentDTab=tab;
  ['details','donations','future','relations'].forEach(t=>{
    const el=document.getElementById('dc-'+t);
    if(el) el.style.display=t===tab?'':'none';
    document.getElementById('dt-'+t)?.classList.toggle('active',t===tab);
  });
  if(tab !== 'donations') {
    const fb=document.getElementById('donationFormBox');
    if(fb) fb.style.display='none';
  }
  if(tab==='details') updateDetailsTabSummary();
  if(tab==='donations') renderDonationsTab();
  if(tab==='future') renderFutureTab();
  if(tab==='relations'&&currentDonorId) renderRelTab();
}

function saveDonor() {
  if(!can('edit')) return;
  const fn=document.getElementById('f_firstName').value.trim();
  const ln=document.getElementById('f_lastName').value.trim();
  if(!fn&&!ln){alert('חובה להזין שם');return;}
  const data={};
  ['code','title','firstName','lastName','closingName','affil','address','entrance','phone','mobile','email','idNumber','prefTime','marriageYear','cohort','notes'].forEach(k=>{
    const e=document.getElementById('f_'+k);if(e)data[k]=e.value.trim();
  });
  // Save geo data if available
  if(window._lastGeoLat) data.lat = window._lastGeoLat;
  if(window._lastGeoLng) data.lng = window._lastGeoLng;
  const ca=document.getElementById('f_createdAt').value;
  data.createdAt=ca?ca+'T00:00:00':new Date().toISOString();
  data.updatedAt=new Date().toISOString();
  data.updatedBy=currentUser?(currentUser.displayName||currentUser.username):'מערכת';
  if(currentDonorId){
    const idx=DB.donors.findIndex(x=>x.id===currentDonorId);
    if(idx>=0) DB.donors[idx]={...DB.donors[idx],...data};
  } else {
    const nd={id:'D'+Date.now(),...data,donations:[],futureDonations:[],relations:[]};
    DB.donors.push(nd); currentDonorId=nd.id;
    document.getElementById('donorModalTitle').textContent=donorName(nd);
    document.getElementById('deleteDonorBtn').style.display='';
  }
  flushPendingToNewDonor(currentDonorId); saveDB(); renderAll(); renderGlobalStats();
  auditLog('edit', `שמירת תורם: ${fn} ${ln}`);
  toast('✓ תורם נשמר');
  setTimeout(() => closeModal('donorModal'), 300);
}

function saveDonorAndNew() {
  if(!can('edit')) return;
  const fn=document.getElementById('f_firstName').value.trim();
  const ln=document.getElementById('f_lastName').value.trim();
  if(!fn&&!ln){alert('חובה להזין שם');return;}
  const data={};
  ['code','title','firstName','lastName','closingName','affil','address','entrance','phone','mobile','email','idNumber','prefTime','marriageYear','cohort','notes'].forEach(k=>{
    const e=document.getElementById('f_'+k);if(e)data[k]=e.value.trim();
  });
  if(window._lastGeoLat) data.lat = window._lastGeoLat;
  if(window._lastGeoLng) data.lng = window._lastGeoLng;
  const ca=document.getElementById('f_createdAt').value;
  data.createdAt=ca?ca+'T00:00:00':new Date().toISOString();
  if(currentDonorId){
    const idx=DB.donors.findIndex(x=>x.id===currentDonorId);
    if(idx>=0) DB.donors[idx]={...DB.donors[idx],...data};
  } else {
    const nd={id:'D'+Date.now(),...data,donations:[],futureDonations:[],relations:[]};
    DB.donors.push(nd);
  }
  saveDB(); renderAll(); renderGlobalStats();
  auditLog(currentDonorId ? 'edit' : 'create', `${currentDonorId?'עדכון':'הוספת'} תורם: ${fn} ${ln}`);
  // Reset for new donor
  currentDonorId = null;
  document.getElementById('donorModalTitle').textContent='תורם חדש';
  document.getElementById('deleteDonorBtn').style.display='none';
  fillForm({});
  document.getElementById('f_code').value=genCode(); saveDB();
  document.getElementById('f_createdAt').value=today();
  window._lastGeoLat=null; window._lastGeoLng=null;
  document.getElementById('addressMapPreview').style.display='none';
  switchDTab('details');
  setTimeout(()=>document.getElementById('f_firstName').focus(), 50);
}

// ════════════════════════════════════════════════════
// ADDRESS AUTOCOMPLETE (Google Maps / Nominatim fallback)
// ════════════════════════════════════════════════════
let _addrTimer = null;
function addressAutocomplete(val) {
  clearTimeout(_addrTimer);
  const box = document.getElementById('addressSuggestions');
  if (!val || val.length < 3) { box.style.display='none'; return; }
  _addrTimer = setTimeout(async ()=>{
    try {
      const resp = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(val)}&countrycodes=il&limit=6&addressdetails=1`,{headers:{'Accept-Language':'he'}});
      const data = await resp.json();
      if (!data.length) { box.innerHTML='<div style="padding:8px 12px;font-size:12px;color:var(--muted)">לא נמצאו כתובות</div>'; box.style.display=''; return; }
      box.innerHTML = data.map(r=>`<div class="pick-item" style="font-size:12px" onclick="selectAddress('${encodeURIComponent(r.display_name)}','${r.lat}','${r.lon}')">${r.display_name}</div>`).join('');
      box.style.display='';
    } catch(e){}
  }, 400);
}
function selectAddress(encName, lat, lng) {
  const name = decodeURIComponent(encName);
  document.getElementById('f_address').value = name;
  document.getElementById('addressSuggestions').style.display='none';
  window._lastGeoLat = parseFloat(lat);
  window._lastGeoLng = parseFloat(lng);
  // Show map preview using OpenStreetMap embed
  const mapDiv = document.getElementById('addressMapPreview');
  mapDiv.innerHTML = `<iframe width="100%" height="120" frameborder="0" scrolling="no" src="https://www.openstreetmap.org/export/embed.html?bbox=${parseFloat(lng)-.0018},${parseFloat(lat)-.0018},${parseFloat(lng)+.0018},${parseFloat(lat)+.0018}&layer=mapnik&marker=${lat},${lng}" style="border-radius:8px"></iframe>`;
  mapDiv.style.display='';
}
// Close suggestions when clicking outside
document.addEventListener('click', function(e){
  const box = document.getElementById('addressSuggestions');
  if(box && !box.contains(e.target) && e.target.id!=='f_address') box.style.display='none';
});

function deleteCurrentDonor() {
  if(!can('edit')||!confirm('למחוק תורם זה לצמיתות?'))return;
  const d = DB.donors.find(x=>x.id===currentDonorId);
  const snapshot = JSON.parse(JSON.stringify(DB.donors));
  DB.donors=DB.donors.filter(x=>x.id!==currentDonorId);
  auditLog('delete', `מחיקת תורם: ${d ? donorName(d) : currentDonorId}`, {type:'donors',action:'delete',snapshot});
  saveDB(); renderAll(); closeModal('donorModal');
}
function deleteDonorRow(id) {
  if(!can('edit')||!confirm('למחוק תורם זה?'))return;
  DB.donors=DB.donors.filter(x=>x.id!==id);
  saveDB(); renderAll();
}

// ════════════════════════════════════════════════════
// DONATIONS TAB
// ════════════════════════════════════════════════════
function renderDonationsTab() {
  if(isNewDonor()) { renderPendingDonations(); return; }
  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d) return;
  const total=getTotal(d), maxD=getMax(d), cnt=(d.donations||[]).length;
  document.getElementById('donorStatsBox').innerHTML=`
    <div class="d-stat"><div class="sv">₪${total.toLocaleString()}</div><div class="sl">סך תרומות</div></div>
    <div class="d-stat"><div class="sv" style="color:var(--gold)">₪${maxD.toLocaleString()}</div><div class="sl">תרומה גבוהה</div></div>
    <div class="d-stat"><div class="sv">${cnt}</div><div class="sl">מספר תרומות</div></div>`;
  populateCampaignSelect('nd_campaign');
  const body=document.getElementById('donationsBody');
  const ce=can('edit');
  body.innerHTML=(d.donations||[]).length===0
    ?`<tr><td colspan="7" style="text-align:center;padding:24px;color:var(--muted)">אין תרומות</td></tr>`
    :(d.donations||[]).map((dn,i)=>`<tr>
        <td>${fmt(dn.date)}</td>
        <td style="font-size:11px;color:var(--muted)">${toHeb(dn.date)}</td>
        <td><strong>₪${parseFloat(dn.amount||0).toLocaleString()}</strong></td>
        <td>${methodBadge(dn.method)}</td>
        <td style="font-size:12px;color:var(--muted)">${campName(dn.campaignId)||''}</td>
        <td style="font-size:12px;color:var(--muted)">${frNameById(dn.fundraiserId)||''}</td>
        <td>${dn.notes||''}</td>
        <td style="white-space:nowrap">${ce?`<button class="btn btn-outline btn-sm" onclick="editDonation(${i})">✏️</button> <button class="btn btn-danger btn-sm" onclick="deleteDonation(${i})">🗑️</button>`:''}</td>
      </tr>`).join('');
}

function toggleDonForm() {
  const box=document.getElementById('donationFormBox');
  const open=box.style.display!=='none'&&box.style.display!=='';
  if(open){cancelDonForm();return;}
  document.getElementById('nd_editIdx').value='';
  document.getElementById('donFormTitle').textContent='הוספת תרומה';
  document.getElementById('nd_amount').value='';
  document.getElementById('nd_date').value=today();
  document.getElementById('nd_method').value='מזומן';
  document.getElementById('nd_notes').value='';
  if(document.getElementById('nd_fr_search')){document.getElementById('nd_fr_search').value='';document.getElementById('nd_fr_id').value='';document.getElementById('nd_fr_results').innerHTML='';}
  if(document.getElementById('nd_don_type')){document.getElementById('nd_don_type').value='fr';toggleDonAssignType();}
  if(document.getElementById('nd_grp_id')){document.getElementById('nd_grp_id').value='';document.getElementById('nd_grp_search').value='';document.getElementById('nd_grp_info').textContent='';}
  const ac=activeCampaign();
  populateCampaignSelect('nd_campaign');
  if(ac) document.getElementById('nd_campaign').value=ac.id;
  box.style.display='';
}
function cancelDonForm() {
  const box = document.getElementById('donationFormBox');
  if(box) { box.style.display='none'; box.style.opacity='0'; }
  const ei = document.getElementById('nd_editIdx');
  if(ei) ei.value='';
  // Reset form fields
  ['nd_amount','nd_date','nd_notes'].forEach(id=>{const el=document.getElementById(id);if(el)el.value='';});
  // Reset attribution mode
  const frRad = document.querySelector('input[name="nd_mode"][value="fr"]');
  if(frRad) { frRad.checked=true; toggleDonMode('nd'); }
}

function editDonation(idx) {
  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d) return;
  const dn=d.donations[idx]; if(!dn) return;
  document.getElementById('nd_editIdx').value=idx;
  document.getElementById('donFormTitle').textContent='עריכת תרומה';
  document.getElementById('nd_amount').value=dn.amount||'';
  document.getElementById('nd_date').value=dn.date||'';
  document.getElementById('nd_notes').value=dn.notes||'';
  populateCampaignSelect('nd_campaign');
  document.getElementById('nd_campaign').value=dn.campaignId||'';
  document.getElementById('nd_method').value=dn.method||'מזומן';
  // Restore assignment type
  if(document.getElementById('nd_don_type')) {
    if(dn.groupId) { document.getElementById('nd_don_type').value='group'; }
    else if(dn.fundraiserId) { document.getElementById('nd_don_type').value='fr'; }
    else { document.getElementById('nd_don_type').value='none'; }
    toggleDonAssignType();
  }
  if(document.getElementById('nd_fr_search')){
    const frn=frNameById(dn.fundraiserId||'');
    document.getElementById('nd_fr_search').value=frn;
    document.getElementById('nd_fr_id').value=dn.fundraiserId||'';
    document.getElementById('nd_fr_results').innerHTML='';
  }
  if(document.getElementById('nd_grp_id') && dn.groupId) {
    document.getElementById('nd_grp_id').value=dn.groupId;
    document.getElementById('nd_grp_search').value=grpNameById(dn.groupId);
  }
  document.getElementById('donationFormBox').style.display='';
}

function saveDonation() {
  const amount=parseFloat(document.getElementById('nd_amount').value);
  if(!amount||amount<=0){alert('יש להזין סכום תקין');return;}
  const attrib = getDonAttribution('nd');
  const obj={
    amount,
    date:document.getElementById('nd_date').value,
    method:document.getElementById('nd_method').value,
    campaignId:document.getElementById('nd_campaign').value||'',
    fundraiserId:attrib.fundraiserId,
    groupId:attrib.groupId,
    notes:document.getElementById('nd_notes').value.trim()
  };

  // If donor not yet saved — buffer it
  if(isNewDonor()) {
    const editIdx = document.getElementById('nd_editIdx').value;
    if(editIdx!=='') _pendingDonations[parseInt(editIdx)]=obj;
    else _pendingDonations.push(obj);
    cancelDonForm();
    renderPendingDonations();
    toast('✓ תרומה נוספה — תישמר עם שמירת התורם');
    return;
  }

  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d) return;
  if(!d.donations) d.donations=[];
  const editIdx=document.getElementById('nd_editIdx').value;
  if(editIdx!=='') d.donations[parseInt(editIdx)]=obj;
  else d.donations.push(obj);
  cancelDonForm(); saveDB(); renderDonationsTab(); renderGlobalStats();
  const d2=DB.donors.find(x=>x.id===currentDonorId);
  auditLog('create', `תרומת ${obj.method||''} ₪${amount} נוספה${d2?' ל'+donorName(d2):''}`);
  toast('✓ תרומה נשמרה');
  // Remove future-donation if confirming
  if(window._confirmFutureDonorId && window._confirmFutureIdx !== undefined) {
    const fd=DB.donors.find(x=>x.id===window._confirmFutureDonorId);
    if(fd && fd.futureDonations) {
      fd.futureDonations.splice(window._confirmFutureIdx,1);
      saveDB();
      renderFutureTab && renderFutureTab();
    }
    window._confirmFutureDonorId=null; window._confirmFutureIdx=undefined;
    const b=document.getElementById('futurConfirmBanner'); if(b) b.remove();
  }
  if(document.getElementById('pageDash').classList.contains('active')) renderDash();
}

function deleteDonation(idx) {
  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d||!confirm('למחוק תרומה?'))return;
  const snapshot = JSON.parse(JSON.stringify(d.donations[idx]));
  const amount = d.donations[idx]?.amount || '';
  d.donations.splice(idx,1);
  auditLog('delete', `מחיקת תרומה ₪${amount} מ${donorName(d)}`, {type:'donation',action:'delete',donorId:currentDonorId,idx,snapshot});
  saveDB(); renderDonationsTab(); renderGlobalStats();
}

// ════════════════════════════════════════════════════
// FUTURE DONATIONS TAB (multiple)
// ════════════════════════════════════════════════════
function renderFutureTab() {
  if(isNewDonor()) { renderPendingFuture(); return; }
  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d) return;
  const futs=d.futureDonations||[];
  populateCampaignSelect('nf_campaign');
  document.getElementById('futureItemsList').innerHTML=futs.length===0
    ?`<p style="color:var(--muted);font-size:13px">אין תרומות עתידיות רשומות</p>`
    :futs.map((f,i)=>`<div class="future-item">
        <div class="future-item-info">
          <div class="fi-date">${f.date?fmt(f.date):'תאריך לא נקבע'}</div>
          ${f.date?`<div class="fi-heb">${toHeb(f.date)}</div>`:''}
          ${f.expectedAmount?`<div class="fi-amount">💰 סכום צפוי: <strong>₪${parseFloat(f.expectedAmount).toLocaleString()}</strong></div>`:''}
          ${campName(f.campaignId)?`<div class="fi-amount" style="font-size:12px;color:var(--muted)">🎯 ${campName(f.campaignId)}</div>`:''}
          ${f.notes?`<div class="fi-notes">📝 ${f.notes}</div>`:''}
        </div>
        ${can('edit')?`<div class="future-item-actions">
          <button class="btn btn-outline btn-sm" onclick="editFuture(${i})">✏️</button>
          <button class="btn btn-danger btn-sm" onclick="deleteFuture(${i})">🗑️</button>
        </div>`:''}
      </div>`).join('');
}

function toggleFutureForm() {
  const box=document.getElementById('futureFormBox');
  const open=box.style.display!=='none'&&box.style.display!=='';
  if(open){cancelFutureForm();return;}
  document.getElementById('nf_editIdx').value='';
  document.getElementById('futureFormTitle').textContent='הוספת תרומה עתידית';
  document.getElementById('nf_date').value='';
  document.getElementById('nf_amount').value='';
  document.getElementById('nf_notes').value='';
  const ac=activeCampaign();
  populateCampaignSelect('nf_campaign');
  if(ac) document.getElementById('nf_campaign').value=ac.id;
  box.style.display='';
}
function cancelFutureForm() { document.getElementById('futureFormBox').style.display='none'; document.getElementById('nf_editIdx').value=''; }

function editFuture(idx) {
  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d) return;
  const f=(d.futureDonations||[])[idx]; if(!f) return;
  document.getElementById('nf_editIdx').value=idx;
  document.getElementById('futureFormTitle').textContent='עריכת תרומה עתידית';
  document.getElementById('nf_date').value=f.date||'';
  document.getElementById('nf_amount').value=f.expectedAmount||'';
  document.getElementById('nf_notes').value=f.notes||'';
  populateCampaignSelect('nf_campaign');
  document.getElementById('nf_campaign').value=f.campaignId||'';
  document.getElementById('futureFormBox').style.display='';
}

function saveFutureDonation() {
  const date=document.getElementById('nf_date').value;
  const notes=document.getElementById('nf_notes').value.trim();
  if(!date&&!notes){alert('יש להזין לפחות תאריך יעד');return;}
  const obj={date,expectedAmount:document.getElementById('nf_amount').value?parseFloat(document.getElementById('nf_amount').value):null,campaignId:document.getElementById('nf_campaign').value||'',notes};
  const ei=document.getElementById('nf_editIdx').value;

  if (isNewDonor()) {
    if(ei!=='') _pendingFuture[parseInt(ei)]=obj;
    else _pendingFuture.push(obj);
    cancelFutureForm();
    renderPendingFuture();
    toast('✓ תרומה עתידית נוספה לבופר');
    return;
  }

  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d) return;
  if(!d.futureDonations) d.futureDonations=[];
  if(ei!=='') d.futureDonations[parseInt(ei)]=obj;
  else d.futureDonations.push(obj);
  cancelFutureForm(); saveDB(); renderFutureTab(); renderGlobalStats();
  toast('✓ תרומה עתידית נשמרה');
}

function deleteFuture(idx) {
  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d||!confirm('למחוק?'))return;
  d.futureDonations.splice(idx,1);
  saveDB(); renderFutureTab(); renderGlobalStats();
}

// ════════════════════════════════════════════════════
// FUTURE PAGE
// ════════════════════════════════════════════════════
function setFSort(col) {
  const sd=document.getElementById('futureSortDir');
  const ss=document.getElementById('futureSort');
  if(ss.value===col) sd.value=sd.value==='asc'?'desc':'asc';
  else ss.value=col;
  renderFuturePage();
}

function renderFuturePage() {
  const q=(document.getElementById('futureSearch')?.value||'').trim().toLowerCase();
  const sortBy=document.getElementById('futureSort')?.value||'date';
  const dir=document.getElementById('futureSortDir')?.value||'asc';

  // Flatten: one row per future donation
  let rows=[];
  DB.donors.forEach(d=>{
    (d.futureDonations||[]).forEach((f,fi)=>{
      const name=donorName(d).toLowerCase();
      if(!q||name.includes(q)||(f.notes||'').toLowerCase().includes(q)||(d.code||'').toLowerCase().includes(q)){
        rows.push({donor:d, f, fi});
      }
    });
  });

  rows.sort((a,b)=>{
    let av,bv;
    if(sortBy==='name'){av=donorName(a.donor);bv=donorName(b.donor);}
    else if(sortBy==='amount'){av=parseFloat(a.f.expectedAmount||0);bv=parseFloat(b.f.expectedAmount||0);}
    else{av=a.f.date||'';bv=b.f.date||'';}
    return av<bv?(dir==='asc'?-1:1):av>bv?(dir==='asc'?1:-1):0;
  });

  const ce=document.getElementById('futureCount'); if(ce) ce.textContent=rows.length+' תרומות עתידיות';

  const body=document.getElementById('futureBody'); if(!body) return;
  const canE=can('edit');
  body.innerHTML=rows.length===0
    ?`<tr><td colspan="9" style="text-align:center;padding:32px;color:var(--muted)">אין תרומות עתידיות</td></tr>`
    :rows.map(({donor:d,f,fi})=>{
        const waBtn=d.mobile?`<button class="btn-icon wa" style="width:26px;height:26px;font-size:12px" data-mobile="${d.mobile}" onclick="openWAfor(this.dataset.mobile);event.stopPropagation()">💬</button>`:'';
        return `<tr style="cursor:pointer" onclick="openDonorAndFuture('${d.id}',${fi})">
          <td><strong>${donorName(d)}</strong></td>
          <td style="font-size:12px;color:var(--muted)">${d.code||''}</td>
          <td><span class="badge" style="background:var(--cream-d);color:var(--muted)">${d.affil||''}</span></td>
          <td>${f.date?`<strong>${fmt(f.date)}</strong>`:'<span style="color:var(--muted)">-</span>'}</td>
          <td style="font-size:11px;color:var(--muted)">${f.date?toHeb(f.date):''}</td>
          <td>${f.expectedAmount?`<strong style="color:var(--purple)">₪${parseFloat(f.expectedAmount).toLocaleString()}</strong>`:'<span style="color:var(--muted)">לא צוין</span>'}</td>
          <td style="max-width:200px;white-space:normal">${f.notes||''}</td>
          <td><div style="display:flex;gap:4px;align-items:center">${d.mobile?`<span style="font-size:11px">${d.mobile}</span>`:''} ${waBtn}</div></td>
          <td onclick="event.stopPropagation()">
            ${canE?`<div class="row-actions"><button class="btn btn-outline btn-sm" onclick="openDonorAndFuture('${d.id}',${fi})">✏️</button><button class="btn btn-gold btn-sm" onclick="confirmFutureDonation('${d.id}',${fi})" title="אישור קבלת תרומה">✅ אישור</button><button class="btn btn-danger btn-sm" onclick="deleteFutureFromPage('${d.id}',${fi})">🗑️</button></div>`:''}
          </td>
        </tr>`;
      }).join('');
}

function openDonorAndFuture(id, fi) {
  openDonorModal(id);
  setTimeout(()=>{ switchDTab('future'); setTimeout(()=>editFuture(fi),100); },100);
}

function deleteFutureFromPage(id, fi) {
  const d=DB.donors.find(x=>x.id===id); if(!d||!confirm('למחוק תרומה עתידית?'))return;
  d.futureDonations.splice(fi,1);
  saveDB(); renderFuturePage(); renderGlobalStats();
}

// ════════════════════════════════════════════════════
// RELATIONS
// ════════════════════════════════════════════════════
function renderRelTab() {
  const d=DB.donors.find(x=>x.id===currentDonorId); if(!d) return;
  const rels=d.relations||[];
  document.getElementById('relList').innerHTML=rels.length===0
    ?'<p style="color:var(--muted);font-size:13px">אין שיוכים</p>'
    :rels.map((r,i)=>{
        let name='', code='', badge='';
        if (r.donorId && r.donorId.startsWith('fr_')) {
          const f=DB.fundraisers.find(x=>x.id===r.donorId.slice(3));
          if(!f) return '';
          name=(f.firstName||'')+' '+(f.lastName||''); code=f.code||''; badge='👤 מתרים';
        } else {
          const rel=DB.donors.find(x=>x.id===r.donorId); if(!rel) return '';
          name=donorName(rel); code=rel.code||''; badge='';
        }
        return `<div style="display:flex;align-items:center;justify-content:space-between;background:var(--cream);border-radius:8px;padding:10px 13px;margin-bottom:7px">
          <div><strong>${name}</strong> <span class="badge" style="background:var(--cream-d);color:var(--muted);margin-right:8px">${r.type}</span>${badge?`<span class="badge" style="background:var(--teal-bg);color:var(--teal);font-size:10px;margin-right:4px">${badge}</span>`:''}<span style="font-size:11px;color:var(--muted)">${code}</span></div>
          ${can('edit')?`<button class="btn btn-danger btn-sm" onclick="deleteRel(${i})">הסר</button>`:''}
        </div>`;
      }).join('');
  document.getElementById('relSearchBox').style.display='none';
}
// ════════════════════════════════════════════════════
// QUICK DONATION MODAL
// ════════════════════════════════════════════════════
function openQuickDonationModal() {
  if(!can('edit')) return;
  qd_selectedId=null;
  document.getElementById('qd_search').value='';
  document.getElementById('qd_results').innerHTML='';
  document.getElementById('qd_selected').style.display='none';
  document.getElementById('qd_amount').value='';
  document.getElementById('qd_date').value=today();
  document.getElementById('qd_method').value='מזומן';
  document.getElementById('qd_notes').value='';
  populateCampaignSelect('qd_campaign');
  const ac=activeCampaign(); if(ac) document.getElementById('qd_campaign').value=ac.id;
  openModal('quickDonModal'); setTimeout(initSelectsAddable, 100);
}


function openDonorById(id, tab) {
  const d = DB.donors.find(x=>x.id===id);
  if (!d) return;
  currentDonorId = id;
  fillForm(d);
  if (tab) {
    currentDTab = tab;
    document.querySelectorAll('.modal-tab').forEach(el=>el.classList.remove('active'));
    document.querySelectorAll('#donorTabs .modal-tab').forEach(el=>{
      if(el.dataset.tab===tab) el.classList.add('active');
    });
  }
  openModal('donorModal');
  if(tab==='donations') setTimeout(renderDonationsTab,100);
}
function searchQDDonor() {
  const q=document.getElementById('qd_search').value.trim().toLowerCase();
  const res=q.length<1?[]:DB.donors.filter(d=>donorName(d).toLowerCase().includes(q)||(d.code||'').toLowerCase().includes(q)||(d.address||'').toLowerCase().includes(q)).slice(0,8);
  const notFoundBtn = q && res.length===0 ? `<div style="padding:8px 10px;cursor:pointer;border-radius:7px;background:var(--gold-bg);border:1px solid var(--gold);font-size:12px;color:var(--navy)" onclick="addDonorFromQD('${q.replace(/'/g,'\\\'')}')">➕ לא נמצא — הוסף תורם חדש</div>` : '';
  document.getElementById('qd_results').innerHTML=res.map(d=>`<div style="padding:8px 10px;cursor:pointer;border-radius:7px;background:var(--cream);margin-bottom:4px;border:1px solid var(--border)" onclick="pickQDDonor('${d.id}')">${donorName(d)} <span style="color:var(--muted);font-size:11px">${d.code||''} ${d.address?'| '+d.address:''}</span></div>`).join('') + notFoundBtn;
}
function addDonorFromQD(prefill) {
  window._qdResumeAfterDonor = true;
  window._qdPrefill = prefill;
  // Close QD modal first
  closeModal('quickDonModal');
  // Open donor modal for new donor
  setTimeout(() => {
    openNewDonorModal();
    // Pre-fill name from search text
    setTimeout(() => {
      if (prefill && document.getElementById('f_firstName')) {
        const parts = prefill.trim().split(' ');
        document.getElementById('f_firstName').value = parts[0]||'';
        if (parts.length > 1) document.getElementById('f_lastName').value = parts.slice(1).join(' ');
      }
      // Change the save button to "save and return to donation"
      const saveNewBtn = document.getElementById('saveNewDonorBtn');
      if (saveNewBtn) {
        saveNewBtn.textContent = '💾 שמור וחזור לתרומה ↵';
        saveNewBtn.onclick = saveDonorThenQD;
      }
      const saveBtn = document.getElementById('saveDonorBtnTop');
      if (saveBtn) {
        saveBtn.textContent = '💾 שמור וחזור';
        saveBtn.onclick = saveDonorThenQD;
      }
      // Show a banner
      const banner = document.createElement('div');
      banner.id='qdResumeBanner';
      banner.style.cssText='background:var(--gold-bg,#fff9e6);border:1px solid var(--gold);color:var(--navy);font-size:12px;padding:8px 14px;border-radius:7px;margin-bottom:10px;text-align:center';
      banner.textContent='✏️ אחרי השמירה תחזור אוטומטית לטופס התרומה';
      const body = document.querySelector('#donorModal .modal-body');
      if (body && !document.getElementById('qdResumeBanner')) body.prepend(banner);
    }, 80);
  }, 50);
}
function saveDonorThenQD() {
  const fn = document.getElementById('f_firstName')?.value?.trim();
  const ln = document.getElementById('f_lastName')?.value?.trim();
  if (!fn && !ln) { alert('יש להזין שם'); return; }
  saveDonor();
  setTimeout(() => {
    // Find the newly created donor (last one added)
    const newDonor = DB.donors[DB.donors.length-1];
    closeModal('donorModal');
    // Remove banner
    const b = document.getElementById('qdResumeBanner'); if(b) b.remove();
    // Reopen QD and pick the new donor
    setTimeout(() => {
      openModal('quickDonModal');
      setTimeout(() => {
        if (newDonor) {
          document.getElementById('qd_search').value = donorName(newDonor);
          pickQDDonor(newDonor.id);
        }
        window._qdResumeAfterDonor = false;
      }, 80);
    }, 50);
  }, 150);
}

function pickQDDonor(id) {
  qd_selectedId=id;
  const d=DB.donors.find(x=>x.id===id);
  document.getElementById('qd_results').innerHTML='';
  document.getElementById('qd_search').value=donorName(d);
  document.getElementById('qd_selected').style.display='';
  document.getElementById('qd_selected').innerHTML=`✓ <strong>${donorName(d)}</strong> <span style="color:var(--muted);font-size:11px">${d.code||''} | ${d.affil||''}</span>`;
}

function saveQuickDonation() {
  if(!qd_selectedId){alert('יש לבחור תורם');return;}
  const amount=parseFloat(document.getElementById('qd_amount').value);
  if(!amount||amount<=0){alert('יש להזין סכום תקין');return;}
  const d=DB.donors.find(x=>x.id===qd_selectedId); if(!d) return;
  if(!d.donations) d.donations=[];
  const qdAttrib = getDonAttribution('qd');
  d.donations.push({amount,date:document.getElementById('qd_date').value,method:document.getElementById('qd_method').value,campaignId:document.getElementById('qd_campaign').value||'',fundraiserId:qdAttrib.fundraiserId,groupId:qdAttrib.groupId,notes:document.getElementById('qd_notes').value.trim()});
  auditLog('create', `תרומה מהירה ₪${amount} ל${donorName(d)}`);
  saveDB(); renderGlobalStats(); closeModal('quickDonModal');
  if(document.getElementById('pageDash').classList.contains('active')) renderDash();
  alert(`התרומה של ₪${amount.toLocaleString()} נשמרה עבור ${donorName(d)}`);
}

function saveQuickDonationAndNew() {
  if(!qd_selectedId){alert('יש לבחור תורם');return;}
  const amount=parseFloat(document.getElementById('qd_amount').value);
  if(!amount||amount<=0){alert('יש להזין סכום תקין');return;}
  const d=DB.donors.find(x=>x.id===qd_selectedId); if(!d) return;
  if(!d.donations) d.donations=[];
  const qdFrId=document.getElementById('qd_fr_id')?document.getElementById('qd_fr_id').value:'';
  d.donations.push({amount,date:document.getElementById('qd_date').value,method:document.getElementById('qd_method').value,campaignId:document.getElementById('qd_campaign').value||'',fundraiserId:qdFrId,notes:document.getElementById('qd_notes').value.trim()});
  saveDB(); renderGlobalStats();
  if(document.getElementById('pageDash').classList.contains('active')) renderDash();
  // Reset for new donation
  qd_selectedId=null;
  document.getElementById('qd_search').value='';
  document.getElementById('qd_results').innerHTML='';
  document.getElementById('qd_selected').style.display='none';
  document.getElementById('qd_amount').value='';
  document.getElementById('qd_notes').value='';
  if(document.getElementById('qd_fr_search')) { document.getElementById('qd_fr_search').value=''; document.getElementById('qd_fr_id').value=''; document.getElementById('qd_fr_results').innerHTML=''; }
  setTimeout(()=>document.getElementById('qd_search').focus(),50);
}

// ════════════════════════════════════════════════════
// CAMPAIGN
// ════════════════════════════════════════════════════
function populateCampaignSelect(elId) {
  const el=document.getElementById(elId); if(!el) return;
  const ac=activeCampaign();
  el.innerHTML=`<option value="">ללא מגבית</option>`;
  DB.campaigns.forEach(c=>{
    el.innerHTML+=`<option value="${c.id}"${c.id===ac?.id?' style="font-weight:700"':''}>${c.name}${c.active?' ★':''}</option>`;
  });
}

function openNewCampaignModal() {
  document.getElementById('cm_editId').value='';
  document.getElementById('campModalTitle').textContent='מגבית חדשה';
  document.getElementById('cm_name').value='';
  document.getElementById('cm_year').value='';
  document.getElementById('cm_goal').value='';
  document.getElementById('cm_deadline').value='';
  document.getElementById('cm_active').value='true';
  document.getElementById('cm_desc').value='';
  openModal('campaignModal');
}

function saveCampaign() {
  const name=document.getElementById('cm_name').value.trim();
  if(!name){alert('יש להזין שם');return;}
  const isActive=document.getElementById('cm_active').value==='true';
  if(isActive) DB.campaigns.forEach(c=>c.active=false);
  const editId=document.getElementById('cm_editId').value;
  const obj={id:editId||'C'+Date.now(),name,year:document.getElementById('cm_year').value.trim(),goal:parseFloat(document.getElementById('cm_goal').value)||0,deadline:document.getElementById('cm_deadline').value,deadlineTime:document.getElementById('cm_deadline_time')?.value||'23:59',active:isActive,desc:document.getElementById('cm_desc').value.trim()};
  if(editId){const idx=DB.campaigns.findIndex(x=>x.id===editId);if(idx>=0)DB.campaigns[idx]=obj;}
  else DB.campaigns.push(obj);
  saveDB(); closeModal('campaignModal'); renderCampaignPage();
  populateReportCampaigns();
  renderCampMgmtList();
}


function frRaisedCamp(frId, campId) {
  let tot = 0;
  DB.donors.forEach(d => (d.donations||[]).forEach(dn => {
    if (dn.fundraiserId === frId && dn.campaignId === campId) tot += parseFloat(dn.amount||0);
  }));
  return tot;
}
function buildCampFRStats(campId) {
  const frStats = (DB.fundraisers||[]).map(f => ({f, r: frRaisedTotal(f.id, campId)})).sort((a,b)=>b.r-a.r).slice(0,10);
  const grpStats = (DB.groups||[]).map(g => ({g, r: grpRaisedCamp(g, campId)})).sort((a,b)=>b.r-a.r).slice(0,10);
  const vaadMap = {};
  (DB.fundraisers||[]).forEach(f => { const v = f.vaad||'?'; if(!vaadMap[v]) vaadMap[v]=0; vaadMap[v] += frRaisedCamp(f.id, campId); });
  const vaadTop = Object.entries(vaadMap).sort((a,b)=>b[1]-a[1]).slice(0,5);
  return `<div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:16px">
    <div>
      <h4 style="font-size:13px;font-weight:700;margin-bottom:8px">🏆 10 המתרימים המובילים</h4>
      <table class="t10"><thead><tr><th>#</th><th>שם</th><th>וועד</th><th>גייס</th></tr></thead><tbody>
      ${frStats.map((x,i)=>`<tr><td class="rank">${i+1}</td><td>${(x.f.firstName||'')+' '+(x.f.lastName||'')}</td><td>${x.f.vaad||''}</td><td><strong style="color:var(--success)">₪${x.r.toLocaleString()}</strong></td></tr>`).join('')||'<tr><td colspan="4" style="text-align:center;padding:10px;color:var(--muted)">אין נתונים</td></tr>'}
      </tbody></table>
    </div>
    <div>
      <h4 style="font-size:13px;font-weight:700;margin-bottom:8px">👥 10 הקבוצות המובילות</h4>
      <table class="t10"><thead><tr><th>#</th><th>קבוצה</th><th>קוד</th><th>גייסה</th></tr></thead><tbody>
      ${grpStats.map((x,i)=>`<tr><td class="rank">${i+1}</td><td>${x.g.name}</td><td>${x.g.code||''}</td><td><strong style="color:var(--success)">₪${x.r.toLocaleString()}</strong></td></tr>`).join('')||'<tr><td colspan="4" style="text-align:center;padding:10px;color:var(--muted)">אין קבוצות</td></tr>'}
      </tbody></table>
    </div>
  </div>
  <div style="margin-top:14px">
    <h4 style="font-size:13px;font-weight:700;margin-bottom:8px">🎓 גיוס לפי וועד</h4>
    <table class="t10" style="width:auto"><thead><tr><th>וועד</th><th>גייס</th><th>מתרימים</th></tr></thead><tbody>
    ${vaadTop.map(([v,r])=>{
      const cnt = (DB.fundraisers||[]).filter(f=>f.vaad===v).length;
      return `<tr><td><strong>${v}</strong></td><td><strong style="color:var(--success)">₪${r.toLocaleString()}</strong></td><td>${cnt}</td></tr>`;
    }).join('')||'<tr><td colspan="3" style="padding:10px;color:var(--muted)">אין נתונים</td></tr>'}
    </tbody></table>
  </div>`;
}

function renderCampaignPage() {
  if(!DB.campaigns.length){
    document.getElementById('campaignContent').innerHTML=`<div style="text-align:center;padding:60px;color:var(--muted)"><div style="font-size:48px;margin-bottom:12px">🎯</div><h3>אין מגביות עדיין</h3><p>לחץ על "מגבית חדשה" להוספה</p></div>`;
    return;
  }
  const ac=activeCampaign();
  let html='';
  // Active campaign panel
  if(ac) {
    const raised=DB.donors.reduce((s,d)=>s+(d.donations||[]).filter(dn=>dn.campaignId===ac.id).reduce((ss,dn)=>ss+parseFloat(dn.amount||0),0),0);
    const donorsWho=DB.donors.filter(d=>(d.donations||[]).some(dn=>dn.campaignId===ac.id));
    const donCount=DB.donors.reduce((s,d)=>s+(d.donations||[]).filter(dn=>dn.campaignId===ac.id).length,0);
    const goal=parseFloat(ac.goal)||0;
    const pct=goal>0?Math.min((raised/goal)*100,100):0;
    const over=raised>=goal&&goal>0;
    const remaining=over?0:goal-raised;
    // Build countdown string
    let countdownHtml = '';
    if(ac.deadline) {
      const deadlineStr = ac.deadline + 'T' + (ac.deadlineTime||'23:59') + ':00';
      const dl = new Date(deadlineStr);
      const now = new Date();
      const diff = dl - now;
      if(diff > 0) {
        const days = Math.floor(diff / 86400000);
        const hrs = Math.floor((diff % 86400000) / 3600000);
        const mins = Math.floor((diff % 3600000) / 60000);
        countdownHtml = `<div id="campCountdown" style="display:flex;align-items:center;gap:10px;background:rgba(201,168,76,.15);border:1px solid var(--gold);border-radius:10px;padding:10px 16px;margin-bottom:14px;font-size:13px">
          <span style="font-size:22px">⏳</span>
          <div>
            <div style="font-weight:700;color:var(--navy)">נותרו לסיום המגבית</div>
            <div style="font-size:20px;font-weight:900;color:var(--gold)">${days} ימים, ${hrs} שעות, ${mins} דקות</div>
            <div style="font-size:11px;color:var(--muted)">יעד: ${new Date(deadlineStr).toLocaleDateString('he-IL',{day:'numeric',month:'long',year:'numeric',hour:'2-digit',minute:'2-digit'})}</div>
          </div>
        </div>`;
        // Start live update
        if(window._countdownTimer) clearInterval(window._countdownTimer);
        window._countdownTimer = setInterval(() => {
          const el=document.getElementById('campCountdown');
          if(!el){clearInterval(window._countdownTimer);return;}
          const d2=new Date(deadlineStr)-new Date();
          if(d2<=0){el.innerHTML='<span style="color:red;font-weight:700">⛔ המגבית הסתיימה</span>';clearInterval(window._countdownTimer);return;}
          const dd=Math.floor(d2/86400000), hh=Math.floor((d2%86400000)/3600000), mm=Math.floor((d2%3600000)/60000);
          el.querySelector('div > div:nth-child(2)').textContent=dd+' ימים, '+hh+' שעות, '+mm+' דקות';
        }, 30000);
      } else {
        countdownHtml = '<div style="background:#fee2e2;border:1px solid #fca5a5;border-radius:8px;padding:10px;margin-bottom:12px;font-size:13px;color:#991b1b;font-weight:700">⛔ המגבית הסתיימה ב-'+dl.toLocaleDateString("he-IL")+'</div>';
      }
    }
    html+=`<div class="card" style="border:2px solid var(--gold)">
      <div class="card-header" style="background:linear-gradient(135deg,var(--navy),#2a3f6b)">
        <h3>🎯 ${ac.name} ${ac.year?'— '+ac.year:''} <span style="background:var(--gold);color:var(--navy);font-size:11px;padding:2px 8px;border-radius:10px;font-weight:700;margin-right:8px">פעילה</span></h3>
        ${``}
      </div>
      <div class="card-body">
        <div class="camp-goal ${over?'over':'under'}">₪${goal>0?goal.toLocaleString():'?'}</div>
        <div style="text-align:center;font-size:13px;color:var(--muted);margin-bottom:12px">יעד המגבית</div>
        <div class="progress-bar" style="height:20px;border-radius:12px"><div class="progress-fill ${over?'over':''}" style="width:${pct}%;border-radius:12px;display:flex;align-items:center;justify-content:flex-end;padding-right:8px;font-size:11px;font-weight:700;color:white;min-width:${pct>10?'auto':'0'};transition:width 1s ease">${pct>=15?Math.round(pct)+'%':''}</div></div>
        <div style="display:flex;justify-content:space-between;font-size:12px;margin-top:4px">
          <span style="color:var(--success)">₪${raised.toLocaleString()} נתרם</span>
          <span style="font-weight:700;color:${over?'var(--success)':'var(--navy)'}">${Math.round(pct)}% מהיעד</span>
          <span style="color:${over?'var(--success)':'var(--danger)'}">₪${over?(raised-goal).toLocaleString():remaining.toLocaleString()} ${over?'מעל יעד':'נותר'}</span>
        </div>
        <div class="stat-grid" style="grid-template-columns:repeat(4,1fr)">
          <div class="stat-card green" style="padding:14px"><div class="sv green" style="font-size:22px">₪${raised.toLocaleString()}</div><div class="sl">נתרם עד כה</div></div>
          <div class="stat-card ${over?'green':'red'}" style="padding:14px"><div class="sv ${over?'green':'red'}" style="font-size:22px">₪${over?(raised-goal).toLocaleString():remaining.toLocaleString()}</div><div class="sl">${over?'מעבר ליעד':'נותר לאיסוף'}</div></div>
          <div class="stat-card" style="padding:14px"><div class="sv" style="font-size:22px">${donCount}</div><div class="sl">מספר תרומות</div></div>
          <div class="stat-card" style="padding:14px"><div class="sv" style="font-size:22px">${donorsWho.length}</div><div class="sl">תורמים שתרמו</div></div>
        </div>
        ${ac.deadline?`<div style="margin-top:12px;font-size:13px;color:var(--muted)">📅 תאריך יעד: <strong>${fmt(ac.deadline)}</strong> — ${toHeb(ac.deadline)}</div>`:''}
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:14px">
          <div style="background:var(--teal-bg);border-radius:9px;padding:12px;text-align:center"><div style="font-size:22px;font-weight:700;font-family:'Frank Ruhl Libre',serif;color:var(--teal)">${DB.fundraisers.length}</div><div style="font-size:11px;color:var(--muted)">מתרימים</div></div>
          <div style="background:#fff3e0;border-radius:9px;padding:12px;text-align:center"><div style="font-size:22px;font-weight:700;font-family:'Frank Ruhl Libre',serif;color:var(--warn)">${DB.groups.length}</div><div style="font-size:11px;color:var(--muted)">קבוצות</div></div>
        </div>
        ${buildCampFRStats(ac.id)}
      </div>
    </div>`;
  }

  // All campaigns list
  html+=`<div class="card"><div class="card-header"><h3>כל המגביות</h3></div><div class="card-body" style="padding:0">
    <table><thead><tr><th>שם</th><th>שנה</th><th>יעד</th><th>נתרם</th><th>תאריך יעד</th><th>סטטוס</th><th></th></tr></thead><tbody>
    ${DB.campaigns.map(c=>{
      const raised=DB.donors.reduce((s,d)=>s+(d.donations||[]).filter(dn=>dn.campaignId===c.id).reduce((ss,dn)=>ss+parseFloat(dn.amount||0),0),0);
      return `<tr>
        <td><strong>${c.name}</strong></td>
        <td>${c.year||''}</td>
        <td>₪${(parseFloat(c.goal)||0).toLocaleString()}</td>
        <td><strong style="color:var(--success)">₪${raised.toLocaleString()}</strong></td>
        <td>${fmt(c.deadline)}</td>
        <td><span class="badge ${c.active?'b-cash':'b-other'}">${c.active?'פעילה':'לא פעילה'}</span></td>
        <td>${can('admin')?`<div class="row-actions"><button class="btn btn-outline btn-sm" onclick="editCampaign('${c.id}')">✏️</button><button class="btn btn-danger btn-sm" onclick="deleteCampaign('${c.id}')">🗑️</button></div>`:''}</td>
      </tr>`;
    }).join('')}
    </tbody></table></div></div>`;

  document.getElementById('campaignContent').innerHTML=html;
}

function openCampaignMgmtModal() {
  renderCampMgmtList();
  openModal('campMgmtModal');
}

function renderCampMgmtList() {
  const el = document.getElementById('campMgmtList');
  if (!el) return;
  if (!DB.campaigns || !DB.campaigns.length) {
    el.innerHTML = '<p style="color:var(--muted);text-align:center;padding:20px">אין מגביות רשומות</p>';
    return;
  }
  el.innerHTML = DB.campaigns.map(c => `
    <div style="background:var(--cream);border-radius:10px;padding:14px 18px;margin-bottom:10px;display:flex;align-items:center;justify-content:space-between;gap:10px">
      <div>
        <strong>${c.name}</strong>
        <span class="badge ${c.active?'b-cash':'b-other'}" style="margin-right:8px">${c.active?'פעילה':'לא פעילה'}</span>
        <div style="font-size:12px;color:var(--muted);margin-top:3px">יעד: ₪${(c.goal||0).toLocaleString()} | ${c.year||''} | ${fmt(c.deadline)||''}</div>
      </div>
      <div style="display:flex;gap:6px">
        <button class="btn btn-outline btn-sm" onclick="editCampaign('${c.id}')">✏️ ערוך</button>
        <button class="btn btn-danger btn-sm" onclick="deleteCampaign('${c.id}');renderCampMgmtList()">🗑️</button>
      </div>
    </div>`).join('');
}

function editCampaign(id) {
  const c=DB.campaigns.find(x=>x.id===id); if(!c) return;
  document.getElementById('cm_editId').value=id;
  document.getElementById('campModalTitle').textContent='עריכת מגבית';
  document.getElementById('cm_name').value=c.name||'';
  document.getElementById('cm_year').value=c.year||'';
  document.getElementById('cm_goal').value=c.goal||'';
  document.getElementById('cm_deadline').value=c.deadline||'';
  document.getElementById('cm_active').value=c.active?'true':'false';
  document.getElementById('cm_desc').value=c.desc||'';
  openModal('campaignModal');
}

function deleteCampaign(id) {
  if(!confirm('למחוק מגבית זו?')) return;
  DB.campaigns=DB.campaigns.filter(x=>x.id!==id);
  saveDB(); renderCampaignPage();
}

// ════════════════════════════════════════════════════
// WA / MAIL
// ════════════════════════════════════════════════════
function openWA(){const m=document.getElementById('f_mobile')?.value;if(m)openWAfor(m);}
function openMail(){const e=document.getElementById('f_email')?.value;if(e){if(getEmailSettings().publicKey&&currentDonorId){openSendEmailModal(currentDonorId);}else{openMailfor(e);}}}
function openWAfor(m){const n=m.replace(/\D/g,'');window.open('https://wa.me/'+(n.startsWith('0')?'972'+n.slice(1):n),'_blank');}
function openMailfor(e){window.open('mailto:'+e,'_blank');}

// ════════════════════════════════════════════════════
// USERS MODAL
// ════════════════════════════════════════════════════
function openUsersModal(){
  if(!can('admin')){toast('אין הרשאה');return;}
  renderUsersTable();openModal('usersModal');
}
function renderUsersTable(){
  const roles=[{v:'superadmin',l:'מנהל ראשי'},{v:'admin',l:'מנהל'},{v:'editor',l:'עורך'},{v:'viewer',l:'מבקר'}];
  const isSA = can('superadmin');
  document.getElementById('usersBody').innerHTML=DB.users.map((u,i)=>`<tr>
    <td><input class="form-control" type="email" value="${u.email||u.username||''}" oninput="DB.users[${i}].email=this.value;DB.users[${i}].username=this.value" style="width:160px" placeholder="user@example.com" ${!isSA?'readonly':''}></td>
    <td><input class="form-control" value="${u.displayName||u.username||''}" oninput="DB.users[${i}].displayName=this.value" style="width:110px"></td>
    <td><input class="form-control" type="password" value="${u.password||''}" oninput="DB.users[${i}].password=this.value" style="width:110px" placeholder="סיסמה ראשונית"></td>
    <td><select class="form-control" onchange="DB.users[${i}].role=this.value" style="width:120px" ${!isSA?'disabled':''}>
      ${roles.map(r=>`<option value="${r.v}"${u.role===r.v?' selected':''}>${r.l}</option>`).join('')}
    </select></td>
    <td style="text-align:center"><label title="כניסה ראשונה - יחייב שינוי סיסמה"><input type="checkbox" ${u.firstLogin!==false?'checked':''} onchange="DB.users[${i}].firstLogin=this.checked"> ראשונה</label></td>
    <td>${isSA && (u.email||u.username)!==currentUser.email ? `<button class="btn btn-danger btn-sm" onclick="removeUser(${i})">הסר</button>` : ''}</td>
  </tr>`).join('');
}
function addUserRow(){
  if(!can('superadmin')){toast('רק מנהל ראשי יכול להוסיף משתמשים');return;}
  DB.users.push({email:'',username:'',displayName:'',password:'',role:'viewer',firstLogin:true});
  renderUsersTable();
}
function removeUser(i){
  if(!can('superadmin')){toast('רק מנהל ראשי יכול למחוק משתמשים');return;}
  const u=DB.users[i];
  if((u.email||u.username)===(currentUser.email||currentUser.username)){alert('לא ניתן למחוק את המשתמש הנוכחי');return;}
  if(!confirm(`למחוק את המשתמש ${u.displayName||u.email||u.username}?`)) return;
  DB.users.splice(i,1);
  auditLog('delete',`מחיקת משתמש: ${u.displayName||u.email||u.username}`);
  renderUsersTable();
}
function saveUsers(){saveDB();closeModal('usersModal');toast('✓ המשתמשים נשמרו');auditLog('edit','עדכון רשימת משתמשים');}

// ════════════════════════════════════════════════════
// SETTINGS MODAL — fix save + dynamic dropdowns
// ════════════════════════════════════════════════════
const DEFAULT_SETTINGS = {
  titles: ['','הרב','ד"ר',"פרופ'",'מר',"גב'",'הרבנית','האדמו"ר'],
  affiliations: ['תלמיד','בוגר','הורה תלמיד','הורה בוגר','מכר','עסקי','אחר'],
  closingNames: ['בברכה','בכבוד רב','בהוקרה','בידידות','בתודה','יישר כח'],
  prefTimes: ['טלפוני לפני פורים','פורים בבית','טלפוני בפורים'],
  payMethods: ['מזומן','אשראי',"צ'ק",'העברה בנקאית','אחר'],
  relTypes: ['הורה','סבא','בן','שווער','אח','קרוב'],
};



function getSettings() {
  if (!DB.settings) DB.settings = JSON.parse(JSON.stringify(DEFAULT_SETTINGS));
  return DB.settings;
}

function openSettingsModal(){
  const S = getSettings();
  const lists = [
    {key:'titles', label:'תארים', vals: S.titles},
    {key:'affiliations', label:'התאמות', vals: S.affiliations},
    {key:'closingNames', label:'שמות סגירה', vals: S.closingNames},
    {key:'prefTimes', label:'מועדי תרמה', vals: S.prefTimes},
    {key:'payMethods', label:'אופן תרומה', vals: S.payMethods},
    {key:'relTypes', label:'סיבות שיוך', vals: S.relTypes},
  ];
  document.getElementById('settingsBody').innerHTML=lists.map((lst,li)=>`
    <div style="margin-bottom:18px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <strong>${lst.label}</strong>
        <button class="btn btn-outline btn-sm" onclick="addSetting(${li})">+ הוסף</button>
      </div>
      <div id="slist_${li}">
        ${lst.vals.map(v=>`<div class="setting-item" data-key="${lst.key}"><input class="form-control" value="${v}" style="flex:1"><button class="btn btn-danger btn-sm" onclick="this.parentElement.remove()">✕</button></div>`).join('')}
      </div>
    </div>`).join('');
  openModal('settingsModal');
}

function addSetting(li){
  const d=document.createElement('div');
  d.className='setting-item';
  const keys = ['titles','affiliations','closingNames','prefTimes','payMethods','relTypes'];
  d.dataset.key = keys[li]||'';
  d.innerHTML=`<input class="form-control" style="flex:1" placeholder="ערך חדש..."><button class="btn btn-danger btn-sm" onclick="this.parentElement.remove()">✕</button>`;
  document.getElementById('slist_'+li).appendChild(d);
  d.querySelector('input').focus();
}

function saveSettings() {
  const S = getSettings();
  const keys = ['titles','affiliations','closingNames','prefTimes','payMethods','relTypes'];
  keys.forEach((key,li) => {
    const items = document.querySelectorAll(`#slist_${li} .setting-item input`);
    S[key] = Array.from(items).map(i=>i.value.trim()).filter(Boolean);
  });
  DB.settings = S;
  saveDB();
  // Refresh dropdowns
  refreshSelectsFromSettings();
  closeModal('settingsModal');
  alert('הנתונים הקשיחים נשמרו');
}

function refreshSelectsFromSettings() {
  const S = getSettings();
  // Title
  const updateSelect = (id, vals, emptyLabel) => {
    const el = document.getElementById(id); if(!el) return;
    const cur = el.value;
    el.innerHTML = (emptyLabel ? `<option value="">${emptyLabel}</option>` : '') + vals.map(v=>`<option value="${v}">${v}</option>`).join('');
    if(vals.includes(cur)) el.value = cur;
  };
  updateSelect('f_title', S.titles, 'ללא');
  updateSelect('f_affil', S.affiliations, '-');
  updateSelect('f_closingName', S.closingNames, '-');
  updateSelect('f_prefTime', S.prefTimes, 'לא נקבע');
  updateSelect('nd_method', S.payMethods, '');
  updateSelect('qd_method', S.payMethods, '');
  updateSelect('relType', S.relTypes, '');
}

function populateSelectFromSettings(id, key, emptyLabel) {
  const S = getSettings();
  const el = document.getElementById(id); if(!el) return;
  const vals = S[key] || DEFAULT_SETTINGS[key] || [];
  el.innerHTML = (emptyLabel !== undefined ? `<option value="">${emptyLabel}</option>` : '') + vals.map(v=>`<option value="${v}">${v}</option>`).join('');
}

// ════════════════════════════════════════════════════
// IMPORT / EXPORT
// ════════════════════════════════════════════════════
function openImportModal(){openModal('importModal');document.getElementById('importStatus').innerHTML='';}
function importExcel(input){
  if(!can('import')){alert('אין הרשאה');return;}
  const file=input.files[0];if(!file)return;
  const reader=new FileReader();
  reader.onload=function(e){
    const wb=XLSX.read(new Uint8Array(e.target.result),{type:'array'});
    const rows=XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
    let added=0, skipped=0;
    rows.forEach(row=>{
      let code=String(row['קוד תורם']||'').trim();
      // Auto-assign if missing
      if(!code) code=genCode();
      // If code conflicts, generate new unique code
      if(DB.donors.find(d=>d.code===code)) {
        // Check if it's an exact duplicate row (same name) - skip
        const existing=DB.donors.find(d=>d.code===code);
        if(existing && existing.firstName===(row['שם פרטי']||'') && existing.lastName===(row['שם משפחה']||'')) { skipped++; return; }
        // Different person with same code - assign new code
        code=genCode();
        while(DB.donors.find(d=>d.code===code)) code=genCode();
      }
      DB.donors.push({id:'D'+Date.now()+Math.random(),code,title:row['תואר']||'',firstName:row['שם פרטי']||'',lastName:row['שם משפחה']||'',closingName:row['שם סגירה']||'',affil:row['שיוך']||'',address:row['כתובת']||'',entrance:row['כניסה קומה']||'',phone:row['טלפון']||'',mobile:row['סלולרי']||'',email:row['מייל']||'',marriageYear:row['שנת נישואין']||'',cohort:row['מחזור']||'',prefTime:row['מועד תרמה']||'',notes:row['הערות']||'',createdAt:new Date().toISOString(),donations:[],futureDonations:[],relations:[]});
      added++;
    });
    saveDB();renderAll();
    let msg=`✓ יובאו ${added} תורמים`;
    if(skipped>0) msg+=` | ${skipped} כפולים דולגו`;
    document.getElementById('importStatus').innerHTML=`<div style="color:var(--success)">${msg}</div>`;
    auditLog('import', `ייבוא Excel: ${added} תורמים`);
    input.value='';
  };
  reader.readAsArrayBuffer(file);
}

function exportTable(){
  if(!can('export')){alert('אין הרשאת ייצוא');return;}
  const rows=filteredRows.map(d=>({'קוד תורם':d.code,'תואר':d.title,'שם פרטי':d.firstName,'שם משפחה':d.lastName,'שיוך':d.affil,'כתובת':d.address,'טלפון':d.phone,'סלולרי':d.mobile,'מייל':d.email,'מועד תרמה':d.prefTime,'הערות':d.notes,'סך תרומות':getTotal(d),'תרומה גבוהה':getMax(d)}));
  const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(rows),'תורמים');
  XLSX.writeFile(wb,`תורמים_${today()}.xlsx`);
}

function exportExcel(){
  if(!can('export')){alert('אין הרשאת ייצוא');return;}
  const wb=XLSX.utils.book_new();
  const donorRows=DB.donors.map(d=>({'קוד':d.code,'תואר':d.title,'שם פרטי':d.firstName,'שם משפחה':d.lastName,'שיוך':d.affil,'כתובת':d.address,'טלפון':d.phone,'סלולרי':d.mobile,'מייל':d.email,'מועד תרמה':d.prefTime,'הערות':d.notes,'סך תרומות':getTotal(d),'תרומה גבוהה':getMax(d),'תאריך יצירה':fmt(d.createdAt?.split('T')[0]||'')}));
  XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(donorRows),'תורמים');
  const donRows=[];
  DB.donors.forEach(d=>(d.donations||[]).forEach(dn=>donRows.push({'קוד':d.code,'שם':donorName(d),'סכום':dn.amount,'תאריך':fmt(dn.date),'אופן':dn.method,'מגבית':campName(dn.campaignId),'הערות':dn.notes})));
  XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(donRows),'תרומות');
  const futRows=[];
  DB.donors.forEach(d=>(d.futureDonations||[]).forEach(f=>futRows.push({'קוד':d.code,'שם':donorName(d),'תאריך יעד':fmt(f.date),'סכום צפוי':f.expectedAmount||'','מגבית':campName(f.campaignId),'הערות':f.notes})));
  XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(futRows),'תרומות עתידיות');
  XLSX.writeFile(wb,`מלא_${today()}.xlsx`);
}

// ════════════════════════════════════════════════════
// REPORTS
// ════════════════════════════════════════════════════
function populateReportCampaigns(){
  const el=document.getElementById('rpt_camp');if(!el)return;
  el.innerHTML=`<option value="">כל המגביות</option>`+DB.campaigns.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');
}

function generateReport(){
  const affil=document.getElementById('rpt_affil').value;
  const pref=document.getElementById('rpt_pref').value;
  const campId=document.getElementById('rpt_camp').value;
  const min=parseFloat(document.getElementById('rpt_min').value)||0;
  const from=document.getElementById('rpt_fromDate').value;
  const to=document.getElementById('rpt_toDate').value;

  // Get donors that have donations matching filters
  const filtered=DB.donors.filter(d=>{
    const dons=(d.donations||[]).filter(dn=>(!campId||dn.campaignId===campId)&&(!from||dn.date>=from)&&(!to||dn.date<=to));
    const total=dons.reduce((s,x)=>s+parseFloat(x.amount||0),0);
    return (!affil||d.affil===affil)&&(!pref||d.prefTime===pref)&&total>=min;
  });

  const reportTotal=filtered.reduce((s,d)=>{
    const dons=(d.donations||[]).filter(dn=>(!campId||dn.campaignId===campId)&&(!from||dn.date>=from)&&(!to||dn.date<=to));
    return s+dons.reduce((ss,dn)=>ss+parseFloat(dn.amount||0),0);
  },0);

  document.getElementById('reportOutput').innerHTML=`<div class="card" style="margin-top:16px">
    <div class="card-header"><h3>תוצאות הדוח</h3><div style="display:flex;gap:8px">
      <span class="badge" style="background:var(--cream-d);color:var(--muted)">${filtered.length} תורמים</span>
      <span class="badge b-cash">₪${reportTotal.toLocaleString()} סה"כ</span>
    </div></div>
    <div class="card-body" style="padding:0"><div class="table-scroll"><table>
      <thead><tr><th>קוד</th><th>שם</th><th>שיוך</th><th>מועד תרמה</th><th>סלולרי</th><th>סך תרומות</th><th>גבוהה</th><th>מס' תרומות</th></tr></thead>
      <tbody>${filtered.map(d=>{
        const dons=(d.donations||[]).filter(dn=>(!campId||dn.campaignId===campId)&&(!from||dn.date>=from)&&(!to||dn.date<=to));
        const t=dons.reduce((s,x)=>s+parseFloat(x.amount||0),0);
        const mx=dons.length?Math.max(...dons.map(x=>parseFloat(x.amount||0))):0;
        return `<tr><td>${d.code||''}</td><td>${donorName(d)}</td><td>${d.affil||''}</td><td>${d.prefTime||''}</td><td>${d.mobile||''}</td><td><strong>₪${t.toLocaleString()}</strong></td><td>₪${mx.toLocaleString()}</td><td>${dons.length}</td></tr>`;
      }).join('')}</tbody>
    </table></div></div></div>`;
}


// ════════════════════════════════════════════════════
// MODALS
// ════════════════════════════════════════════════════
function openModal(id){document.getElementById(id).classList.add('open');}
function closeModal(id){document.getElementById(id).classList.remove('open');}
document.querySelectorAll('.modal-overlay').forEach(o=>o.addEventListener('click',e=>{if(e.target===o)o.classList.remove('open');}));

// ════════════════════════════════════════════════════
// DEMO DATA
// ════════════════════════════════════════════════════

// ══════════════════════════════════════════════════════
// FUNDRAISERS (מתרימים)
// ══════════════════════════════════════════════════════
let frSortCol = 'name', frSortDir = 1;
let grpTempMembers = []; // temp member IDs when editing group
let grpTempDonors = [];  // temp donor IDs when editing group

// ── Generate codes ──
const VAAD_PREFIX = {'וועד א':1,'וועד ב':2,'וועד ג':3,'וועד ד':4,'וועד ה':5,'וועד ו':6,'וועד ז':7,'וועד ח':8,'וועד ט':9};
function genFRCode() {
  if (!DB.nextFRCode) DB.nextFRCode = 1;
  return 'M' + String(DB.nextFRCode++).padStart(4,'0');
}
function genGrpCode(vaad) {
  const prefix = VAAD_PREFIX[vaad] ? String(VAAD_PREFIX[vaad]) : '9';
  if (!DB.nextGrpSeq) DB.nextGrpSeq = {};
  if (!DB.nextGrpSeq[prefix]) DB.nextGrpSeq[prefix] = 1;
  const seq = String(DB.nextGrpSeq[prefix]++).padStart(2,'0');
  return prefix + seq;
}

// ── Helper: get name of FR ──
function frNameById(id) {
  if (!id) return '';
  const f = DB.fundraisers.find(x => x.id === id);
  return f ? (f.firstName||'') + ' ' + (f.lastName||'') : '';
}

// ── How much a fundraiser raised (optionally for a specific campaign) ──


// ══════════════════════════════════════
// DONATIONS PANEL
// ══════════════════════════════════════
let donsPanelSort = { col:'date', dir:-1 };
let donsPanelRows = [];

function renderDonationsPanel() {
  rebuildDonsFilters();
  const q = (document.getElementById('donsSearch')?.value||'').toLowerCase().trim();
  const from = document.getElementById('donsFrom')?.value||'';
  const to   = document.getElementById('donsTo')?.value||'';

  const donorSel  = getMultiSelected('donsDonorOpts');
  const methodSel = getMultiSelected('donsMethodOpts');
  const campSel   = getMultiSelected('donsCampOpts');
  const frSel     = getMultiSelected('donsFROpts');

  updateMultiLabel('donsDonorFilterLabel',  'donsDonorOpts',  'כל התורמים');
  updateMultiLabel('donsMethodFilterLabel', 'donsMethodOpts', 'כל אופני תשלום');
  updateMultiLabel('donsCampFilterLabel',   'donsCampOpts',   'כל המגביות');
  updateMultiLabel('donsFRFilterLabel',     'donsFROpts',     'כל המתרימים');

  let rows = [];
  DB.donors.forEach(donor => {
    (donor.donations||[]).forEach((dn, idx) => {
      const campObj = DB.campaigns.find(c => c.id === dn.campaignId);
      const campName_ = campObj ? campObj.name : '';
      let frLabel = '';
      if (dn.frId) { const fr = DB.fundraisers.find(f => f.id === dn.frId); if(fr) frLabel = ((fr.firstName||'')+' '+(fr.lastName||'')).trim(); }
      else if (dn.fundraiserId) { const fr = DB.fundraisers.find(f => f.id === dn.fundraiserId); if(fr) frLabel = ((fr.firstName||'')+' '+(fr.lastName||'')).trim(); }
      else if (dn.groupId) { const g = DB.groups.find(x => x.id === dn.groupId); if(g) frLabel = g.name; }

      if (q && !donorName(donor).toLowerCase().includes(q) && !(dn.notes||'').toLowerCase().includes(q) && !(donor.code||'').toLowerCase().includes(q)) return;
      if (from && dn.date < from) return;
      if (to   && dn.date > to)   return;
      if (donorSel && !donorSel.has(donorName(donor))) return;
      if (methodSel && !methodSel.has(dn.method||'')) return;
      if (campSel   && !campSel.has(campName_)) return;
      if (frSel     && !frSel.has(frLabel)) return;

      rows.push({ donorId: donor.id, amount: dn.amount, date: dn.date, method: dn.method||'',
                  campaignId: dn.campaignId, frId: dn.frId||dn.fundraiserId||'', groupId: dn.groupId||'',
                  notes: dn.notes||'', donorIdx: DB.donors.indexOf(donor), idx,
                  _donor: donor, _campName: campName_, _frLabel: frLabel });
    });
  });

  rows.sort((a,b) => {
    let av, bv;
    if (donsPanelSort.col==='date')   { av=a.date||''; bv=b.date||''; }
    else if (donsPanelSort.col==='amount') { av=parseFloat(a.amount||0); bv=parseFloat(b.amount||0); }
    else if (donsPanelSort.col==='donor')  { av=donorName(a._donor); bv=donorName(b._donor); }
    else { av=''; bv=''; }
    return av<bv ? donsPanelSort.dir : -donsPanelSort.dir;
  });

  _lastDonsRows = rows; // for print
  donsPanelRows = rows.map(r => ({ donor: r._donor, dn: { amount:r.amount, date:r.date, method:r.method, campaignId:r.campaignId, fundraiserId:r.frId, groupId:r.groupId, notes:r.notes }, donorIdx:r.donorIdx, idx:r.idx }));

  const totalAmt = rows.reduce((s,r) => s+parseFloat(r.amount||0), 0);
  const avgAmt   = rows.length ? totalAmt/rows.length : 0;
  const maxAmt_  = rows.reduce((m,r) => Math.max(m,parseFloat(r.amount||0)), 0);
  const uniqueDonors = new Set(rows.map(r => r.donorId)).size;
  document.getElementById('donsPanelStats').innerHTML = [
    {v:'₪'+Math.round(totalAmt).toLocaleString(), l:'סה"כ', cl:'green'},
    {v:rows.length, l:'מספר תרומות', cl:''},
    {v:uniqueDonors, l:'תורמים שונים', cl:''},
    {v:'₪'+Math.round(avgAmt).toLocaleString(), l:'ממוצע', cl:''},
  ].map(s=>`<div class="stat-card ${s.cl}" style="padding:12px 14px"><div class="stat-val">${s.v}</div><div class="stat-lbl">${s.l}</div></div>`).join('');

  document.getElementById('donsPanelCount').textContent = rows.length + ' תרומות';

  const body = document.getElementById('donsPanelBody');
  if (!body) return;
  body.innerHTML = rows.length === 0
    ? '<tr><td colspan="9" style="text-align:center;padding:24px;color:var(--muted)">אין תרומות תואמות</td></tr>'
    : rows.map(r => {
        const donor = r._donor;
        const dn = { amount:r.amount, date:r.date, method:r.method, campaignId:r.campaignId, fundraiserId:r.frId, groupId:r.groupId, notes:r.notes };
        return `<tr onclick="openDonorById('${donor.id}')" style="cursor:pointer">
          <td style="white-space:nowrap">${fmt(r.date)}</td>
          <td style="font-size:11px;color:var(--muted)">${toHeb(r.date)}</td>
          <td><strong>${donorName(donor)}</strong><br><span style="font-size:10px;color:var(--muted)">${donor.code||''}</span></td>
          <td><strong style="color:var(--success)">₪${parseFloat(r.amount||0).toLocaleString()}</strong></td>
          <td>${dn.method||''}</td>
          <td style="font-size:11px">${r._campName||''}</td>
          <td style="font-size:11px">${r._frLabel||''}</td>
          <td style="font-size:11px;max-width:140px;overflow:hidden;text-overflow:ellipsis">${dn.notes||''}</td>
          <td onclick="event.stopPropagation()">
            ${can('edit') ? `<button class="btn btn-danger btn-sm" onclick="deleteDonFromPanel('${donor.id}',${r.idx})">🗑️</button>` : ''}
          </td>
        </tr>`;
      }).join('');
}


function sortDonsPanel(col) {
  if (donsPanelSort.col===col) donsPanelSort.dir*=-1; else { donsPanelSort.col=col; donsPanelSort.dir=1; }
  renderDonationsPanel();
}

function exportDonationsPanel() {
  if (!can('admin')) { alert('אין הרשאה'); return; }
  const data = [['תאריך','ת. עברי','תורם','סכום','אופן','מגבית','מתרים/קבוצה','הערות'],
    ...donsPanelRows.map(({donor,dn})=>[
      fmt(dn.date), toHeb(dn.date), donorName(donor),
      dn.amount, dn.method||'',
      campName(dn.campaignId)||'',
      dn.fundraiserId ? frNameById(dn.fundraiserId) : (dn.groupId ? (DB.groups.find(g=>g.id===dn.groupId)?.name||'') : ''),
      dn.notes||''
    ])
  ];
  const ws = XLSX.utils.aoa_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'תרומות');
  XLSX.writeFile(wb, 'donations_'+today()+'.xlsx');
}

function editDonInPanel(donorId, idx) {
  openDonorById(donorId, 'donations');
  setTimeout(() => editDonation(idx), 400);
}



// ══════════════════════════════════════
// PRINT REPORTS
// ══════════════════════════════════════
const ORG_NAME = 'עזר תורה – תושיה תפרח';

function printGroupReport(grpId) {
  const grp = DB.groups.find(g=>g.id===grpId); if(!grp) return;
  const ac = activeCampaign();
  const members = (grp.memberIds||[]).map(id=>{
    const f=DB.fundraisers.find(x=>x.id===id);
    return f ? (f.firstName||'')+' '+(f.lastName||'') : '';
  }).filter(Boolean);
  const w = window.open('','_blank','width=800,height=600');
  w.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8">
    <title>דוח קבוצה — ${grp.name}</title>
    <style>
      body{font-family:Arial,sans-serif;margin:40px;color:#1a2744;direction:rtl}
      .org{font-size:22px;font-weight:900;color:#1a2744;border-bottom:3px solid #c9a84c;padding-bottom:8px;margin-bottom:6px}
      .camp{font-size:14px;color:#555;margin-bottom:20px}
      .grp-title{font-size:18px;font-weight:700;margin-bottom:4px}
      .grp-code{font-size:13px;color:#888;margin-bottom:16px}
      .member{display:inline-block;background:#f0f4ff;border:1px solid #1a2744;border-radius:6px;padding:5px 14px;margin:4px;font-size:13px}
      @media print{body{margin:20px}tr{page-break-inside:avoid}td{white-space:normal!important;line-height:1.35;max-height:calc(3 * 1.35em);overflow:hidden}}
    </style></head><body>
    <div class="org">${ORG_NAME}</div>
    <div class="camp">${ac?'מגבית: '+ac.name+' '+( ac.year||''):''}</div>
    <div class="grp-title">קבוצה: ${grp.name}</div>
    <div class="grp-code">קוד קבוצה: ${grp.code||'—'} | וועד: ${grp.vaad||'—'}</div>
    <h3 style="margin-top:20px;font-size:14px">חברי הקבוצה (${members.length})</h3>
    <div>${members.map(m=>`<span class="member">${m}</span>`).join('')}</div>
    <div style="margin-top:30px;font-size:12px;color:#aaa">הודפס: ${new Date().toLocaleDateString('he-IL')}</div>
    <script>window.onload=()=>window.print();<\/script>
    </body></html>`);
  w.document.close();
}


// Tanex label formats
const TANEX_FORMATS = {
  '70x42': { cols:3, rows:7, w:70, h:42, label:'70×42 מ"מ (21 לדף)' },
  '70x29': { cols:3, rows:10, w:70, h:29.7, label:'70×29.7 מ"מ (30 לדף)' },
  '105x42': { cols:2, rows:7, w:105, h:42, label:'105×42 מ"מ (14 לדף)' },
};

function openLabelsModal() {
  // Show donor selection + format picker
  if(!document.getElementById('labelsModal')) {
    const modal = document.createElement('div');
    modal.id='labelsModal';
    modal.className='modal-overlay';
    modal.innerHTML=`<div class="modal" style="width:520px">
      <div class="modal-header"><h3>🏷️ הדפסת מדבקות</h3><button class="modal-close" onclick="closeModal('labelsModal')">✕</button></div>
      <div class="modal-body">
        <div class="fg"><label class="form-label">פורמט מדבקה</label>
          <select class="form-control" id="lb_format">
            ${Object.entries(TANEX_FORMATS).map(([k,v])=>`<option value="${k}">${v.label}</option>`).join('')}
          </select>
        </div>
        <div class="fg" style="margin-top:10px"><label class="form-label">תורמים</label>
          <select class="form-control" id="lb_source">
            <option value="filtered">מוצגים כרגע בטבלה</option>
            <option value="all">כל התורמים</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline btn-sm" onclick="closeModal('labelsModal')">ביטול</button>
        <button class="btn btn-navy" onclick="printLabels()">🖨️ הדפס מדבקות</button>
      </div>
    </div>`;
    document.getElementById('app').appendChild(modal);
  }
  openModal('labelsModal');
}

function printLabels() {
  const fmt = TANEX_FORMATS[document.getElementById('lb_format')?.value||'70x42'];
  const source = document.getElementById('lb_source')?.value||'filtered';
  const donors = source==='filtered' && filteredRows?.length ? filteredRows : DB.donors;
  
  const S = getSettings();
  // Build label HTML
  const pageW = 210, pageH = 297;
  const marginL = (pageW - fmt.cols*fmt.w) / 2;
  const marginT = (pageH - fmt.rows*fmt.h) / 2;
  
  const labels = donors.map((d,i) => {
    const closing = d.closingName || '';
    const title = d.title||'';
    const name = donorName(d);
    const addr = d.address||'';
    const city = '';  // parse city from address if needed
    return `<div class="label" style="position:absolute;
      left:${marginL + (i%fmt.cols)*fmt.w}mm;
      top:${marginT + Math.floor(i/fmt.cols)*fmt.h}mm;
      width:${fmt.w-4}mm;height:${fmt.h-3}mm;
      overflow:hidden;padding:2mm 3mm;box-sizing:border-box">
      <div style="font-size:9pt;font-weight:700">לכבוד ${title} ${name}</div>
      <div style="font-size:8pt;margin-top:1mm">${addr}</div>
      ${closing?`<div style="font-size:7pt;color:#555;margin-top:1mm">${closing}</div>`:''}
    </div>`;
  });
  
  // Group into pages
  const perPage = fmt.cols * fmt.rows;
  const pages = [];
  for(let p=0; p<Math.ceil(labels.length/perPage); p++) {
    pages.push(`<div style="position:relative;width:210mm;height:297mm;page-break-after:always">
      ${labels.slice(p*perPage,(p+1)*perPage).join('')}
    </div>`);
  }
  
  const w = window.open('','_blank');
  w.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8">
    <title>מדבקות</title>
    <style>
      *{box-sizing:border-box}
      body{margin:0;padding:0;font-family:Arial,sans-serif;direction:rtl}
      .label{border:0.5pt dotted #ccc}
      @page{size:A4;margin:0}
      @media print{.label{border:none}}
    </style></head><body>
    ${pages.join('')}
    <script>window.onload=()=>window.print();<\/script>
    </body></html>`);
  w.document.close();
  closeModal('labelsModal');
}


// ══════════════════════════════════════════════════════
// REPORTS MODAL
// ══════════════════════════════════════════════════════
let rptRows = [];

function openReportsModal() {
  const S = getSettings();
  const fills = [
    ['rpt_affil', S.affiliations||[]],
    ['rpt_reltype', S.relTypes||[]],
    ['rpt_preftime', S.prefTimes||[]],
  ];
  fills.forEach(([id, vals]) => {
    const el = document.getElementById(id);
    if(!el) return;
    el.innerHTML = '<option value="">הכל</option>' + vals.map(v=>`<option>${v}</option>`).join('');
  });
  const campEl = document.getElementById('rpt_camp');
  if(campEl) campEl.innerHTML = '<option value="">הכל</option>' + DB.campaigns.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');
  runReport();
  openModal('reportsModal');
}

function runReport() {
  const city = (document.getElementById('rpt_city')?.value||'').toLowerCase().trim();
  const neigh = (document.getElementById('rpt_neigh')?.value||'').toLowerCase().trim();
  const grpcode = (document.getElementById('rpt_grpcode')?.value||'').toLowerCase().trim();
  const name = (document.getElementById('rpt_name')?.value||'').toLowerCase().trim();
  const affil = document.getElementById('rpt_affil')?.value||'';
  const preftime = document.getElementById('rpt_preftime')?.value||'';
  const campId = document.getElementById('rpt_camp')?.value||'';
  const minamt = parseFloat(document.getElementById('rpt_minamt')?.value||0)||0;
  const addFrom = document.getElementById('rpt_addfrom')?.value||'';
  const addTo = document.getElementById('rpt_addto')?.value||'';
  const lastFrom = document.getElementById('rpt_lastfrom')?.value||'';

  const grpDonorIds = grpcode ? new Set(DB.groups
    .filter(g=>(g.code||'').toLowerCase().includes(grpcode))
    .flatMap(g=>g.donorIds||[])) : null;

  rptRows = DB.donors.filter(d => {
    const addr = (d.address||'').toLowerCase();
    if (city && !addr.includes(city)) return false;
    if (neigh && !addr.includes(neigh)) return false;
    if (grpcode && grpDonorIds && !grpDonorIds.has(d.id)) return false;
    if (name && !donorName(d).toLowerCase().includes(name)) return false;
    if (affil && d.affil !== affil) return false;
    if (preftime && d.prefTime !== preftime) return false;
    if (addFrom && (d.createdAt||'') < addFrom) return false;
    if (addTo && (d.createdAt||'') > addTo) return false;
    const dons = d.donations||[];
    if (minamt > 0) {
      const tot = dons.reduce((s,dn)=>s+parseFloat(dn.amount||0),0);
      if (tot < minamt) return false;
    }
    if (campId) {
      const campTot = dons.filter(dn=>dn.campaignId===campId).reduce((s,dn)=>s+parseFloat(dn.amount||0),0);
      if (campTot <= 0) return false;
    }
    if (lastFrom && dons.length) {
      const lastDate = dons.map(dn=>dn.date||'').sort().pop();
      if (lastDate < lastFrom) return false;
    }
    return true;
  });

  const count = document.getElementById('rpt_count');
  if(count) count.textContent = `\u05e0\u05de\u05e6\u05d0\u05d5 ${rptRows.length} \u05ea\u05d5\u05e8\u05de\u05d9\u05dd`;

  const body = document.getElementById('rpt_body');
  if(!body) return;
  body.innerHTML = rptRows.length===0
    ? '<tr><td colspan="6" style="text-align:center;padding:20px;color:var(--muted)">\u05d0\u05d9\u05df \u05ea\u05d5\u05e6\u05d0\u05d5\u05ea</td></tr>'
    : rptRows.map(d => {
        const dons = d.donations||[];
        const tot = dons.reduce((s,dn)=>s+parseFloat(dn.amount||0),0);
        const lastDate = dons.map(dn=>dn.date||'').sort().pop()||'';
        return `<tr style="border-bottom:1px solid var(--cream-d);cursor:pointer" onclick="openDonorById('${d.id}')">
          <td style="padding:6px 10px"><strong>${d.title||''} ${donorName(d)}</strong></td>
          <td style="padding:6px 10px;font-size:11px">${d.address||''}</td>
          <td style="padding:6px 10px;font-size:11px">${d.phone||d.mobile||''}</td>
          <td style="padding:6px 10px;font-size:11px">${d.affil||''}</td>
          <td style="padding:6px 10px;font-weight:700;color:var(--success)">\u20aa${Math.round(tot).toLocaleString()}</td>
          <td style="padding:6px 10px;font-size:11px">${fmt(lastDate)}</td>
        </tr>`;
      }).join('');
}

function exportReport() {
  if (!can('admin')) { alert('\u05d0\u05d9\u05df \u05d4\u05e8\u05e9\u05d0\u05d4'); return; }
  const data = [['\u05e7\u05d5\u05d3','\u05e9\u05dd','\u05db\u05ea\u05d5\u05d1\u05ea','\u05d8\u05dc\u05e4\u05d5\u05df','\u05e1\u05dc\u05d5\u05dc\u05e8\u05d9','\u05e9\u05d9\u05d5\u05da','\u05de\u05d5\u05e2\u05d3','\u05d4\u05e2\u05e8\u05d5\u05ea','\u05e1\u05da \u05ea\u05e8\u05d5\u05de\u05d5\u05ea','\u05ea\u05e8\u05d5\u05de\u05d4 \u05d0\u05d7\u05e8\u05d5\u05e0\u05d4'],
    ...rptRows.map(d=>{
      const dons=d.donations||[];
      const tot=dons.reduce((s,dn)=>s+parseFloat(dn.amount||0),0);
      const last=dons.map(dn=>dn.date||'').sort().pop()||'';
      return [d.code||'',donorName(d),d.address||'',d.phone||'',d.mobile||'',d.affil||'',d.prefTime||'',d.notes||'',tot,fmt(last)];
    })
  ];
  const ws=XLSX.utils.aoa_to_sheet(data); const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,'\u05d3\u05d5\u05d7');
  XLSX.writeFile(wb,'report_'+today()+'.xlsx');
}

function printReport() {
  const ac = activeCampaign();
  const rows = rptRows.length ? rptRows : DB.donors;
  const prev3 = [...DB.campaigns].sort((a,b)=>(b.year||'').localeCompare(a.year||'')).filter(c=>!c.active).slice(0,3);
  const ORG = '\u05e2\u05d6\u05e8 \u05ea\u05d5\u05e8\u05d4 \u2013 \u05ea\u05d5\u05e9\u05d9\u05d4 \u05ea\u05e4\u05e8\u05d7';
  const mapCoords = rows.filter(d=>d.lat&&d.lng);
  const mapSection = mapCoords.length > 0
    ? `<div style="margin-top:20px"><h3 style="font-size:12px">\u05de\u05e4\u05ea \u05d0\u05d9\u05e1\u05d5\u05e3</h3>
        <iframe src="https://maps.google.com/maps?q=${encodeURIComponent(mapCoords.slice(0,5).map(d=>d.address||'').join('|'))}&output=embed&z=14" 
          width="100%" height="280" style="border:1px solid #ccc;border-radius:6px" loading="lazy"></iframe></div>` : '';

  const w = window.open('','_blank','width=1000,height=700');
  w.document.write('<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8"><title>\u05d3\u05d5\u05d7 \u05ea\u05d5\u05e8\u05de\u05d9\u05dd</title><style>body{font-family:Arial,sans-serif;margin:20px 30px;color:#1a2744;direction:rtl;font-size:11px}.org{font-size:18px;font-weight:900;border-bottom:3px solid #c9a84c;padding-bottom:5px;margin-bottom:4px}.sub{font-size:11px;color:#666;margin-bottom:12px}table{width:100%;border-collapse:collapse}th{background:#1a2744;color:white;padding:5px 8px;text-align:right;font-size:10px}td{padding:4px 8px;border-bottom:1px solid #eee;vertical-align:top;font-size:10px}tr:nth-child(even) td{background:#f9f9f9}@media print{body{margin:10px}tr{page-break-inside:avoid}td{white-space:normal!important;line-height:1.35;max-height:calc(3 * 1.35em);overflow:hidden}}</style></head><body>');
  w.document.write(`<div class="org">${ORG}</div>`);
  w.document.write(`<div class="sub">${ac?ac.name+' '+(ac.year||''):''} | ${rows.length} \u05ea\u05d5\u05e8\u05de\u05d9\u05dd | ${new Date().toLocaleDateString('he-IL')}</div>`);
  w.document.write('<table><thead><tr><th>\u05e9\u05dd</th><th>\u05db\u05ea\u05d5\u05d1\u05ea</th><th>\u05d8\u05dc\u05e4\u05d5\u05df</th><th>\u05d4\u05e2\u05e8\u05d5\u05ea</th><th>\u05ea\u05e8\u05d5\u05de\u05d4 \u05d2\u05d1\u05d5\u05d4\u05d4</th>'+prev3.map(c=>`<th>${c.name}</th>`).join('')+'</tr></thead><tbody>');
  rows.forEach(d => {
    const dons=d.donations||[];
    const maxDon=Math.max(0,...dons.map(dn=>parseFloat(dn.amount||0)));
    const prev3Tots=prev3.map(c=>dons.filter(dn=>dn.campaignId===c.id).reduce((s,dn)=>s+parseFloat(dn.amount||0),0));
    w.document.write(`<tr><td><strong>${d.title||''} ${donorName(d)}</strong></td><td>${d.address||''}</td><td>${[d.phone,d.mobile].filter(Boolean).join(' | ')}</td><td>${d.notes||''}</td><td style="text-align:center;font-weight:700">${maxDon>0?'\u20aa'+maxDon.toLocaleString():''}</td>${prev3Tots.map(t=>`<td style="text-align:center">${t>0?'\u20aa'+t.toLocaleString():''}</td>`).join('')}</tr>`);
  });
  w.document.write('</tbody></table>'+mapSection+'<div style="margin-top:10px;font-size:9px;color:#aaa">\u05d4\u05d5\u05d3\u05e4\u05e1: '+new Date().toLocaleDateString('he-IL')+'</div><script>window.onload=()=>window.print();<\/script></body></html>');
  w.document.close();
}

// ══════════════════════════════════════════════════════
// PRINT MODAL
// ══════════════════════════════════════════════════════
function openPrintModal() { openModal('printModal'); }

// ══════════════════════════════════════════════════════
// LABELS WIZARD
// ══════════════════════════════════════════════════════
const LB_FMTS = {
  '70x42':  {cols:3,rows:7, lw:70,  lh:42,   ml:0, mt:10.5},
  '70x29':  {cols:3,rows:10,lw:70,  lh:29.7, ml:0, mt:13.5},
  '105x42': {cols:2,rows:7, lw:105, lh:42,   ml:0, mt:10.5},
};

function openLabelsWizard() {
  closeModal('printModal');
  const grpSel = document.getElementById('lb_group_sel');
  if(grpSel) grpSel.innerHTML = '<option value="">\u05db\u05dc \u05d4\u05e7\u05d1\u05d5\u05e6\u05d5\u05ea</option>' + DB.groups.map(g=>`<option value="${g.id}">${g.name} (${g.code||''})</option>`).join('');
  const srcEl = document.getElementById('lb_source');
  if(srcEl) srcEl.onchange = function() {
    const el = document.getElementById('lb_group_sel');
    if(el) el.style.display = this.value==='group'?'':'none';
  };
  previewLabel();
  openModal('labelsWizardModal');
}

function previewLabel() {
  const font = document.getElementById('lb_font')?.value||'Arial';
  const fs = document.getElementById('lb_fontsize')?.value||'9';
  const showGreeting = document.getElementById('lbf_greeting')?.checked;
  const showTitle = document.getElementById('lbf_title')?.checked;
  const showName = document.getElementById('lbf_name')?.checked;
  const showClosing = document.getElementById('lbf_closing')?.checked;
  const showAddr = document.getElementById('lbf_address')?.checked;
  const showPhone = document.getElementById('lbf_phone')?.checked;
  const sample = DB.donors[0] || {title:'\u05d4\u05e8\u05d1', firstName:'\u05d9\u05e9\u05e8\u05d0\u05dc', lastName:'\u05d9\u05e9\u05e8\u05d0\u05dc\u05d9', closingName:'\u05d1\u05d1\u05e8\u05db\u05d4', address:'\u05e8\u05d7\u05d5\u05d1 \u05d4\u05e8\u05e6\u05dc 12, \u05ea\u05dc \u05d0\u05d1\u05d9\u05d1', phone:'03-1234567'};
  let lines = [];
  if(showGreeting) lines.push('<div>\u05dc\u05db\u05d1\u05d5\u05d3</div>');
  const nameLine = [showTitle?sample.title||'':'', showName?donorName(sample):''].filter(Boolean).join(' ');
  if(nameLine.trim()) lines.push(`<div><strong>${nameLine.trim()}</strong></div>`);
  if(showClosing && sample.closingName) lines.push(`<div>${sample.closingName}</div>`);
  if(showAddr && sample.address) lines.push(`<div>${sample.address}</div>`);
  if(showPhone && (sample.phone||sample.mobile)) lines.push(`<div>${sample.phone||sample.mobile}</div>`);
  const prev = document.getElementById('lb_preview');
  if(prev) prev.innerHTML = lines.map(l=>`<div style="font-family:${font};font-size:${fs}pt">${l}</div>`).join('');
}

function runPrintLabels() {
  const fmtKey = document.querySelector('input[name="lb_fmt"]:checked')?.value||'70x42';
  const fmt = LB_FMTS[fmtKey];
  const source = document.getElementById('lb_source')?.value||'all';
  const grpId = document.getElementById('lb_group_sel')?.value||'';
  const font = document.getElementById('lb_font')?.value||'Arial';
  const fs = parseInt(document.getElementById('lb_fontsize')?.value||'9');
  const showGreeting = document.getElementById('lbf_greeting')?.checked;
  const showTitle = document.getElementById('lbf_title')?.checked;
  const showName = document.getElementById('lbf_name')?.checked;
  const showClosing = document.getElementById('lbf_closing')?.checked;
  const showAddr = document.getElementById('lbf_address')?.checked;
  const showPhone = document.getElementById('lbf_phone')?.checked;

  let donors;
  if (source==='group' && grpId) {
    const grp = DB.groups.find(g=>g.id===grpId);
    donors = (grp?.donorIds||[]).map(id=>DB.donors.find(d=>d.id===id)).filter(Boolean);
  } else if (source==='filtered') {
    donors = rptRows.length ? rptRows : DB.donors;
  } else {
    donors = DB.donors;
  }

  const perPage = fmt.cols * fmt.rows;
  const pages = [];
  for (let p=0; p<Math.ceil(donors.length/perPage); p++) {
    const pg = donors.slice(p*perPage,(p+1)*perPage);
    const divs = pg.map((d,i) => {
      const col = i % fmt.cols;
      const row2 = Math.floor(i / fmt.cols);
      let lines = [];
      if(showGreeting) lines.push('<div>\u05dc\u05db\u05d1\u05d5\u05d3</div>');
      const nl = [showTitle?d.title||'':'',showName?donorName(d):''].filter(Boolean).join(' ');
      if(nl.trim()) lines.push(`<div><strong>${nl.trim()}</strong></div>`);
      if(showClosing&&d.closingName) lines.push(`<div>${d.closingName}</div>`);
      if(showAddr&&d.address) lines.push(`<div>${d.address}</div>`);
      if(showPhone&&(d.phone||d.mobile)) lines.push(`<div>${d.phone||d.mobile}</div>`);
      return `<div style="position:absolute;left:${fmt.ml+col*fmt.lw}mm;top:${fmt.mt+row2*fmt.lh}mm;width:${fmt.lw-4}mm;height:${fmt.lh-2}mm;overflow:hidden;padding:2mm 3mm;font-family:${font};font-size:${fs}pt;line-height:1.3;box-sizing:border-box">${lines.join('')}</div>`;
    }).join('');
    pages.push(`<div style="position:relative;width:210mm;height:297mm;page-break-after:always">${divs}</div>`);
  }
  const w = window.open('','_blank');
  w.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8"><title>\u05de\u05d3\u05d1\u05e7\u05d5\u05ea</title><style>*{box-sizing:border-box}body{margin:0;padding:0;direction:rtl}@page{size:A4;margin:0}@media print{body{margin:0}}</style></head><body>${pages.join('')}<script>window.onload=()=>window.print();<\/script></body></html>`);
  w.document.close();
  closeModal('labelsWizardModal');
}

// ══════════════════════════════════════════════════════
// FUNDRAISING PRINT
// ══════════════════════════════════════════════════════
function openFundraisingPrint() {
  closeModal('printModal');
  const grpSel = document.getElementById('frp_group');
  if(grpSel) grpSel.innerHTML = '<option value="">\u05db\u05dc \u05d4\u05e7\u05d1\u05d5\u05e6\u05d5\u05ea</option>' + DB.groups.map(g=>`<option value="${g.id}">${g.name} (${g.code||''})</option>`).join('');
  const campSel = document.getElementById('frp_camp');
  if(campSel) campSel.innerHTML = '<option value="">\u05de\u05d2\u05d1\u05d9\u05ea \u05e4\u05e2\u05d9\u05dc\u05d4</option>' + DB.campaigns.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');
  openModal('frPrintModal');
}

function onFrpTypeChange() {
  const t = document.getElementById('frp_type')?.value||'group';
  ['frp_group_row','frp_city_row','frp_neigh_row'].forEach(id=>{document.getElementById(id).style.display='none';});
  if(t==='group') document.getElementById('frp_group_row').style.display='';
  else if(t==='city') document.getElementById('frp_city_row').style.display='';
  else document.getElementById('frp_neigh_row').style.display='';
}

function getFrpDonors(t) {
  if(t==='group') {
    const grpId = document.getElementById('frp_group')?.value||'';
    if(!grpId) return DB.donors;
    const grp = DB.groups.find(g=>g.id===grpId);
    return (grp?.donorIds||[]).map(id=>DB.donors.find(d=>d.id===id)).filter(Boolean);
  }
  if(t==='city') {
    const city = (document.getElementById('frp_city')?.value||'').toLowerCase().trim();
    return city ? DB.donors.filter(d=>(d.address||'').toLowerCase().includes(city)) : DB.donors;
  }
  const neigh = (document.getElementById('frp_neigh')?.value||'').toLowerCase().trim();
  return neigh ? DB.donors.filter(d=>(d.address||'').toLowerCase().includes(neigh)) : DB.donors;
}

function previewFrPrint() {
  const t = document.getElementById('frp_type')?.value||'group';
  const donors = getFrpDonors(t);
  const el = document.getElementById('frp_preview');
  if(el) el.textContent = `\u05d9\u05d5\u05d3\u05e4\u05e1\u05d5 ${donors.length} \u05ea\u05d5\u05e8\u05de\u05d9\u05dd`;
}

function runFrPrint() {
  const t = document.getElementById('frp_type')?.value||'group';
  const campId = document.getElementById('frp_camp')?.value||'';
  const ac = campId ? DB.campaigns.find(c=>c.id===campId) : activeCampaign();
  const grpId = document.getElementById('frp_group')?.value||'';
  const grp = grpId ? DB.groups.find(g=>g.id===grpId) : null;
  const donors = getFrpDonors(t);
  const prev3 = [...DB.campaigns].sort((a,b)=>(b.year||'').localeCompare(a.year||'')).filter(c=>!c.active).slice(0,3);
  const members = grp ? (grp.memberIds||[]).map(id=>frNameById(id)).filter(Boolean) : [];
  const ORG = '\u05e2\u05d6\u05e8 \u05ea\u05d5\u05e8\u05d4 \u2013 \u05ea\u05d5\u05e9\u05d9\u05d4 \u05ea\u05e4\u05e8\u05d7';
  const mapCoords = donors.filter(d=>d.lat&&d.lng);
  const mapSection = mapCoords.length > 0
    ? `<div style="margin-top:16px"><h3 style="font-size:12px">\u05de\u05e4\u05ea \u05d0\u05d9\u05e1\u05d5\u05e3</h3><iframe src="https://maps.google.com/maps?q=${encodeURIComponent(mapCoords.slice(0,8).map(d=>d.address||'').join('|'))}&output=embed&z=14" width="100%" height="280" style="border:1px solid #ccc;border-radius:6px" loading="lazy"></iframe></div>` : '';

  const w = window.open('','_blank','width=1000,height=700');
  w.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8"><title>\u05d2\u05d9\u05dc\u05d9\u05d5\u05df \u05d4\u05ea\u05e8\u05de\u05d4</title><style>body{font-family:Arial,sans-serif;margin:25px 30px;color:#1a2744;direction:rtl;font-size:11px}.org{font-size:20px;font-weight:900;border-bottom:3px solid #c9a84c;padding-bottom:5px;margin-bottom:4px}.sub{font-size:11px;color:#666;margin-bottom:10px}.mbrs{background:#f0f4ff;padding:6px 12px;border-radius:6px;font-size:10px;margin-bottom:10px}table{width:100%;border-collapse:collapse}th{background:#1a2744;color:white;padding:5px 8px;text-align:right;font-size:10px}td{padding:4px 8px;border-bottom:1px solid #eee;vertical-align:top}tr:nth-child(even) td{background:#f9f9f9}@media print{body{margin:12px}td{max-height:none;word-break:break-word;overflow-wrap:break-word}}</style></head><body>`);
  w.document.write(`<div class="org">${ORG}</div>`);
  w.document.write(`<div class="sub">${ac?ac.name+' '+(ac.year||''):''} ${grp?'| \u05e7\u05d1\u05d5\u05e6\u05d4: '+grp.name+' ('+grp.code+')':''} | ${donors.length} \u05ea\u05d5\u05e8\u05de\u05d9\u05dd</div>`);
  if(members.length) w.document.write(`<div class="mbrs">\u05d7\u05d1\u05e8\u05d9 \u05d4\u05e7\u05d1\u05d5\u05e6\u05d4: ${members.join(' | ')}</div>`);
  w.document.write('<table><thead><tr><th>\u05e9\u05dd</th><th>\u05db\u05ea\u05d5\u05d1\u05ea</th><th>\u05d8\u05dc\u05e4\u05d5\u05df</th><th>\u05d4\u05e2\u05e8\u05d5\u05ea</th><th>\u05ea\u05e8\u05d5\u05de\u05d4 \u05d2\u05d1\u05d5\u05d4\u05d4</th>'+prev3.map(c=>`<th>${c.name}</th>`).join('')+'</tr></thead><tbody>');
  donors.forEach(d => {
    const dons=d.donations||[];
    const maxDon=Math.max(0,...dons.map(dn=>parseFloat(dn.amount||0)));
    const prev3Tots=prev3.map(c=>dons.filter(dn=>dn.campaignId===c.id).reduce((s,dn)=>s+parseFloat(dn.amount||0),0));
    const tel=[d.phone,d.mobile].filter(Boolean).join(' | ');
    w.document.write(`<tr><td>${d.title||''} ${donorName(d)}</td><td>${d.address||''}</td><td>${tel}</td><td>${d.notes||''}</td><td style="text-align:center;font-weight:700">${maxDon>0?'\u20aa'+maxDon.toLocaleString():''}</td>${prev3Tots.map(p=>`<td style="text-align:center">${p>0?'\u20aa'+p.toLocaleString():''}</td>`).join('')}</tr>`);
  });
  w.document.write('</tbody></table>'+mapSection+'<div style="margin-top:10px;font-size:9px;color:#aaa">\u05d4\u05d5\u05d3\u05e4\u05e1: '+new Date().toLocaleDateString('he-IL')+'</div><script>window.onload=()=>window.print();<\/script></body></html>');
  w.document.close();
  closeModal('frPrintModal');
}

function printGroupsOverview() {
  closeModal('printModal');
  const ac = activeCampaign();
  const ORG = '\u05e2\u05d6\u05e8 \u05ea\u05d5\u05e8\u05d4 \u2013 \u05ea\u05d5\u05e9\u05d9\u05d4 \u05ea\u05e4\u05e8\u05d7';
  const w = window.open('','_blank');
  w.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8"><title>\u05e7\u05d1\u05d5\u05e6\u05d5\u05ea</title><style>body{font-family:Arial,sans-serif;margin:25px;direction:rtl;font-size:12px}table{width:100%;border-collapse:collapse}th{background:#1a2744;color:white;padding:6px 10px;text-align:right}td{padding:5px 10px;border-bottom:1px solid #eee}tr:nth-child(even) td{background:#f9f9f9}@media print{body{margin:12px}td{max-height:none;word-break:break-word;overflow-wrap:break-word}}</style></head><body>`);
  w.document.write(`<h2 style="color:#1a2744">${ORG}</h2><p style="color:#666">${ac?ac.name+' '+(ac.year||''):''} | ${DB.groups.length} \u05e7\u05d1\u05d5\u05e6\u05d5\u05ea</p>`);
  w.document.write('<table><thead><tr><th>\u05e7\u05d5\u05d3</th><th>\u05e9\u05dd</th><th>\u05d5\u05d5\u05e2\u05d3</th><th>\u05d7\u05d1\u05e8\u05d9\u05dd</th><th>\u05d2\u05d9\u05d5\u05e1</th><th>\u05d9\u05e2\u05d3</th></tr></thead><tbody>');
  DB.groups.forEach(g => {
    const members=(g.memberIds||[]).map(id=>frNameById(id)).filter(Boolean);
    const raised=grpRaisedCamp(g,ac?.id);
    w.document.write(`<tr><td>${g.code||'\u2014'}</td><td>${g.name}</td><td>${g.vaad||''}</td><td>${members.join(', ')}</td><td style="text-align:center">${raised>0?'\u20aa'+raised.toLocaleString():''}</td><td style="text-align:center">${g.target?'\u20aa'+parseFloat(g.target).toLocaleString():''}</td></tr>`);
  });
  w.document.write('</tbody></table><script>window.onload=()=>window.print();<\/script></body></html>');
  w.document.close();
}

function printCampaignSummary() {
  closeModal('printModal');
  const ac = activeCampaign(); if(!ac){alert('\u05d0\u05d9\u05df \u05de\u05d2\u05d1\u05d9\u05ea \u05e4\u05e2\u05d9\u05dc\u05d4');return;}
  const tot = DB.donors.reduce((s,d)=>s+(d.donations||[]).filter(dn=>dn.campaignId===ac.id).reduce((ss,dn)=>ss+parseFloat(dn.amount||0),0),0);
  const target = parseFloat(ac.target||0);
  const pct = target>0?Math.round(tot/target*100):0;
  const ORG = '\u05e2\u05d6\u05e8 \u05ea\u05d5\u05e8\u05d4 \u2013 \u05ea\u05d5\u05e9\u05d9\u05d4 \u05ea\u05e4\u05e8\u05d7';
  const w = window.open('','_blank');
  w.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8"><title>\u05e1\u05d9\u05db\u05d5\u05dd</title><style>body{font-family:Arial,sans-serif;margin:40px;direction:rtl;text-align:center}.bar-bg{background:#eee;border-radius:8px;height:30px;margin:12px auto;max-width:450px}.bar-fg{background:#c9a84c;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#1a2744;font-weight:700}@media print{body{margin:20px}tr{page-break-inside:avoid}td{white-space:normal!important;line-height:1.35;max-height:calc(3 * 1.35em);overflow:hidden}}</style></head><body>`);
  w.document.write(`<h1 style="color:#1a2744">${ORG}</h1><h2 style="color:#555">${ac.name} ${ac.year||''}</h2><div style="font-size:48px;font-weight:900;color:#1a2744">\u20aa${Math.round(tot).toLocaleString()}</div><div style="font-size:18px;color:#666">\u05de\u05ea\u05d5\u05da \u05d9\u05e2\u05d3 \u20aa${Math.round(target).toLocaleString()}</div><div class="bar-bg"><div class="bar-fg" style="width:${Math.min(pct,100)}%">${pct}%</div></div>`);
  w.document.write('<script>window.onload=()=>window.print();<\/script></body></html>');
  w.document.close();
}


// ══ SIDEBAR ══
let _sidebarCollapsed = localStorage.getItem('sidebarCollapsed') === '1';
function initSidebar() {
  if(_sidebarCollapsed) {
    document.getElementById('sidebar')?.classList.add('collapsed');
    document.getElementById('mainContent')?.classList.add('expanded');
  }
  // Set user info
  const u = getCurrentUser();
  if(u) {
    const n = document.getElementById('sbUserName');
    const r = document.getElementById('sbUserRole');
    if(n) n.textContent = u.name || u.username || '';
    if(r) r.textContent = u.role === 'admin' ? 'מנהל' : u.role === 'edit' ? 'עריכה' : 'צפייה';
  }
}
function toggleSidebar() {
  _sidebarCollapsed = !_sidebarCollapsed;
  localStorage.setItem('sidebarCollapsed', _sidebarCollapsed ? '1' : '0');
  document.getElementById('sidebar')?.classList.toggle('collapsed', _sidebarCollapsed);
  document.getElementById('mainContent')?.classList.toggle('expanded', _sidebarCollapsed);
}
function setSidebarActive(page) {
  document.querySelectorAll('.sb-item').forEach(el => el.classList.remove('active'));
  const btn = document.getElementById('sb-' + page);
  if(btn) btn.classList.add('active');
}


// ══ CLOUD STATUS CHECK ══
async function checkCloudStatus() {
  const el = document.getElementById('cloudSyncInfo');
  if(el) el.textContent = 'בודק חיבור...';
  try {
    const { data, error } = await _sb.from('app_state').select('updated_at').eq('id','main').maybeSingle();
    if(error && error.code !== 'PGRST116') throw error;
    const msg = data
      ? '✅ מחובר לענן | עדכון אחרון: ' + new Date(data.updated_at).toLocaleString('he-IL')
      : '✅ מחובר לענן | אין נתונים בשרת עדיין';
    if(el) el.textContent = msg;
    _showSyncStatus('ok');
  } catch(e) {
    if(el) el.textContent = '❌ לא מחובר: ' + e.message;
    _showSyncStatus('offline');
  }
}

// ══════════════════════════════════════
// EXPORT WIZARD
// ══════════════════════════════════════
function openExportWizard() {
  const affilSel = document.getElementById('ex_affil');
  const S = getSettings();
  affilSel.innerHTML = '<option value="">הכל</option>' + (S.affiliations||[]).map(v=>`<option>${v}</option>`).join('');
  const campSel = document.getElementById('ex_camp');
  campSel.innerHTML = '<option value="">הכל</option>' + DB.campaigns.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');
  document.getElementById('ex_preview').textContent = 'לחץ על תצוגה מקדימה לפני הייצוא';
  openModal('exportWizard');
}
function getExportFilteredRows() {
  const affil = document.getElementById('ex_affil')?.value||'';
  const campId = document.getElementById('ex_camp')?.value||'';
  const minTotal = parseFloat(document.getElementById('ex_minTotal')?.value||0)||0;
  const minCamp = parseFloat(document.getElementById('ex_minCamp')?.value||0)||0;
  const from = document.getElementById('ex_from')?.value||'';
  const to = document.getElementById('ex_to')?.value||'';
  return DB.donors.filter(d => {
    if (affil && d.affil !== affil) return false;
    const tot = (d.donations||[]).reduce((s,dn)=>s+parseFloat(dn.amount||0),0);
    if (tot < minTotal) return false;
    if (campId) {
      const campTot = (d.donations||[]).filter(dn=>dn.campaignId===campId).reduce((s,dn)=>s+parseFloat(dn.amount||0),0);
      if (campTot < minCamp) return false;
    }
    if (from || to) {
      const hasDon = (d.donations||[]).some(dn=>(!from||dn.date>=from)&&(!to||dn.date<=to));
      if (!hasDon) return false;
    }
    return true;
  });
}
function previewExport() {
  const rows = getExportFilteredRows();
  document.getElementById('ex_preview').innerHTML = `<strong>נמצאו ${rows.length} תורמים תואמים</strong> — ${rows.slice(0,5).map(d=>donorName(d)).join(', ')}${rows.length>5?'...':''}`;
}
function runExportWizard() {
  const rows = getExportFilteredRows();
  if (!rows.length) { alert('לא נמצאו תורמים תואמים'); return; }
  const cols = Array.from(document.querySelectorAll('#ex_cols input:checked')).map(el=>el.value);
  const colFns = {
    'קוד': d=>d.code||'', 'שם': d=>donorName(d), 'שיוך': d=>d.affil||'',
    'כתובת': d=>d.address||'', 'טלפון': d=>d.phone||'', 'סלולרי': d=>d.mobile||'',
    'מייל': d=>d.email||'', 'מועד תרמה': d=>d.prefTime||'',
    'סך תרומות': d=>(d.donations||[]).reduce((s,dn)=>s+parseFloat(dn.amount||0),0),
    'תרומה גבוהה': d=>Math.max(0,...(d.donations||[]).map(dn=>parseFloat(dn.amount||0))),
    'מספר תרומות': d=>(d.donations||[]).length, 'הערות': d=>d.notes||'',
  };
  const ws_data = [cols, ...rows.map(d=>cols.map(c=>colFns[c]?colFns[c](d):''))];
  const ws = XLSX.utils.aoa_to_sheet(ws_data);
  const wb = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb, ws, 'ייצוא');
  XLSX.writeFile(wb, 'export_'+today()+'.xlsx');
  closeModal('exportWizard');
}
// Export currently shown/filtered donors table
function exportFiltered() {
  if (!can('admin')) { alert('אין הרשאה'); return; }
  const rows = filteredRows && filteredRows.length ? filteredRows : DB.donors;
  const ws_data = [['קוד','שם','שיוך','כתובת','טלפון','סלולרי','מייל','הערות','סך תרומות','תרומה גבוהה'],
    ...rows.map(d=>[d.code||'',donorName(d),d.affil||'',d.address||'',d.phone||'',d.mobile||'',d.email||'',d.notes||'',
      (d.donations||[]).reduce((s,dn)=>s+parseFloat(dn.amount||0),0),
      Math.max(0,...(d.donations||[]).map(dn=>parseFloat(dn.amount||0)))
    ])
  ];
  const ws = XLSX.utils.aoa_to_sheet(ws_data); const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'תורמים');
  XLSX.writeFile(wb, 'donors_filtered_'+today()+'.xlsx');
}

// ── FR raised = direct donations + proportional group-share ──
// Direct: donation.fundraiserId === frId → full amount to that FR
// Group: donation.groupId === grp.id → amount DIVIDED equally among group members
function frRaisedTotal(frId, campId) {
  let tot = 0;
  // 1. Direct donations linked to this fundraiser
  DB.donors.forEach(d => (d.donations||[]).forEach(dn => {
    if (dn.fundraiserId === frId && (!campId || dn.campaignId === campId))
      tot += parseFloat(dn.amount||0);
  }));
  // 2. Group-share: this FR gets amount/memberCount per group donation
  DB.groups.forEach(grp => {
    if (!(grp.memberIds||[]).includes(frId)) return;
    const memberCount = grp.memberIds.length;
    if (!memberCount) return;
    DB.donors.forEach(d => (d.donations||[]).forEach(dn => {
      if (dn.groupId === grp.id && (!campId || dn.campaignId === campId))
        tot += parseFloat(dn.amount||0) / memberCount; // e.g. 100₪ / 4 members = 25₪ each
    }));
  });
  return Math.round(tot * 100) / 100;
}

// Total raised BY a group = sum of all donations where groupId===grp.id (not divided)
function grpRaisedByGroupId(grpId, campId) {
  let tot = 0;
  DB.donors.forEach(d => (d.donations||[]).forEach(dn => {
    if (dn.groupId === grpId && (!campId || dn.campaignId === campId))
      tot += parseFloat(dn.amount||0);
  }));
  return tot;
}
// Override grpRaisedCamp to use direct group donations only
function grpRaisedCamp(grp, campId) {
  return grpRaisedByGroupId(grp.id, campId);
}

function frRaised(frId, campId) {
  let tot = 0;
  DB.donors.forEach(d => (d.donations||[]).forEach(dn => {
    if (dn.fundraiserId === frId && (!campId || dn.campaignId === campId))
      tot += parseFloat(dn.amount||0);
  }));
  return tot;
}

// ── How much a group raised (via member fundraisers OR direct group attribution) ──
function grpRaised(grp, campId) {
  let tot = 0;
  // Count donations directly attributed to this group
  DB.donors.forEach(d => (d.donations||[]).forEach(dn => {
    if (dn.groupId === grp.id && (!campId || dn.campaignId === campId))
      tot += parseFloat(dn.amount||0);
  }));
  return tot;
}

// frRaised: count donations attributed to a specific fundraiser (not via group)


// ── Render FR list table ──
function renderFRPage() {
  renderFRList();
  // Populate vaad filter
  const vaadSel = document.getElementById('frVaad');
  if (vaadSel) {
    const vaads = [...new Set(DB.fundraisers.map(f => f.vaad).filter(Boolean))].sort();
    vaadSel.innerHTML = '<option value="">כל הוועדים</option>' + vaads.map(v=>`<option>${v}</option>`).join('');
  }
  if (!can('edit')) {
    const btns = document.getElementById('frBtns');
    if (btns) btns.style.display = 'none';
  }
}

function renderFRList() {
  const q = (document.getElementById('frSearch')?.value||'').trim().toLowerCase();
  const vaad = document.getElementById('frVaad')?.value||'';
  const ac = activeCampaign();

  let rows = DB.fundraisers.filter(f => {
    const nm = ((f.firstName||'') + ' ' + (f.lastName||'')).toLowerCase();
    return (!q || nm.includes(q) || (f.code||'').toLowerCase().includes(q) || (f.groupCode||'').includes(q))
      && (!vaad || f.vaad === vaad);
  });

  rows.sort((a,b) => {
    let av, bv;
    if (frSortCol === 'name') { av = (a.firstName||'')+(a.lastName||''); bv = (b.firstName||'')+(b.lastName||''); }
    else if (frSortCol === 'raised') { av = frRaised(a.id, ac?.id); bv = frRaised(b.id, ac?.id); }
    else if (frSortCol === 'target') { av = parseFloat(a.target||0); bv = parseFloat(b.target||0); }
    else { av = a[frSortCol]||''; bv = b[frSortCol]||''; }
    return av < bv ? -frSortDir : av > bv ? frSortDir : 0;
  });

  const lbl = document.getElementById('frCountLabel');
  if (lbl) lbl.textContent = rows.length + ' מתרימים';

  const body = document.getElementById('frListBody');
  if (!body) return;
  const ce = can('edit');
  body.innerHTML = rows.length === 0
    ? `<tr><td colspan="12" style="text-align:center;padding:28px;color:var(--muted)">אין מתרימים רשומים</td></tr>`
    : rows.map(f => {
        const raised = frRaisedTotal(f.id, ac?.id);
        const target = parseFloat(f.target||0);
        const pct = target > 0 ? Math.min(raised/target*100, 100) : 0;
        const avail = f.availPhone === 'home' ? (f.homePhone||'') : (f.mobile||'');
        return `<tr onclick="openFRModal('${f.id}')">
          <td onclick="event.stopPropagation()" style="padding:6px"><input type="checkbox" class="fr-row-cb" data-id="${f.id}" onchange="updateFRBulkBar()"></td>
          <td><strong>${f.code||''}</strong></td>
          <td>${(f.firstName||'')} ${(f.lastName||'')}</td>
          <td>${f.vaad||''}</td>
          <td>${f.groupCode||''}</td>
          <td style="font-size:11px">${f.homePhone||''}</td>
          <td style="font-size:11px">${f.mobile||''}</td>
          <td style="font-size:11px;font-weight:600">${avail}</td>
          <td>${target > 0 ? '₪'+target.toLocaleString() : ''}</td>
          <td><strong style="color:var(--success)">₪${raised.toLocaleString()}</strong></td>
          <td style="min-width:100px">
            ${target > 0 ? `<div class="progress-bar" style="height:8px;margin:0"><div class="progress-fill" style="width:${pct}%"></div></div><span style="font-size:10px;color:var(--muted)">${Math.round(pct)}%</span>` : ''}
          </td>
          <td onclick="event.stopPropagation()"><div class="row-actions">
            ${ce ? `<button class="btn btn-danger btn-sm" onclick="deleteFRById('${f.id}')">🗑️</button>` : ''}
          </div></td>
        </tr>`;
      }).join('');
}

function sortFRL(col) {
  if (frSortCol === col) frSortDir *= -1; else { frSortCol = col; frSortDir = 1; }
  renderFRList();
}

function toggleSelectAllFR(cb) {
  document.querySelectorAll('.fr-row-cb').forEach(c => c.checked = cb.checked);
  updateFRBulkBar();
}

function updateFRBulkBar() {
  const checked = document.querySelectorAll('.fr-row-cb:checked').length;
  const btn = document.getElementById('frBulkDeleteBtn');
  if (btn) btn.style.display = checked > 0 ? '' : 'none';
  const allCb = document.getElementById('selectAllFR');
  if (allCb) {
    const total = document.querySelectorAll('.fr-row-cb').length;
    allCb.indeterminate = checked > 0 && checked < total;
    allCb.checked = checked > 0 && checked === total;
  }
}

function deleteSelectedFR() {
  if (!can('admin')) { alert('אין הרשאה'); return; }
  const ids = Array.from(document.querySelectorAll('.fr-row-cb:checked')).map(el => el.dataset.id);
  if (!ids.length) return;
  if (!confirm(`האם למחוק ${ids.length} מתרימים? פעולה זו בלתי הפיכה!`)) return;
  DB.fundraisers = DB.fundraisers.filter(f => !ids.includes(f.id));
  saveDB();
  renderFRList();
  updateFRBulkBar();
  renderGlobalStats();
  toast(ids.length + ' מתרימים נמחקו');
}

// ── FR Modal ──
function openFRModal(id) {
  const isEdit = !!id;
  document.getElementById('frModalTitle').textContent = isEdit ? 'עריכת מתרים' : 'הוספת מתרים';
  document.getElementById('frDeleteBtn').style.display = isEdit ? '' : 'none';
  document.getElementById('fr_editId').value = id || '';
  if (isEdit) {
    const f = DB.fundraisers.find(x => x.id === id);
    if (!f) return;
    document.getElementById('fr_code').value = f.code||'';
    document.getElementById('fr_firstName').value = f.firstName||'';
    document.getElementById('fr_lastName').value = f.lastName||'';
    document.getElementById('fr_vaad').value = f.vaad||'';
    document.getElementById('fr_groupCode').value = f.groupCode||'';
    document.getElementById('fr_homePhone').value = f.homePhone||'';
    document.getElementById('fr_mobile').value = f.mobile||'';
    document.getElementById('fr_availPhone').value = f.availPhone||'mobile';
    document.getElementById('fr_target').value = f.target||'';
  } else {
    ['fr_firstName','fr_lastName','fr_groupCode','fr_homePhone','fr_mobile','fr_target'].forEach(id => document.getElementById(id).value = '');
    document.getElementById('fr_vaad').value = '';
    document.getElementById('fr_availPhone').value = 'mobile';
    document.getElementById('fr_code').value = genFRCode(); saveDB();
  }
  openModal('frModal');
}

function saveFR() {
  const fn = document.getElementById('fr_firstName').value.trim();
  const ln = document.getElementById('fr_lastName').value.trim();
  if (!fn && !ln) { alert('יש להזין שם'); return; }
  const editId = document.getElementById('fr_editId').value;
  const obj = {
    id: editId || 'FR' + Date.now(),
    code: document.getElementById('fr_code').value,
    firstName: fn, lastName: ln,
    vaad: document.getElementById('fr_vaad').value,
    groupCode: document.getElementById('fr_groupCode').value.trim(),
    homePhone: document.getElementById('fr_homePhone').value.trim(),
    mobile: document.getElementById('fr_mobile').value.trim(),
    availPhone: document.getElementById('fr_availPhone').value,
    target: parseFloat(document.getElementById('fr_target').value)||0,
  };
  if (editId) {
    const idx = DB.fundraisers.findIndex(x => x.id === editId);
    if (idx >= 0) DB.fundraisers[idx] = obj;
  } else {
    DB.fundraisers.push(obj);
  }
  saveDB(); closeModal('frModal'); renderFRList();
  auditLog(editId ? 'edit' : 'create', `${editId?'עדכון':'הוספת'} מתרים: ${fn} ${ln}`);
  if (document.getElementById('pageDash').classList.contains('active')) renderDash();
}

function saveFRandNew() {
  const fn = document.getElementById('fr_firstName').value.trim();
  const ln = document.getElementById('fr_lastName').value.trim();
  if (!fn && !ln) { alert('יש להזין שם'); return; }
  const editId = document.getElementById('fr_editId').value;
  const obj = {
    id: editId || 'FR' + Date.now(),
    code: document.getElementById('fr_code').value,
    firstName: fn, lastName: ln,
    vaad: document.getElementById('fr_vaad').value,
    groupCode: document.getElementById('fr_groupCode').value.trim(),
    homePhone: document.getElementById('fr_homePhone').value.trim(),
    mobile: document.getElementById('fr_mobile').value.trim(),
    availPhone: document.getElementById('fr_availPhone').value,
    target: parseFloat(document.getElementById('fr_target').value)||0,
  };
  if (editId) {
    const idx = DB.fundraisers.findIndex(x => x.id === editId);
    if (idx >= 0) DB.fundraisers[idx] = obj;
  } else {
    DB.fundraisers.push(obj);
  }
  saveDB(); renderFRList();
  // Reset for new
  document.getElementById('fr_editId').value = '';
  document.getElementById('frModalTitle').textContent = 'הוספת מתרים';
  document.getElementById('frDeleteBtn').style.display = 'none';
  ['fr_firstName','fr_lastName','fr_groupCode','fr_homePhone','fr_mobile','fr_target'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('fr_vaad').value = '';
  document.getElementById('fr_availPhone').value = 'mobile';
  document.getElementById('fr_code').value = genFRCode(); saveDB();
  setTimeout(()=>document.getElementById('fr_firstName').focus(),50);
}

function deleteFR() {
  const id = document.getElementById('fr_editId').value;
  if (!confirm('למחוק מתרים זה?')) return;
  deleteFRById(id);
  closeModal('frModal');
}

function deleteFRById(id) {
  const f = DB.fundraisers.find(x => x.id === id);
  const snapshot = JSON.parse(JSON.stringify(DB.fundraisers));
  DB.fundraisers = DB.fundraisers.filter(x => x.id !== id);
  // Remove from groups
  DB.groups.forEach(g => { g.memberIds = (g.memberIds||[]).filter(x => x !== id); });
  auditLog('delete', `מחיקת מתרים: ${f ? (f.firstName+' '+f.lastName) : id}`, {type:'fundraisers',action:'delete',snapshot});
  saveDB(); renderFRList();
}

// ── Import FR from Excel ──

function showFRImportFormat() {
  const msg = `פורמט קובץ ייבוא מתרימים (Excel):\n\nעמודות נדרשות — שמות העמודות בכותרת הראשונה:\n\n` +
    `• קוד — קוד מתרים (אם ריק — ייווצר אוטומטי M0001+)\n` +
    `• שם פרטי — שדה חובה\n` +
    `• שם משפחה\n` +
    `• וועד / שיעור — למשל: וועד א, וועד ב...\n` +
    `• קוד קבוצה — 3 ספרות\n` +
    `• טלפון בית\n` +
    `• פלאפון / סלולרי\n` +
    `• יעד — סכום יעד אישי (מספר בלבד)\n\n` +
    `הערה: שורה ראשונה = כותרות בדיוק כפי שמוצג למעלה`;
  alert(msg);
}

function importFR(input) {
  if (!can('admin')) { alert('אין הרשאה'); return; }
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    const wb = XLSX.read(new Uint8Array(e.target.result), {type:'array'});
    const rows = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
    let added = 0, skipped = 0;
    rows.forEach(row => {
      let code = String(row['קוד']||row['קוד מתרים']||'').trim();
      if (!code) code = genFRCode();
      if (DB.fundraisers.find(f => f.code === code)) {
        const existing = DB.fundraisers.find(f => f.code === code);
        if (existing && existing.firstName===(row['שם פרטי']||'') && existing.lastName===(row['שם משפחה']||'')) { skipped++; return; }
        code = genFRCode();
        while (DB.fundraisers.find(f => f.code === code)) code = genFRCode();
      }
      DB.fundraisers.push({
        id: 'FR'+Date.now()+Math.random(),
        code, firstName: row['שם פרטי']||'', lastName: row['שם משפחה']||'',
        vaad: row['וועד']||row['שיעור']||'', groupCode: row['קוד קבוצה']||'',
        homePhone: row['טלפון בית']||'', mobile: row['פלאפון']||row['סלולרי']||'',
        availPhone: 'mobile', target: parseFloat(row['יעד']||0)||0,
      });
      added++;
    });
    saveDB(); renderFRList();
    let msg = 'יובאו ' + added + ' מתרימים';
    if (skipped > 0) msg += ` | ${skipped} כפולים דולגו`;
    toast(msg);
    input.value = '';
  };
  reader.readAsArrayBuffer(file);
}

// ── FR search in donation form ──
function searchFRinForm(searchId, resultsId, hiddenId) {
  const q = document.getElementById(searchId).value.trim().toLowerCase();
  const res = q ? DB.fundraisers.filter(f =>
    ((f.firstName||'')+(f.lastName||'')).toLowerCase().includes(q) ||
    (f.code||'').toLowerCase().includes(q)
  ).slice(0,8) : [];
  document.getElementById(resultsId).innerHTML = res.map(f =>
    `<div class="pick-item" onclick="pickFRinForm('${f.id}','${searchId}','${resultsId}','${hiddenId}')">
      ${f.firstName||''} ${f.lastName||''} <span style="font-size:10px;color:var(--muted)">${f.code||''} ${f.vaad?'| '+f.vaad:''}</span>
    </div>`
  ).join('') || (q ? '<p style="font-size:11px;color:var(--muted);padding:5px">לא נמצאו</p>' : '');
}
function pickFRinForm(frId, searchId, resultsId, hiddenId) {
  const f = DB.fundraisers.find(x => x.id === frId);
  document.getElementById(hiddenId).value = frId;
  document.getElementById(searchId).value = (f.firstName||'') + ' ' + (f.lastName||'');
  document.getElementById(resultsId).innerHTML = '';
}
function clearFRSel(searchId, resultsId, hiddenId) {
  document.getElementById(searchId).value = '';
  document.getElementById(resultsId).innerHTML = '';
  document.getElementById(hiddenId).value = '';
}

function grpNameById(id) {
  if (!id) return '';
  const g = DB.groups.find(x => x.id === id);
  return g ? g.name : '';
}

function toggleDonAssignType() {
  const t = document.getElementById('nd_don_type').value;
  document.getElementById('nd_fr_box').style.display = t==='fr' ? '' : 'none';
  document.getElementById('nd_grp_box').style.display = t==='group' ? '' : 'none';
}



function clearGrpSel() {
  document.getElementById('nd_grp_search').value = '';
  document.getElementById('nd_grp_results').innerHTML = '';
  document.getElementById('nd_grp_id').value = '';
  document.getElementById('nd_grp_info').textContent = '';
}

// ══════════════════════════════════════════════════════
// GROUPS (קבוצות מתרימים)
// ══════════════════════════════════════════════════════
function renderGroupsList() {
  const q = (document.getElementById('grpSearch')?.value||'').trim().toLowerCase();
  const ac = activeCampaign();
  const grps = DB.groups.filter(g => !q || g.name.toLowerCase().includes(q) || (g.code||'').includes(q));
  const container = document.getElementById('groupsListContainer');
  if (!container) return;
  if (grps.length === 0) { container.innerHTML = '<p style="color:var(--muted);padding:20px">אין קבוצות</p>'; return; }
  container.innerHTML = grps.map(g => {
    const raised = grpRaised(g, ac?.id);
    const target = parseFloat(g.target||0);
    const pct = target > 0 ? Math.min(raised/target*100, 100) : 0;
    const over = raised >= target && target > 0;
    const memberNames = (g.memberIds||[]).map(id => frNameById(id)).filter(Boolean);
    return `<div class="grp-card">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
        <div>
          <strong style="font-size:15px">${g.name}</strong>
          <span class="badge" style="background:var(--cream-d);color:var(--muted);margin-right:8px">${g.code||''}</span>
          ${g.vaad ? `<span class="badge" style="background:var(--teal-bg);color:var(--teal)">${g.vaad}</span>` : ''}
        </div>
        <div style="display:flex;gap:6px">
          ${can('edit') ? `<button class="btn btn-outline btn-sm" onclick="openGroupModal('${g.id}')">✏️ עריכה</button>` : ''}
          <button class="btn btn-outline btn-sm" onclick="printGroupReport('${g.id}')">🖨️ דוח</button>
          <button class="btn btn-gold btn-sm" onclick="printFundraisingSheet('${g.id}')">📋 גיליון</button>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:12px">
        <div style="background:var(--cream);border-radius:8px;padding:10px;text-align:center">
          <div style="font-size:18px;font-weight:700;font-family:'Frank Ruhl Libre',serif;color:var(--success)">₪${raised.toLocaleString()}</div>
          <div style="font-size:10px;color:var(--muted)">גייסה עד כה</div>
        </div>
        <div style="background:var(--cream);border-radius:8px;padding:10px;text-align:center">
          <div style="font-size:18px;font-weight:700;font-family:'Frank Ruhl Libre',serif">${target > 0 ? '₪'+target.toLocaleString() : '-'}</div>
          <div style="font-size:10px;color:var(--muted)">יעד קבוצתי</div>
        </div>
        <div style="background:var(--cream);border-radius:8px;padding:10px;text-align:center">
          <div style="font-size:18px;font-weight:700;font-family:'Frank Ruhl Libre',serif">${(g.memberIds||[]).length}</div>
          <div style="font-size:10px;color:var(--muted)">חברים</div>
        </div>
        <div style="background:var(--cream);border-radius:8px;padding:10px;text-align:center">
          <div style="font-size:18px;font-weight:700;font-family:'Frank Ruhl Libre',serif">${(g.donorIds||[]).length}</div>
          <div style="font-size:10px;color:var(--muted)">תורמים</div>
        </div>
      </div>
      ${target > 0 ? `
        <div class="progress-bar"><div class="progress-fill ${over?'over':''}" style="width:${pct}%"></div></div>
        <div style="font-size:11px;color:var(--muted);margin-top:3px">${Math.round(pct)}% מהיעד${over?' ✓':''}</div>` : ''}
      ${memberNames.length > 0 ? `<div style="margin-top:10px;font-size:12px;color:var(--muted)">👥 ${memberNames.join(' | ')}</div>` : ''}
      ${g.notes ? `<div style="font-size:12px;color:var(--muted);margin-top:4px">📝 ${g.notes}</div>` : ''}
    </div>`;
  }).join('');
}

// ── Group Modal ──
function openGroupModal(id) {
  const isEdit = !!id;
  document.getElementById('grpModalTitle').textContent = isEdit ? 'עריכת קבוצה' : 'קבוצה חדשה';
  document.getElementById('grpDeleteBtn').style.display = isEdit ? '' : 'none';
  document.getElementById('grp_editId').value = id || '';
  if (isEdit) {
    const g = DB.groups.find(x => x.id === id); if (!g) return;
    document.getElementById('grp_code').value = g.code||'';
    document.getElementById('grp_name').value = g.name||'';
    document.getElementById('grp_vaad').value = g.vaad||'';
    document.getElementById('grp_target').value = g.target||'';
    document.getElementById('grp_notes').value = g.notes||'';
    grpTempMembers = [...(g.memberIds||[])];
    grpTempDonors = [...(g.donorIds||[])];
  } else {
    ['grp_name','grp_target','grp_notes'].forEach(i => document.getElementById(i).value = '');
    document.getElementById('grp_vaad').value = '';
    const code = genGrpCode(''); saveDB();
    document.getElementById('grp_code').value = code;
    grpTempMembers = [];
    grpTempDonors = [];
  }
  document.getElementById('grp_member_search').value = '';
  document.getElementById('grp_member_results').innerHTML = '';
  document.getElementById('grp_donor_search').value = '';
  document.getElementById('grp_donor_results').innerHTML = '';
  renderGrpMembers();
  renderGrpDonors();
  openModal('groupModal');
}

function updateGrpCode() {
  const editId = document.getElementById('grp_editId').value;
  if (editId) return; // don't change code when editing
  const vaad = document.getElementById('grp_vaad').value;
  const code = genGrpCode(vaad); saveDB();
  document.getElementById('grp_code').value = code;
}

function renderGrpMembers() {
  document.getElementById('grpMemberCount').textContent = grpTempMembers.length;
  document.getElementById('grpMembersList').innerHTML = grpTempMembers.map(id => {
    const f = DB.fundraisers.find(x => x.id === id);
    if (!f) return '';
    return `<span style="background:var(--teal-bg);color:var(--teal);padding:3px 10px;border-radius:20px;font-size:12px;display:inline-flex;align-items:center;gap:5px">
      ${f.firstName||''} ${f.lastName||''} (${f.code||''})
      <button onclick="removeTempMember('${id}')" style="background:none;border:none;cursor:pointer;color:var(--teal);font-size:14px;line-height:1">✕</button>
    </span>`;
  }).join('');
}

function searchFRforGroup() {
  const q = document.getElementById('grp_member_search').value.trim().toLowerCase();
  const res = q ? DB.fundraisers.filter(f =>
    !grpTempMembers.includes(f.id) &&
    (((f.firstName||'')+(f.lastName||'')).toLowerCase().includes(q) || (f.code||'').includes(q))
  ).slice(0,8) : [];
  document.getElementById('grp_member_results').innerHTML = res.map(f =>
    `<div class="pick-item" onclick="addTempMember('${f.id}')">
      ${f.firstName||''} ${f.lastName||''} <span style="font-size:10px;color:var(--muted)">${f.code||''} ${f.vaad?'| '+f.vaad:''}</span>
    </div>`
  ).join('') || (q ? '<p style="font-size:11px;color:var(--muted);padding:5px">לא נמצאו</p>' : '');
}
function addTempMember(id) {
  if (!grpTempMembers.includes(id)) grpTempMembers.push(id);
  document.getElementById('grp_member_search').value = '';
  document.getElementById('grp_member_results').innerHTML = '';
  renderGrpMembers();
}
function removeTempMember(id) {
  grpTempMembers = grpTempMembers.filter(x => x !== id);
  renderGrpMembers();
}

function renderGrpDonors() {
  document.getElementById('grpDonorCount').textContent = grpTempDonors.length;
  document.getElementById('grpDonorsList').innerHTML = grpTempDonors.map(id => {
    const d = DB.donors.find(x => x.id === id);
    if (!d) return '';
    return `<span style="background:var(--gold-bg);color:#7a5c00;padding:3px 10px;border-radius:20px;font-size:12px;display:inline-flex;align-items:center;gap:5px">
      ${donorName(d)} (${d.code||''})
      <button onclick="removeTempDonor('${id}')" style="background:none;border:none;cursor:pointer;color:#7a5c00;font-size:14px;line-height:1">✕</button>
    </span>`;
  }).join('');
}
function searchDonorForGroup() {
  const q = document.getElementById('grp_donor_search').value.trim().toLowerCase();
  const res = q ? DB.donors.filter(d =>
    !grpTempDonors.includes(d.id) &&
    (donorName(d).toLowerCase().includes(q) || (d.code||'').toLowerCase().includes(q) || (d.address||'').toLowerCase().includes(q))
  ).slice(0,8) : [];
  document.getElementById('grp_donor_results').innerHTML = res.map(d =>
    `<div class="pick-item" onclick="addTempDonor('${d.id}')">
      ${donorName(d)} <span style="font-size:10px;color:var(--muted)">${d.code||''} ${d.address?'| '+d.address:''}</span>
    </div>`
  ).join('') || (q ? '<p style="font-size:11px;color:var(--muted);padding:5px">לא נמצאו</p>' : '');
}
function addTempDonor(id) {
  if (!grpTempDonors.includes(id)) grpTempDonors.push(id);
  document.getElementById('grp_donor_search').value = '';
  document.getElementById('grp_donor_results').innerHTML = '';
  renderGrpDonors();
}
function removeTempDonor(id) {
  grpTempDonors = grpTempDonors.filter(x => x !== id);
  renderGrpDonors();
}

function saveGroup() {
  const name = document.getElementById('grp_name').value.trim();
  if (!name) { alert('יש להזין שם קבוצה'); return; }
  const editId = document.getElementById('grp_editId').value;
  const obj = {
    id: editId || 'G'+Date.now(),
    code: document.getElementById('grp_code').value,
    name, vaad: document.getElementById('grp_vaad').value,
    target: parseFloat(document.getElementById('grp_target').value)||0,
    notes: document.getElementById('grp_notes').value.trim(),
    memberIds: [...grpTempMembers],
    donorIds: [...grpTempDonors],
  };
  if (editId) { const idx = DB.groups.findIndex(x => x.id === editId); if (idx >= 0) DB.groups[idx] = obj; }
  else DB.groups.push(obj);
  saveDB(); closeModal('groupModal'); renderGroupsList();
}

function deleteGroup() {
  const id = document.getElementById('grp_editId').value;
  if (!confirm('למחוק קבוצה זו?')) return;
  DB.groups = DB.groups.filter(x => x.id !== id);
  saveDB(); closeModal('groupModal'); renderGroupsList();
}




// ── Dynamic select with "Add new" option ──
// Converts a <select> to support inline adding of new options
function makeSelectAddable(selId, settingsKey, addBlank) {
  const S = getSettings();
  const keyMap = {
    title:'titles', titles:'titles',
    affiliations:'affiliations', affil:'affiliations',
    closings:'closingNames', closingName:'closingNames',
    prefTimes:'prefTimes', prefTime:'prefTimes',
    methods:'payMethods', method:'payMethods',
    relTypes:'relTypes', relType:'relTypes',
    vaads:'vaads', vaad:'vaads'
  };
  const sk = keyMap[settingsKey] || settingsKey;
  const vals = S[sk] || [];
  const el = document.getElementById(selId);
  if (!el) return;
  const curVal = el.value;
  el.innerHTML = (addBlank ? '<option value="">-</option>' : '') +
    vals.map(v => `<option value="${v}"${v===curVal?' selected':''}>${v}</option>`).join('') +
    '<option value="__add__">➕ הוסף חדש...</option>';
  
  // Create or reuse the add-row beneath the select
  let addRow = document.getElementById('addrow_'+selId);
  if (!addRow) {
    addRow = document.createElement('div');
    addRow.id = 'addrow_'+selId;
    addRow.className = 'add-opt-row';
    addRow.innerHTML = `<input type="text" class="form-control" placeholder="ערך חדש..." style="font-size:12px" id="addinput_${selId}">
      <button class="btn btn-navy btn-sm" onclick="confirmAddOpt('${selId}','${sk}')">✓</button>
      <button class="btn btn-outline btn-sm" onclick="cancelAddOpt('${selId}')">✕</button>`;
    el.parentNode.insertBefore(addRow, el.nextSibling);
    document.getElementById('addinput_'+selId).addEventListener('keydown', ev => {
      if(ev.key==='Enter') confirmAddOpt(selId, sk);
      if(ev.key==='Escape') cancelAddOpt(selId);
    });
  }
  
  el.onchange = function() {
    if (this.value === '__add__') {
      this.value = curVal || '';
      addRow.classList.add('visible');
      document.getElementById('addinput_'+selId)?.focus();
    }
  };
}

function confirmAddOpt(selId, settingsKey) {
  const inp = document.getElementById('addinput_'+selId);
  const val = inp?.value?.trim();
  if (!val) { inp?.focus(); return; }
  const S = getSettings();
  if (!S[settingsKey]) S[settingsKey] = [];
  if (!S[settingsKey].includes(val)) S[settingsKey].push(val);
  DB.settings = S;
  saveDB();
  // Re-build select with new value selected
  const el = document.getElementById(selId);
  if (el) {
    makeSelectAddable(selId, settingsKey, el.options[0]?.value==='');
    el.value = val;
  }
  cancelAddOpt(selId);
}

function cancelAddOpt(selId) {
  const row = document.getElementById('addrow_'+selId);
  if (row) { row.classList.remove('visible'); }
  const inp = document.getElementById('addinput_'+selId);
  if (inp) inp.value = '';
}

// Call this when opening donor modal / donation form to wire up all selects
function initSelectsAddable() {
  const pairs = [
    ['f_title','titles'], ['f_affil','affiliations'], ['f_closingName','closings'],
    ['f_prefTime','prefTimes'], ['f_relType','relTypes'],
    ['nd_method','methods'], ['qd_method','methods'],
  ];
  pairs.forEach(([id, key]) => {
    if (document.getElementById(id)) makeSelectAddable(id, key, true);
  });
}


// ── FR Donations view ──
function renderFRDonations() {
  const campEl = document.getElementById('frDonCamp');
  if(campEl && campEl.options.length <= 1) {
    DB.campaigns.forEach(c => {
      const o = document.createElement('option');
      o.value = c.id; o.textContent = c.name + (c.year ? ' ' + c.year : '');
      campEl.appendChild(o);
    });
  }
  const campId = campEl?.value || '';
  const q = (document.getElementById('frDonSearch')?.value || '').toLowerCase().trim();
  const ac = campId ? DB.campaigns.find(c=>c.id===campId) : activeCampaign();

  const rows = DB.fundraisers.filter(fr => {
    if (!q) return true;
    return (fr.firstName||'').toLowerCase().includes(q) ||
           (fr.lastName||'').toLowerCase().includes(q) ||
           (fr.code||'').toLowerCase().includes(q);
  }).map(fr => {
    const campFilter = ac ? ac.id : null;
    const direct = DB.donors.reduce((s,d) =>
      s + (d.donations||[]).filter(dn => dn.fundraiserId === fr.id && (!campFilter || dn.campaignId === campFilter))
        .reduce((ss,dn) => ss + parseFloat(dn.amount||0), 0), 0);
    const groupShare = DB.groups
      .filter(g => (g.memberIds||[]).includes(fr.id))
      .reduce((s, grp) => {
        const mc = grp.memberIds.length;
        return s + DB.donors.reduce((ss,d) =>
          ss + (d.donations||[]).filter(dn => dn.groupId === grp.id && (!campFilter || dn.campaignId === campFilter))
            .reduce((sss,dn) => sss + parseFloat(dn.amount||0)/mc, 0), 0);
      }, 0);
    const total = direct + groupShare;
    const grp = DB.groups.find(g => (g.memberIds||[]).includes(fr.id));
    return { fr, direct, groupShare, total, grp, target: parseFloat(fr.target||0) };
  });

  const body = document.getElementById('frDonBody');
  if (!body) return;
  const cnt = document.getElementById('frDonCount');
  if(cnt) cnt.textContent = rows.length + ' מתרימים';

  body.innerHTML = rows.length === 0
    ? '<tr><td colspan="8" style="text-align:center;padding:24px;color:var(--muted)">אין נתונים</td></tr>'
    : rows.map(({fr, direct, groupShare, total, grp, target}) => {
        const pct = target > 0 ? Math.min(Math.round(total/target*100), 999) : 0;
        const pctColor = pct >= 100 ? 'var(--success)' : pct >= 70 ? 'var(--gold)' : 'var(--muted)';
        return `<tr>
          <td><strong>${fr.firstName||''} ${fr.lastName||''}</strong></td>
          <td style="font-size:12px;color:var(--muted)">${fr.code||''}</td>
          <td style="font-size:12px">${grp ? grp.name : '—'}</td>
          <td style="font-weight:700;color:var(--navy)">₪${Math.round(direct).toLocaleString()}</td>
          <td style="color:var(--teal,#0891b2)">₪${Math.round(groupShare).toLocaleString()}</td>
          <td style="font-weight:900;color:var(--success)">₪${Math.round(total).toLocaleString()}</td>
          <td style="color:var(--muted)">${target > 0 ? '₪'+Math.round(target).toLocaleString() : '—'}</td>
          <td><span style="font-weight:700;color:${pctColor}">${target>0?pct+'%':'—'}</span></td>
        </tr>`;
      }).join('');
}

// ── Group search for donation forms ──
function searchGroupInForm(prefix) {
  const q = (document.getElementById(prefix+'_search')?.value||'').toLowerCase().trim();
  const resultsEl = document.getElementById(prefix+'_results');
  if (!resultsEl) return;
  const matches = DB.groups.filter(g =>
    (g.name||'').toLowerCase().includes(q) ||
    (g.code||'').toLowerCase().includes(q) ||
    (g.vaad||'').toLowerCase().includes(q)
  ).slice(0, 8);
  resultsEl.innerHTML = matches.length
    ? matches.map(g => `<div class="pick-item" onclick="pickGroupInForm('${prefix}','${g.id}')">
        <strong>${g.name}</strong>
        <span style="float:left;font-size:10px;color:var(--muted)">${g.code||''} | ${g.memberIds?.length||0} חברים</span>
      </div>`).join('')
    : (q ? '<div style="padding:7px;font-size:12px;color:var(--muted)">לא נמצאה קבוצה</div>' : '');
  resultsEl.style.display = '';
}
function pickGroupInForm(prefix, grpId) {
  const grp = DB.groups.find(g=>g.id===grpId); if(!grp) return;
  document.getElementById(prefix+'_id').value = grpId;
  document.getElementById(prefix+'_search').value = grp.name + (grp.code?' ('+grp.code+')':'');
  document.getElementById(prefix+'_results').style.display = 'none';
  // Show info
  const info = document.getElementById(prefix+'_info');
  if (info) {
    const count = grp.memberIds?.length || 0;
    const names = (grp.memberIds||[]).map(id=>frNameById(id)).filter(Boolean);
    info.style.display = '';
    info.textContent = count > 0
      ? `התרומה תחולק ל-${count} חברים (כל אחד יקבל קרדיט של 1/${count}): ${names.join(', ')}`
      : 'אין חברים רשומים בקבוצה';
  }
}

// ══════════════════════════════════════
// BULK SELECT & DELETE
// ══════════════════════════════════════
function toggleSelectAll(cb) {
  const checked = cb.checked;
  document.querySelectorAll('.donor-row-cb').forEach(el => el.checked = checked);
  updateBulkBar();
}

function toggleSelectAllDonors(cb) {
  document.querySelectorAll('.donor-row-cb').forEach(c => c.checked = cb.checked);
  updateBulkBar();
}
function updateBulkBar() {
  const selected = document.querySelectorAll('.donor-row-cb:checked');
  const bar = document.getElementById('bulkActionBar');
  const cnt = document.getElementById('bulkCount');
  if (!bar) return;
  if (selected.length > 0) {
    bar.style.display = 'flex';
    cnt.textContent = selected.length + ' נבחרו';
  } else {
    bar.style.display = 'none';
  }
}
function clearAllSelections() {
  document.querySelectorAll('.donor-row-cb').forEach(el => el.checked = false);
  const cb = document.getElementById('selectAllDonors');
  if (cb) cb.checked = false;
  updateBulkBar();
}
function deleteSelectedDonors() {
  if (!can('admin')) { alert('אין הרשאה'); return; }
  const ids = Array.from(document.querySelectorAll('.donor-row-cb:checked')).map(el => el.dataset.id);
  if (!ids.length) return;
  if (!confirm(`האם למחוק ${ids.length} תורמים? פעולה זו בלתי הפיכה!`)) return;
  const snapshot = JSON.parse(JSON.stringify(DB.donors));
  DB.donors = DB.donors.filter(d => !ids.includes(d.id));
  auditLog('delete', `מחיקת ${ids.length} תורמים`, {type:'donors',action:'delete',snapshot});
  saveDB();
  renderDonorTable();
  clearAllSelections();
  renderGlobalStats();
  toast(ids.length + ' תורמים נמחקו');
}

function toast(msg) {
  let t = document.getElementById('toastMsg');
  if (!t) {
    t = document.createElement('div');
    t.id = 'toastMsg';
    t.style.cssText = 'position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#1a2744;color:white;padding:10px 20px;border-radius:20px;font-size:13px;z-index:9999;opacity:0;transition:opacity .3s';
    document.body.appendChild(t);
  }
  t.textContent = msg;
  t.style.opacity = '1';
  setTimeout(() => { t.style.opacity = '0'; }, 2500);
}


// ══════════════════════════════════════════════════════
// PENDING BUFFER — for new donors not yet saved
// ══════════════════════════════════════════════════════
let _pendingDonations = [];
let _pendingFuture = [];
let _pendingRelations = [];

function isNewDonor() {
  // Returns true when we're adding a brand new (unsaved) donor
  return !currentDonorId || currentDonorId === '__new__';
}

function flushPendingToNewDonor(donorId) {
  const d = DB.donors.find(x => x.id === donorId); if (!d) return;
  if (!d.donations) d.donations = [];
  if (!d.futureDonations) d.futureDonations = [];
  if (!d.relations) d.relations = [];
  _pendingDonations.forEach(obj => d.donations.push(obj));
  _pendingFuture.forEach(obj => d.futureDonations.push(obj));
  _pendingRelations.forEach(obj => d.relations.push(obj));
  _pendingDonations = [];
  _pendingFuture = [];
  _pendingRelations = [];
}


function confirmFutureDonation(donorId, futureIdx) {
  // Open donor card, switch to donations tab, pre-fill amount from future donation
  const d = DB.donors.find(x=>x.id===donorId); if(!d) return;
  const fd = (d.futureDonations||[])[futureIdx];
  currentDonorId = donorId;
  fillForm(d);
  switchDTab('donations');
  openModal('donorModal');
  setTimeout(() => {
    // Open the donation form pre-filled
    const box = document.getElementById('donationFormBox');
    if(box) box.style.display='';
    // Pre-fill amount and notes from the future donation
    if(fd) {
      const amtEl = document.getElementById('nd_amount');
      const notesEl = document.getElementById('nd_notes');
      const campEl = document.getElementById('nd_campaign');
      if(amtEl && fd.expectedAmount) amtEl.value = fd.expectedAmount;
      if(notesEl && fd.notes) notesEl.value = fd.notes;
      if(campEl && fd.campaignId) campEl.value = fd.campaignId;
      // Set today as date
      const dateEl = document.getElementById('nd_date');
      if(dateEl) dateEl.value = new Date().toISOString().split('T')[0];
    }
    // Mark that we should remove this future donation upon save
    window._confirmFutureDonorId = donorId;
    window._confirmFutureIdx = futureIdx;
    // Show info banner
    const banner = document.createElement('div');
    banner.id = 'futurConfirmBanner';
    banner.style.cssText = 'background:#d1fae5;border:1px solid #6ee7b7;color:#065f46;padding:8px 12px;border-radius:7px;font-size:12px;margin-bottom:8px';
    banner.innerHTML = '✅ <strong>אישור תרומה עתידית</strong> — לאחר שמירה התרומה העתידית תוסר אוטומטית';
    const fb = document.getElementById('donationFormBox');
    if(fb && !document.getElementById('futurConfirmBanner')) fb.prepend(banner);
  }, 150);
}

function renderPendingDonations() {
  const body = document.getElementById('donationsBody');
  if (!body) return;
  if (_pendingDonations.length === 0) {
    body.innerHTML = '<tr><td colspan="5" style="text-align:center;padding:20px;color:var(--muted);font-size:13px">אין תרומות עדיין</td></tr>';
    return;
  }
  body.innerHTML = _pendingDonations.map((dn,i) => `
    <tr>
      <td>${fmt(dn.date)}</td>
      <td style="font-size:11px">${toHeb(dn.date)}</td>
      <td><strong style="color:var(--success)">₪${parseFloat(dn.amount||0).toLocaleString()}</strong></td>
      <td>${dn.method||''}</td>
      <td><button class="btn btn-danger btn-sm" onclick="removePending('don',${i})">🗑️</button></td>
    </tr>`).join('');
}

function renderPendingFuture() {
  const body = document.getElementById('futureTabBody');
  if (!body) return;
  if (_pendingFuture.length === 0) {
    body.innerHTML = '<tr><td colspan="4" style="text-align:center;padding:20px;color:var(--muted);font-size:13px">אין תרומות עתידיות</td></tr>';
    return;
  }
  body.innerHTML = _pendingFuture.map((f,i) => `
    <tr>
      <td>${fmt(f.date)}</td>
      <td>${f.expectedAmount ? '₪'+parseFloat(f.expectedAmount).toLocaleString() : '—'}</td>
      <td>${f.notes||''}</td>
      <td><button class="btn btn-danger btn-sm" onclick="removePending('future',${i})">🗑️</button></td>
    </tr>`).join('');
}

function renderPendingRelations() {
  const body = document.getElementById('relTabBody');
  if (!body) return;
  if (_pendingRelations.length === 0) {
    body.innerHTML = '<tr><td colspan="3" style="text-align:center;padding:20px;color:var(--muted);font-size:13px">אין התאמות</td></tr>';
    return;
  }
  body.innerHTML = _pendingRelations.map((r,i) => {
    const other = DB.donors.find(x=>x.id===r.relId);
    return `<tr>
      <td>${other ? donorName(other) : r.relId}</td>
      <td>${r.relType||''}</td>
      <td><button class="btn btn-danger btn-sm" onclick="removePending('rel',${i})">🗑️</button></td>
    </tr>`;
  }).join('');
}

function removePending(type, idx) {
  if(type==='don') _pendingDonations.splice(idx,1);
  else if(type==='future') _pendingFuture.splice(idx,1);
  else if(type==='rel') _pendingRelations.splice(idx,1);
  if(type==='don') renderPendingDonations();
  else if(type==='future') renderPendingFuture();
  else renderPendingRelations();
}

function switchFRTab(tab) {
  ['list','groups','donations'].forEach(t=>{
    const btn = document.getElementById('frtab-'+t);
    if(btn) {
      const isActive = t===tab;
      btn.style.background = isActive ? 'var(--navy)' : 'white';
      btn.style.color = isActive ? 'white' : 'var(--text)';
      btn.style.borderColor = isActive ? 'var(--navy)' : 'var(--border)';
      const sub = btn.querySelector('div div:last-child');
      if(sub) sub.style.color = isActive ? 'rgba(255,255,255,.7)' : 'var(--muted)';
    }
    const c=document.getElementById('frcontent-'+t);
    if(c) c.style.display=t===tab?'':'none';
  });
  if(tab==='list') renderFRList();
  if(tab==='groups') renderGroups();
  if(tab==='donations') renderFRDonations();
}
// ── Donation attribution mode: FR vs Group ──
function toggleDonMode(prefix) {
  const isGrp = document.querySelector(`input[name="${prefix}_mode"]:checked`)?.value === 'grp';
  const frWrap = document.getElementById(prefix+'_fr_wrap');
  const grpWrap = document.getElementById(prefix+'_grp_wrap');
  if (frWrap) frWrap.style.display = isGrp ? 'none' : '';
  if (grpWrap) grpWrap.style.display = isGrp ? '' : 'none';
  if (isGrp) {
    // Populate group dropdown
    const sel = document.getElementById(prefix+'_grp_sel');
    if (sel) {
      sel.innerHTML = '<option value="">-- בחר קבוצה --</option>' +
        DB.groups.map(g => `<option value="${g.id}">${g.name} (${g.code||''}) — ${g.memberIds?.length||0} חברים</option>`).join('');
    }
  }
}
function updateGrpInfo(prefix) {
  const selId = prefix+'_grp_sel';
  const infoId = prefix+'_grp_info';
  const grpId = document.getElementById(selId)?.value;
  const grp = grpId ? DB.groups.find(g=>g.id===grpId) : null;
  const el = document.getElementById(infoId);
  if (!el) return;
  if (grp && grp.memberIds?.length) {
    const names = grp.memberIds.map(id=>frNameById(id)).filter(Boolean);
    el.textContent = `התרומה תחולק בין: ${names.join(' | ')} (${names.length} חברים)`;
    el.style.color = 'var(--teal)';
  } else {
    el.textContent = '';
  }
}
function getDonAttribution(prefix) {
  const mode = document.querySelector(`input[name="${prefix}_mode"]:checked`)?.value || 'fr';
  if (mode === 'grp') {
    return {
      fundraiserId: '',
      groupId: document.getElementById(prefix+'_grp_id')?.value || ''
    };
  }
  return {
    fundraiserId: document.getElementById(prefix+'_fr_id')?.value || '',
    groupId: ''
  };
}

function loadDemoIfEmpty(){
  if(DB.donors.length>0) return;
  // Add sample campaign
  DB.campaigns=[
    {id:'CAM1',name:'מגבית פורים תשפ"ה',year:'תשפ"ה',goal:150000,deadline:'2025-03-14',active:true,desc:'מגבית השנה'},
    {id:'CAM2',name:'מגבית פורים תשפ"ד',year:'תשפ"ד',goal:120000,deadline:'2024-03-24',active:false,desc:''},
  ];
  DB.donors=[
    {id:'D1',code:'T1001',title:'הרב',firstName:'משה',lastName:'לוי',closingName:'בברכה',affil:'בוגר',address:'הרצל 15, ירושלים',entrance:'כניסה א',phone:'02-5551234',mobile:'0521234567',email:'moshe@example.com',marriageYear:'1995',cohort:'מחזור כ',notes:'תורם ותיק',prefTime:'פורים בבית',createdAt:'2022-09-01T10:00:00',
      donations:[{amount:500,date:'2024-03-06',method:'מזומן',campaignId:'CAM2',notes:''},{amount:1000,date:'2025-03-13',method:'אשראי',campaignId:'CAM1',notes:'שנתי'}],
      futureDonations:[{date:'2026-03-02',expectedAmount:1500,campaignId:'CAM1',notes:'הוסכם בשיחה - מגדיל'},{date:'2025-09-15',expectedAmount:null,campaignId:'',notes:'לבדוק בראש השנה'}],
      relations:[]},
    {id:'D2',code:'T1002',title:'מר',firstName:'יעקב',lastName:'כהן',closingName:'בכבוד רב',affil:'הורה תלמיד',address:'בן גוריון 8, תל אביב',entrance:'קומה 4',phone:'03-6661234',mobile:'0501111222',email:'yaakov@example.com',marriageYear:'',cohort:'',notes:'',prefTime:'טלפוני לפני פורים',createdAt:'2023-01-15T10:00:00',
      donations:[{amount:2000,date:'2025-02-15',method:'העברה בנקאית',campaignId:'CAM1',notes:''}],
      futureDonations:[{date:'2026-02-20',expectedAmount:2500,campaignId:'CAM1',notes:'מעוניין להגדיל'}],
      relations:[{donorId:'D1',type:'שווער'}]},
    {id:'D3',code:'T1003',title:'ד"ר',firstName:'שרה',lastName:'גולדברג',closingName:'בהוקרה',affil:'מכר',address:'ביאליק 22, חיפה',entrance:'',phone:'04-8884321',mobile:'0523334445',email:'sarah@example.com',marriageYear:'2001',cohort:'',notes:'הכירה דרך ר. שמעון',prefTime:'טלפוני בפורים',createdAt:'2024-03-01T10:00:00',
      donations:[{amount:5000,date:'2025-03-10',method:"צ'ק",campaignId:'CAM1',notes:'שיק 123'}],
      futureDonations:[],relations:[]},
    {id:'D4',code:'T1004',title:'הרב',firstName:'אברהם',lastName:'גרינברג',closingName:'יישר כח',affil:'תלמיד',address:'מלכי ישראל 3, בני ברק',entrance:'',phone:'',mobile:'0524445566',email:'',marriageYear:'',cohort:'מחזור כה',notes:'',prefTime:'פורים בבית',createdAt:'2024-06-10T10:00:00',
      donations:[],
      futureDonations:[{date:'2026-03-02',expectedAmount:500,campaignId:'CAM1',notes:'ביקר בסוכות - הסכים לתרום'}],
      relations:[]},
  ];
  // Demo fundraisers
  if (!DB.fundraisers.length) {
    DB.nextFRCode = 1;
    DB.nextGrpSeq = {};
    DB.fundraisers = [
      {id:'FR1',code:'M0001',firstName:'דוד',lastName:'אלפסי',vaad:'וועד א',groupCode:'101',homePhone:'02-5551111',mobile:'0521111111',availPhone:'mobile',target:5000},
      {id:'FR2',code:'M0002',firstName:'יוסף',lastName:'ברגר',vaad:'וועד א',groupCode:'101',homePhone:'02-5552222',mobile:'0522222222',availPhone:'mobile',target:4000},
      {id:'FR3',code:'M0003',firstName:'אברהם',lastName:'גולד',vaad:'וועד ב',groupCode:'201',homePhone:'02-5553333',mobile:'0523333333',availPhone:'home',target:6000},
      {id:'FR4',code:'M0004',firstName:'יעקב',lastName:'דוידוב',vaad:'וועד ב',groupCode:'201',homePhone:'',mobile:'0524444444',availPhone:'mobile',target:3000},
      {id:'FR5',code:'M0005',firstName:'משה',lastName:'הלוי',vaad:'וועד ג',groupCode:'301',homePhone:'02-5555555',mobile:'0525555555',availPhone:'mobile',target:8000},
    ];
    DB.nextFRCode = 6;
    DB.groups = [
      {id:'G1',code:'101',name:'קבוצת אלפסי-ברגר',vaad:'וועד א',target:9000,notes:'קבוצה ותיקה',memberIds:['FR1','FR2'],donorIds:['D1','D2']},
      {id:'G2',code:'201',name:'קבוצת גולד-דוידוב',vaad:'וועד ב',target:9000,notes:'',memberIds:['FR3','FR4'],donorIds:['D3']},
      {id:'G3',code:'301',name:'קבוצת הלוי',vaad:'וועד ג',target:8000,notes:'',memberIds:['FR5'],donorIds:['D4']},
    ];
    // Assign fundraisers to demo donations
    if (DB.donors[0]?.donations[0]) DB.donors[0].donations[0].fundraiserId = 'FR1';
    if (DB.donors[0]?.donations[1]) DB.donors[0].donations[1].fundraiserId = 'FR2';
    if (DB.donors[1]?.donations[0]) DB.donors[1].donations[0].fundraiserId = 'FR3';
    if (DB.donors[2]?.donations[0]) DB.donors[2].donations[0].fundraiserId = 'FR5';
  }
  saveDB();
}

// ════════════════════════════════════════════════════
// AUDIT LOG
// ════════════════════════════════════════════════════
function auditLog(type, description, undoData) {
  if (!DB.auditLog) DB.auditLog = [];
  DB.auditLog.unshift({
    id: 'AL' + Date.now(),
    type, // create | edit | delete | import | export | print | login | logout
    description,
    user: currentUser ? (currentUser.displayName || currentUser.username) : 'מערכת',
    ts: new Date().toISOString(),
    undoData: undoData || null
  });
  // Keep max 500 entries
  if (DB.auditLog.length > 500) DB.auditLog = DB.auditLog.slice(0, 500);
  // ── Save audit log SEPARATELY to avoid bloating main DB ──
  _saveAuditLog();
  // Save main DB (without large undoData snapshots to keep size small)
  saveDB();
}

function _saveAuditLog() {
  // Save full audit log (with undoData) to its own localStorage key
  try {
    localStorage.setItem('donorAuditLog_v1', JSON.stringify(DB.auditLog));
  } catch(e) {
    // If localStorage is full, trim and retry
    if (DB.auditLog.length > 50) {
      DB.auditLog = DB.auditLog.slice(0, 50);
      try { localStorage.setItem('donorAuditLog_v1', JSON.stringify(DB.auditLog)); } catch(e2) {}
    }
  }
}

function _loadAuditLog() {
  // Load audit log from separate key (persists across version upgrades)
  try {
    const s = localStorage.getItem('donorAuditLog_v1');
    if (s) {
      const loaded = JSON.parse(s);
      // Merge: prefer entries not already in DB.auditLog
      if (!DB.auditLog || !DB.auditLog.length) {
        DB.auditLog = loaded;
      } else {
        // Merge by id, keeping most recent
        const existingIds = new Set(DB.auditLog.map(e => e.id));
        const merged = [...DB.auditLog];
        for (const e of loaded) {
          if (!existingIds.has(e.id)) merged.push(e);
        }
        DB.auditLog = merged.sort((a, b) => b.ts.localeCompare(a.ts)).slice(0, 500);
      }
    }
  } catch(e) {}
  if (!DB.auditLog) DB.auditLog = [];
}

function openAuditLog() {
  if (!can('admin')) { toast('אין הרשאה'); return; }
  renderAuditLog();
  openModal('auditModal');
}

function renderAuditLog() {
  if (!DB.auditLog || !DB.auditLog.length) {
    document.getElementById('auditBody').innerHTML = '<tr><td colspan="5" style="text-align:center;padding:24px;color:var(--muted)">אין רשומות בלוג</td></tr>';
    return;
  }
  // Populate user filter
  const userSel = document.getElementById('auditUser');
  if (userSel && userSel.children.length < 2) {
    [...new Set(DB.auditLog.map(x => x.user))].forEach(u => {
      const o = document.createElement('option'); o.value = u; o.textContent = u; userSel.appendChild(o);
    });
  }
  const q = document.getElementById('auditSearch')?.value.toLowerCase() || '';
  const filterUser = document.getElementById('auditUser')?.value || '';
  const filterType = document.getElementById('auditType')?.value || '';

  const typeLabels = { create:'✅ יצירה', edit:'✏️ עריכה', delete:'🗑️ מחיקה', import:'📥 ייבוא', export:'📤 ייצוא', print:'🖨️ הדפסה', login:'🔑 כניסה', logout:'↩ יציאה' };
  const typeBg = { create:'var(--success-bg)', edit:'var(--teal-bg)', delete:'var(--danger-bg)', import:'var(--purple-bg)', export:'var(--gold-bg)', print:'var(--cream-d)' };

  const rows = DB.auditLog.filter(e =>
    (!q || e.description.toLowerCase().includes(q) || e.user.toLowerCase().includes(q)) &&
    (!filterUser || e.user === filterUser) &&
    (!filterType || e.type === filterType)
  );

  document.getElementById('auditBody').innerHTML = rows.length === 0
    ? '<tr><td colspan="5" style="text-align:center;padding:20px;color:var(--muted)">לא נמצאו תוצאות</td></tr>'
    : rows.map(e => {
        const dt = new Date(e.ts);
        const dateStr = dt.toLocaleDateString('he-IL') + ' ' + dt.toLocaleTimeString('he-IL', {hour:'2-digit',minute:'2-digit'});
        const bg = typeBg[e.type] || 'transparent';
        return `<tr>
          <td style="font-size:12px;white-space:nowrap">${dateStr}</td>
          <td style="font-size:12px;font-weight:600">${e.user}</td>
          <td><span style="background:${bg};padding:2px 7px;border-radius:12px;font-size:11px;white-space:nowrap">${typeLabels[e.type]||e.type}</span></td>
          <td style="font-size:12px">${e.description}</td>
          <td>${e.undoData ? `<button class="btn btn-outline btn-sm" onclick="undoAuditEntry('${e.id}')">↩ שחזר</button>` : ''}</td>
        </tr>`;
      }).join('');
}

function undoAuditEntry(entryId) {
  const entry = (DB.auditLog||[]).find(e => e.id === entryId);
  if (!entry || !entry.undoData) { toast('אין מידע לשחזור'); return; }
  // Check if undoData was stripped (cloud version — reload from localStorage)
  if (entry.undoData._hasUndo && !entry.undoData.type) {
    // Try to restore from localStorage audit log
    try {
      const stored = JSON.parse(localStorage.getItem('donorAuditLog_v1') || '[]');
      const full = stored.find(e => e.id === entryId);
      if (full && full.undoData && full.undoData.type) {
        entry.undoData = full.undoData;
      } else {
        toast('לא ניתן לשחזר — הנתונים אינם זמינים בדפדפן זה'); return;
      }
    } catch(e) { toast('שגיאה בשחזור'); return; }
  }
  if (!confirm(`לשחזר: "${entry.description}"?`)) return;
  const ud = entry.undoData;
  if (ud.type === 'donors') {
    if (ud.action === 'delete') DB.donors = ud.snapshot;
    else if (ud.action === 'edit') { const idx = DB.donors.findIndex(d => d.id === ud.id); if(idx>=0) DB.donors[idx] = ud.snapshot; }
  } else if (ud.type === 'fundraisers') {
    if (ud.action === 'delete') DB.fundraisers = ud.snapshot;
    else if (ud.action === 'edit') { const idx = DB.fundraisers.findIndex(f => f.id === ud.id); if(idx>=0) DB.fundraisers[idx] = ud.snapshot; }
  } else if (ud.type === 'donation') {
    const d = DB.donors.find(x => x.id === ud.donorId);
    if (d && ud.action === 'delete') { if(!d.donations) d.donations=[]; d.donations.splice(ud.idx, 0, ud.snapshot); }
  }
  saveDB(); renderAll(); renderAuditLog();
  toast('✓ הפעולה שוחזרה');
  auditLog('edit', `שחזור: ${entry.description}`);
}

function clearAuditLog() {
  if (!can('superadmin')) { toast('רק מנהל ראשי יכול לנקות את הלוג'); return; }
  if (!confirm('למחוק את כל לוג הפעולות?')) return;
  DB.auditLog = [];
  try { localStorage.removeItem('donorAuditLog_v1'); } catch(e) {}
  saveDB(); renderAuditLog();
}

// ════════════════════════════════════════════════════
// NEDARIM PLUS INTEGRATION
// ════════════════════════════════════════════════════
function getNedarimSettings() {
  return DB.nedarim || {};
}

function openNedarimSettings() {
  const nd = getNedarimSettings();
  document.getElementById('ndMosad').value = nd.mosad || '';
  document.getElementById('ndApiKey').value = nd.apiKey || '';
  document.getElementById('ndDefaultDesc').value = nd.desc || 'תרומה';
  openModal('nedarimSettingsModal');
}

function saveNedarimSettings() {
  DB.nedarim = {
    mosad: document.getElementById('ndMosad').value.trim(),
    apiKey: document.getElementById('ndApiKey').value.trim(),
    desc: document.getElementById('ndDefaultDesc').value.trim() || 'תרומה',
  };
  saveDB();
  closeModal('nedarimSettingsModal');
  // Show/hide credit buttons
  const nd = getNedarimSettings();
  ['dashCreditBtn','donsPanelCreditBtn'].forEach(id => {
    const el = document.getElementById(id);
    if(el) el.style.display = nd.mosad ? '' : 'none';
  });
  toast('✓ הגדרות נדרים פלוס נשמרו');
}

let _nedarimDonorId = null;

function openNedarimPayment(donorId, amount) {
  const nd = getNedarimSettings();
  if (!nd.mosad) { openNedarimSettings(); return; }
  _nedarimDonorId = donorId || null;
  const d = donorId ? DB.donors.find(x => x.id === donorId) : null;

  const params = new URLSearchParams({
    mosad: nd.mosad,
    ApiValid: nd.apiKey || '',
    Teur: nd.desc || 'תרומה',
    Currency: '1', // ILS
    ...(d ? {
      FirstName: d.firstName || '',
      LastName: d.lastName || '',
      Phone: d.mobile || d.phone || '',
      Email: d.email || '',
    } : {}),
    ...(amount ? { Amount: amount } : {}),
    CallBack: 'postMessage',
  });

  const iframeUrl = `https://matara.pro/nedarimplus/online/?${params.toString()}`;
  const iframe = document.getElementById('nedarimIframe');
  const loading = document.getElementById('nedarimLoading');
  if (iframe) {
    loading.style.display = 'flex';
    iframe.src = iframeUrl;
    iframe.onload = () => { loading.style.display = 'none'; };
  }
  openModal('nedarimPayModal');
  auditLog('create', `פתיחת ממשק אשראי נדרים פלוס${d ? ' עבור ' + donorName(d) : ''}`);
}

function openNedarimForCurrentDonor() {
  closeModal('donorModal');
  setTimeout(() => openNedarimPayment(currentDonorId), 150);
}

function closeNedarimModal() {
  const iframe = document.getElementById('nedarimIframe');
  if (iframe) iframe.src = 'about:blank';
  closeModal('nedarimPayModal');
}

// Listen for Nedarim Plus callback
window.addEventListener('message', function(e) {
  try {
    if (!e.data || typeof e.data !== 'object') return;
    // Only process Nedarim Plus messages (must have Amount field)
    const data = e.data;
    if (!data.Amount && !data.amount) return;
    if (data.StatusCode === '0' || data.Amount) {
      closeNedarimModal();
      const amount = parseFloat(data.Amount || data.amount || 0);
      if (amount > 0) {
        const donorId = _nedarimDonorId;
        const d = donorId ? DB.donors.find(x => x.id === donorId) : null;
        const donation = {
          amount, date: today(), method: 'אשראי',
          campaignId: activeCampaign()?.id || '',
          notes: `נדרים פלוס | אסמכתא: ${data.ConfirmationNumber || data.TransactionId || ''}`,
        };
        if (d) {
          if (!d.donations) d.donations = [];
          d.donations.push(donation);
          auditLog('create', `תרומת אשראי ₪${amount} נוספה ל${donorName(d)} (נדרים פלוס)`);
          toast(`✓ תרומה של ₪${amount.toLocaleString()} נוספה ל${donorName(d)}`);
        } else {
          toast(`✓ תרומת אשראי ₪${amount.toLocaleString()} התקבלה`);
        }
        saveDB(); renderAll(); renderGlobalStats();
      }
    }
  } catch(err) { /* ignore non-Nedarim messages */ }
});

// ════════════════════════════════════════════════════
// INTERNAL MESSAGING
// ════════════════════════════════════════════════════
function initMessaging() {
  if (!DB.messages) DB.messages = [];
}

function updateUnreadBadge() {
  initMessaging();
  if (!currentUser) return;
  const unread = DB.messages.filter(m => m.to === currentUser.username && !m.read).length;
  const badge = document.getElementById('topMsgBadge');
  const sbBadge = document.getElementById('sbUnreadBadge');
  if (badge) { badge.textContent = unread ? `✉️ ${unread}` : ''; badge.style.display = unread ? '' : 'none'; }
  if (sbBadge) { sbBadge.textContent = unread || ''; sbBadge.style.display = unread ? '' : 'none'; }
}

function openComposeMsg() {
  initMessaging();
  const sel = document.getElementById('msgTo');
  sel.innerHTML = '<option value="">בחר משתמש...</option>';
  if(can('superadmin')){
    const oa=document.createElement('option'); oa.value='__ALL__';
    oa.textContent='📢 כל המשתמשים (שידור)'; oa.style.fontWeight='700'; oa.style.color='#c00';
    sel.appendChild(oa);
  }
  DB.users.filter(u => u.username !== currentUser?.username).forEach(u => {
    const o = document.createElement('option');
    o.value = u.username; o.textContent = u.displayName || u.username;
    sel.appendChild(o);
  });
  document.getElementById('msgSubject').value = '';
  document.getElementById('msgBody').value = '';
  openModal('composeMsgModal');
}

function sendMessage() {
  const to = document.getElementById('msgTo').value;
  const subject = document.getElementById('msgSubject').value.trim();
  const body = document.getElementById('msgBody').value.trim();
  if (!to || !subject) { toast('נא למלא נמען וכותרת'); return; }
  initMessaging();
  if(to==='__ALL__'){
    const recipients=DB.users.filter(u=>u.username!==currentUser.username);
    const now=Date.now();
    recipients.forEach((u,i)=>{
      DB.messages.push({
        id:'MSG'+(now+i),from:currentUser.username,
        fromDisplay:currentUser.displayName||currentUser.username,
        to:u.username,subject,body,
        ts:new Date().toISOString(),read:false,broadcast:true
      });
    });
    saveDB();
    closeModal('composeMsgModal');
    toast('📢 הודעת שידור נשלחה ל-'+recipients.length+' משתמשים');
    updateUnreadBadge();
    return;
  }
  DB.messages.push({
    id: 'MSG' + Date.now(),
    from: currentUser.username,
    fromDisplay: currentUser.displayName || currentUser.username,
    to, subject, body,
    ts: new Date().toISOString(),
    read: false,
  });
  saveDB();
  closeModal('composeMsgModal');
  toast(`✓ הודעה נשלחה אל ${to}`);
  updateUnreadBadge();
}

function renderMsgThreads() {
  initMessaging();
  if (!currentUser) return;
  const me = currentUser.username;
  // Group by conversation partner
  const threads = {};
  DB.messages.forEach(m => {
    const partner = m.from === me ? m.to : m.from;
    if (!threads[partner]) threads[partner] = [];
    threads[partner].push(m);
  });
  const list = document.getElementById('msgThreadList');
  if (!list) return;
  if (!Object.keys(threads).length) {
    list.innerHTML = '<div style="padding:20px;text-align:center;color:var(--muted);font-size:13px">אין הודעות</div>';
    return;
  }
  list.innerHTML = Object.entries(threads).map(([partner, msgs]) => {
    const last = msgs[msgs.length - 1];
    const unread = msgs.filter(m => m.to === me && !m.read).length;
    const partnerDisplay = DB.users.find(u => u.username === partner)?.displayName || partner;
    return `<div onclick="openMsgThread('${partner}')" style="padding:14px 16px;border-bottom:1px solid var(--cream-d);cursor:pointer;display:flex;align-items:center;gap:10px" onmouseover="this.style.background='var(--cream)'" onmouseout="this.style.background='white'">
      <div style="font-size:24px">👤</div>
      <div style="flex:1;min-width:0">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong style="font-size:13px">${partnerDisplay}</strong>
          ${unread ? `<span style="background:var(--danger);color:white;border-radius:10px;padding:1px 7px;font-size:11px;font-weight:700">${unread}</span>` : ''}
        </div>
        <div style="font-size:11px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${last.subject}</div>
      </div>
    </div>`;
  }).join('');
}

function openMsgThread(partner) {
  initMessaging();
  const me = currentUser.username;
  const msgs = DB.messages.filter(m => (m.from === me && m.to === partner) || (m.from === partner && m.to === me));
  // Mark as read
  msgs.forEach(m => { if (m.to === me && !m.read) m.read = true; });
  saveDB(); updateUnreadBadge();
  const partnerDisplay = DB.users.find(u => u.username === partner)?.displayName || partner;
  const view = document.getElementById('msgThreadView');
  view.innerHTML = `
    <div style="border-bottom:1px solid var(--border);padding-bottom:12px;margin-bottom:12px;display:flex;justify-content:space-between;align-items:center">
      <strong>שיחה עם ${partnerDisplay}</strong>
      <button class="btn btn-gold btn-sm" onclick="replyToUser('${partner}')">↩ השב</button>
    </div>
    <div style="flex:1;overflow-y:auto">
      ${msgs.sort((a,b) => a.ts.localeCompare(b.ts)).map(m => {
        const isMine = m.from === me;
        const dt = new Date(m.ts).toLocaleString('he-IL');
        return `<div style="margin-bottom:14px;display:flex;flex-direction:column;align-items:${isMine?'flex-end':'flex-start'}">
          <div style="background:${isMine?'var(--navy)':'var(--cream)'};color:${isMine?'white':'var(--text)'};border-radius:12px;padding:10px 14px;max-width:80%">
            <div style="font-weight:700;font-size:12px;margin-bottom:4px">${m.subject}</div>
            <div style="font-size:13px;white-space:pre-wrap">${m.body||''}</div>
          </div>
          <div style="font-size:10px;color:var(--muted);margin-top:4px">${m.fromDisplay||m.from} · ${dt}</div>
        </div>`;
      }).join('')}
    </div>`;
}

function replyToUser(partner) {
  const sel = document.getElementById('msgTo');
  if (sel) sel.value = partner;
  openComposeMsg();
  document.getElementById('msgTo').value = partner;
}

// ════════════════════════════════════════════════════
// DONOR SELF-SERVICE PORTAL
// ════════════════════════════════════════════════════
function generateSelfServiceToken(donorId) {
  if (!DB.selfServiceTokens) DB.selfServiceTokens = {};
  if (!DB.selfServiceTokens[donorId]) {
    DB.selfServiceTokens[donorId] = 'SS' + Date.now().toString(36) + Math.random().toString(36).slice(2, 8);
    saveDB();
  }
  return DB.selfServiceTokens[donorId];
}

function getSelfServiceUrl(donorId) {
  const token = generateSelfServiceToken(donorId);
  return `${window.location.href.split('?')[0]}?selfService=${token}&donor=${donorId}`;
}

function openSelfServiceForDonor(donorId) {
  const d = DB.donors.find(x => x.id === donorId);
  if (!d) return;
  // Close donor modal first so self-service modal is visible
  closeModal('donorModal');
  const url = getSelfServiceUrl(donorId);
  const el = document.getElementById('selfServiceContent');
  el.innerHTML = `
    <div style="margin-bottom:14px">
      <div style="font-weight:700;margin-bottom:6px">תורם: ${donorName(d)}</div>
      <div style="background:var(--cream);border-radius:8px;padding:10px;font-size:12px;word-break:break-all;font-family:monospace;direction:ltr;text-align:left">${url}</div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="btn btn-navy btn-sm" onclick="copyToClipboard('${url.replace(/\\/g,'\\\\').replace(/'/g,"\\'")}')">📋 העתק קישור</button>
    </div>`;
  openModal('selfServiceModal');
}

function openSelfServicePanel() {
  // Show choice dialog: specific donor or export all
  const el = document.getElementById('selfServiceContent');
  el.innerHTML = `
    <div style="display:flex;flex-direction:column;gap:12px">
      <div style="font-size:13px;color:var(--muted)">בחר אפשרות:</div>
      <div>
        <label class="form-label" style="margin-bottom:6px;display:block">בחר תורם ספציפי:</label>
        <div style="display:flex;gap:6px">
          <input class="form-control" id="ssSearchInput" placeholder="חיפוש שם תורם..." oninput="searchDonorForSS(this.value)" style="flex:1">
        </div>
        <div id="ssSearchResults" class="pick-results" style="max-height:160px;margin-top:4px"></div>
      </div>
      <hr style="border:none;border-top:1px solid var(--border)">
      <div>
        <div style="font-size:13px;font-weight:600;margin-bottom:6px">ייצוא לכל התורמים:</div>
        <button class="btn btn-outline btn-sm" onclick="exportAllSelfServiceLinks()">📥 ייצוא Excel עם כל הקישורים</button>
        <div style="font-size:11px;color:var(--muted);margin-top:4px">ייוצא קובץ עם קישור ייחודי לכל תורם</div>
      </div>
    </div>`;
  openModal('selfServiceModal');
}

function searchDonorForSS(q) {
  const res = q ? DB.donors.filter(d =>
    (donorName(d)).toLowerCase().includes(q.toLowerCase()) ||
    (d.code||'').includes(q)
  ).slice(0, 8) : [];
  document.getElementById('ssSearchResults').innerHTML = res.map(d =>
    `<div class="pick-item" onclick="showSSForDonor('${d.id}')">${donorName(d)} <span style="font-size:10px;color:var(--muted)">${d.code||''}</span></div>`
  ).join('') || (q ? '<p style="font-size:11px;color:var(--muted);padding:5px">לא נמצאו</p>' : '');
}

function showSSForDonor(donorId) {
  const d = DB.donors.find(x => x.id === donorId);
  if (!d) return;
  const url = getSelfServiceUrl(donorId);
  document.getElementById('selfServiceContent').innerHTML = `
    <div style="margin-bottom:14px">
      <button onclick="openSelfServicePanel()" style="background:none;border:none;color:var(--muted);cursor:pointer;font-size:12px;font-family:Heebo,sans-serif;margin-bottom:10px">← חזרה</button>
      <div style="font-weight:700;margin-bottom:8px">תורם: ${donorName(d)}</div>
      <div style="background:var(--cream);border-radius:8px;padding:10px;font-size:11px;word-break:break-all;font-family:monospace;direction:ltr;text-align:left;margin-bottom:10px">${url}</div>
      <button class="btn btn-navy btn-sm" onclick="copyToClipboard('${url.replace(/\\/g,'\\\\').replace(/'/g,"\\'")}')">📋 העתק קישור</button>
    </div>`;
}


function exportAllSelfServiceLinks() {
  const rows = DB.donors
    .filter(d => d.email || true)
    .map(d => ({
      'קוד': d.code,
      'שם פרטי': d.firstName,
      'שם משפחה': d.lastName,
      'מייל': d.email || '',
      'קישור עצמי': getSelfServiceUrl(d.id),
    }));
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(rows), 'קישורים');
  XLSX.writeFile(wb, `קישורים_עצמיים_${today()}.xlsx`);
  auditLog('export', 'ייצוא קישורים עצמיים לתורמים');
}

function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(() => toast('✓ הקישור הועתק'));
}

// Handle self-service page load (if token in URL)
function checkSelfServiceMode() {
  const params = new URLSearchParams(window.location.search);
  const token = params.get('selfService');
  const donorId = params.get('donor');
  if (!token || !donorId) return false;
  // Verify token
  if (!DB.selfServiceTokens || DB.selfServiceTokens[donorId] !== token) {
    document.body.innerHTML = '<div style="text-align:center;padding:60px;font-family:Heebo;font-size:18px;color:#c0392b">קישור לא תקין או פג תוקף</div>';
    return true;
  }
  const d = DB.donors.find(x => x.id === donorId);
  if (!d) {
    document.body.innerHTML = '<div style="text-align:center;padding:60px;font-family:Heebo;font-size:18px;color:#c0392b">תורם לא נמצא</div>';
    return true;
  }
  // Show self-edit form
  showSelfEditForm(d, token);
  return true;
}

function showSelfEditForm(d, token) {
  document.body.innerHTML = `
    <div style="max-width:540px;margin:40px auto;padding:20px;font-family:'Heebo',sans-serif;direction:rtl">
      <div style="text-align:center;margin-bottom:24px">
        <div style="font-size:28px">✡️</div>
        <h2 style="font-size:22px;color:#1a2744;margin:8px 0">עדכון פרטים — עזר תורה</h2>
        <p style="color:#6b7a9a;font-size:13px">עדכן את פרטיך האישיים. השינויים יועברו לאישור המנהל.</p>
      </div>
      <div style="background:white;border-radius:12px;padding:24px;box-shadow:0 2px 16px rgba(0,0,0,.08)">
        <div style="display:grid;gap:12px">
          <div><label style="font-size:11px;font-weight:700;color:#6b7a9a;text-transform:uppercase;letter-spacing:.4px;display:block;margin-bottom:4px">שם פרטי</label>
            <input id="ss_firstName" value="${d.firstName||''}" style="width:100%;padding:8px 11px;border:1.5px solid #d5cfc4;border-radius:8px;font-family:Heebo;font-size:13px;box-sizing:border-box"></div>
          <div><label style="font-size:11px;font-weight:700;color:#6b7a9a;text-transform:uppercase;letter-spacing:.4px;display:block;margin-bottom:4px">שם משפחה</label>
            <input id="ss_lastName" value="${d.lastName||''}" style="width:100%;padding:8px 11px;border:1.5px solid #d5cfc4;border-radius:8px;font-family:Heebo;font-size:13px;box-sizing:border-box"></div>
          <div><label style="font-size:11px;font-weight:700;color:#6b7a9a;text-transform:uppercase;letter-spacing:.4px;display:block;margin-bottom:4px">כתובת</label>
            <input id="ss_address" value="${d.address||''}" style="width:100%;padding:8px 11px;border:1.5px solid #d5cfc4;border-radius:8px;font-family:Heebo;font-size:13px;box-sizing:border-box"></div>
          <div><label style="font-size:11px;font-weight:700;color:#6b7a9a;text-transform:uppercase;letter-spacing:.4px;display:block;margin-bottom:4px">טלפון</label>
            <input id="ss_phone" value="${d.phone||''}" style="width:100%;padding:8px 11px;border:1.5px solid #d5cfc4;border-radius:8px;font-family:Heebo;font-size:13px;box-sizing:border-box"></div>
          <div><label style="font-size:11px;font-weight:700;color:#6b7a9a;text-transform:uppercase;letter-spacing:.4px;display:block;margin-bottom:4px">סלולרי</label>
            <input id="ss_mobile" value="${d.mobile||''}" style="width:100%;padding:8px 11px;border:1.5px solid #d5cfc4;border-radius:8px;font-family:Heebo;font-size:13px;box-sizing:border-box"></div>
          <div><label style="font-size:11px;font-weight:700;color:#6b7a9a;text-transform:uppercase;letter-spacing:.4px;display:block;margin-bottom:4px">מייל</label>
            <input id="ss_email" type="email" value="${d.email||''}" style="width:100%;padding:8px 11px;border:1.5px solid #d5cfc4;border-radius:8px;font-family:Heebo;font-size:13px;box-sizing:border-box"></div>
        </div>
        <div id="ss_result" style="margin-top:12px;display:none;text-align:center;padding:10px;border-radius:8px;font-size:13px"></div>
        <button onclick="submitSelfEdit('${d.id}','${token}')" style="width:100%;margin-top:16px;padding:11px;background:#1a2744;color:white;border:none;border-radius:8px;font-family:Heebo;font-size:14px;font-weight:700;cursor:pointer">שלח לאישור</button>
      </div>
    </div>`;
}

function submitSelfEdit(donorId, token) {
  const edits = {
    firstName: document.getElementById('ss_firstName')?.value.trim(),
    lastName: document.getElementById('ss_lastName')?.value.trim(),
    address: document.getElementById('ss_address')?.value.trim(),
    phone: document.getElementById('ss_phone')?.value.trim(),
    mobile: document.getElementById('ss_mobile')?.value.trim(),
    email: document.getElementById('ss_email')?.value.trim(),
  };
  if (!DB.pendingEdits) DB.pendingEdits = [];
  DB.pendingEdits.push({ id: 'PE'+Date.now(), donorId, edits, ts: new Date().toISOString(), token });
  saveDB();
  const res = document.getElementById('ss_result');
  if (res) {
    res.style.display='block'; res.style.background='#eafaf1'; res.style.color='#1e8449';
    res.textContent='✓ הפרטים נשלחו לאישור. תודה!';
  }
}

function openPendingEdits() {
  renderPendingEdits();
  openModal('pendingEditsModal');
}

function updatePendingEditsCount() {
  const count = (DB.pendingEdits||[]).length;
  const el = document.getElementById('pendingEditsCount');
  if (el) { el.textContent = count || ''; el.style.display = count ? '' : 'none'; }
}

function renderPendingEdits() {
  const edits = DB.pendingEdits || [];
  const el = document.getElementById('pendingEditsList');
  if (!el) return;
  if (!edits.length) { el.innerHTML = '<div style="text-align:center;padding:30px;color:var(--muted)">אין בקשות עדכון ממתינות</div>'; return; }
  el.innerHTML = edits.map((pe, idx) => {
    const d = DB.donors.find(x => x.id === pe.donorId);
    const dt = new Date(pe.ts).toLocaleString('he-IL');
    const changes = Object.entries(pe.edits).filter(([k,v]) => v && d && d[k] !== v).map(([k,v]) => {
      const labels = {firstName:'שם פרטי',lastName:'שם משפחה',address:'כתובת',phone:'טלפון',mobile:'סלולרי',email:'מייל'};
      return `<div style="font-size:12px;padding:4px 0"><span style="color:var(--muted)">${labels[k]||k}:</span> <s style="color:var(--danger)">${d?.[k]||'(ריק)'}</s> → <strong style="color:var(--success)">${v}</strong></div>`;
    }).join('');
    return `<div style="background:var(--cream);border-radius:10px;padding:14px 18px;margin-bottom:12px">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px">
        <div>
          <strong>${d ? donorName(d) : pe.donorId}</strong>
          <span style="font-size:11px;color:var(--muted);margin-right:8px">${dt}</span>
        </div>
        <div style="display:flex;gap:6px">
          <button class="btn btn-success btn-sm" onclick="approvePendingEdit(${idx})">✓ אשר</button>
          <button class="btn btn-danger btn-sm" onclick="rejectPendingEdit(${idx})">✕ דחה</button>
        </div>
      </div>
      <div style="margin-top:8px">${changes || '<em style="color:var(--muted);font-size:12px">אין שינויים משמעותיים</em>'}</div>
    </div>`;
  }).join('');
}

function approvePendingEdit(idx) {
  const pe = (DB.pendingEdits||[])[idx];
  if (!pe) return;
  const d = DB.donors.find(x => x.id === pe.donorId);
  if (d) {
    Object.assign(d, pe.edits);
    d.updatedAt = new Date().toISOString();
    d.updatedBy = 'self';
  }
  DB.pendingEdits.splice(idx, 1);
  auditLog('edit', `אושר עדכון עצמי לתורם ${d ? donorName(d) : pe.donorId}`);
  saveDB(); renderPendingEdits(); updatePendingEditsCount(); renderAll();
  toast('✓ השינויים אושרו');
}

function rejectPendingEdit(idx) {
  const pe = (DB.pendingEdits||[])[idx];
  const d = pe ? DB.donors.find(x => x.id === pe.donorId) : null;
  DB.pendingEdits.splice(idx, 1);
  auditLog('edit', `נדחה עדכון עצמי לתורם ${d ? donorName(d) : ''}`);
  saveDB(); renderPendingEdits(); updatePendingEditsCount();
  toast('בקשה נדחתה');
}

// ════════════════════════════════════════════════════
// _initMessagesPage defined here
function _initMessagesPage() {
  renderMsgThreads();
}

// ════════════════════════════════════════════════════
// AUDIT LOG HOOKS — wrap key actions
// ════════════════════════════════════════════════════
const _origSaveDonor = typeof saveDonor === 'function' ? saveDonor : null;
const _origDeleteCurrentDonor = typeof deleteCurrentDonor === 'function' ? deleteCurrentDonor : null;

// Patch showPage to init messages on nav
// Messages and admin init are handled directly inside showPage above

// ════════════════════════════════════════════════════
// EMAIL SYSTEM (EmailJS)
// ════════════════════════════════════════════════════
function getEmailSettings() { return DB.emailSettings || {}; }

function _initEmailJS() {
  const s = getEmailSettings();
  if (s.publicKey && typeof emailjs !== 'undefined') {
    try { emailjs.init(s.publicKey); } catch(e) {}
  }
}

async function _sendEmail(templateId, params) {
  const s = getEmailSettings();
  if (!s.publicKey || !s.serviceId) throw new Error('EmailJS לא מוגדר — פנה לניהול → מערכת מיילים');
  if (!templateId) throw new Error('תבנית מייל לא מוגדרת');
  _initEmailJS();
  return emailjs.send(s.serviceId, templateId, params);
}

function openEmailSettings() {
  if (!can('admin')) { toast('אין הרשאה'); return; }
  const s = getEmailSettings();
  document.getElementById('ejPublicKey').value = s.publicKey || '';
  document.getElementById('ejServiceId').value = s.serviceId || '';
  document.getElementById('ejTplMessage').value = s.tplMessage || '';
  document.getElementById('ejTplReset').value = s.tplReset || '';
  document.getElementById('ejOrgName').value = s.orgName || 'עזר תורה';
  document.getElementById('ejTestResult').style.display = 'none';
  openModal('emailSettingsModal');
}

function saveEmailSettings() {
  DB.emailSettings = {
    publicKey: document.getElementById('ejPublicKey').value.trim(),
    serviceId: document.getElementById('ejServiceId').value.trim(),
    tplMessage: document.getElementById('ejTplMessage').value.trim(),
    tplReset: document.getElementById('ejTplReset').value.trim(),
    orgName: document.getElementById('ejOrgName').value.trim() || 'עזר תורה',
  };
  saveDB();
  _initEmailJS();
  closeModal('emailSettingsModal');
  toast('הגדרות מיילים נשמרו');
  // Refresh email button visibility
  if (currentDonorId) {
    const eb = document.getElementById('donorEmailBtn');
    if (eb) eb.style.display = DB.emailSettings.publicKey ? '' : 'none';
  }
}

async function testEmailSettings() {
  const s = getEmailSettings();
  const el = document.getElementById('ejTestResult');
  const tmp = {
    publicKey: document.getElementById('ejPublicKey').value.trim(),
    serviceId: document.getElementById('ejServiceId').value.trim(),
    tplReset: document.getElementById('ejTplReset').value.trim(),
    orgName: document.getElementById('ejOrgName').value.trim() || 'עזר תורה',
  };
  if (!tmp.publicKey || !tmp.serviceId || !tmp.tplReset) {
    el.style.display = 'block'; el.style.color = 'var(--danger)';
    el.textContent = 'נא למלא Public Key, Service ID וTemplate שחזור סיסמה'; return;
  }
  el.style.display = 'block'; el.style.color = 'var(--muted)'; el.textContent = 'שולח...';
  try {
    emailjs.init(tmp.publicKey);
    await emailjs.send(tmp.serviceId, tmp.tplReset, {
      to_email: currentUser ? currentUser.email : '',
      name: currentUser ? (currentUser.displayName || currentUser.username) : 'בדיקה',
      reset_code: 'TEST-123456',
      org_name: tmp.orgName,
    });
    el.style.color = 'var(--success)'; el.textContent = 'מייל בדיקה נשלח! בדוק תיבת הדואר';
  } catch(e) {
    el.style.color = 'var(--danger)'; el.textContent = 'שגיאה: ' + (e.text || e.message || JSON.stringify(e));
  }
}

// FORGOT PASSWORD — sends a 6-digit code via EmailJS
async function sendForgotPassword() {
  const emailInput = document.getElementById('forgotEmail').value.trim();
  const msg = document.getElementById('forgotMsg');
  if (!emailInput) { msg.style.display='block'; msg.style.color='var(--danger)'; msg.textContent='נא הזן כתובת מייל'; return; }
  const s = getEmailSettings();
  if (!s.publicKey || !s.tplReset) {
    msg.style.display='block'; msg.style.color='var(--muted)';
    msg.textContent='לאיפוס סיסמה פנה למנהל המערכת (מערכת מיילים לא מוגדרת)'; return;
  }
  msg.style.display='block'; msg.style.color='var(--muted)'; msg.textContent='שולח...';
  const user = DB.users.find(u => u.email === emailInput || u.username === emailInput);
  if (user) {
    const code = Math.floor(100000 + Math.random() * 900000).toString();
    if (!DB._resetCodes) DB._resetCodes = {};
    DB._resetCodes[emailInput] = { code, ts: Date.now() };
    saveDB();
    try {
      await _sendEmail(s.tplReset, {
        to_email: emailInput,
        name: user.displayName || user.username,
        reset_code: code,
        org_name: s.orgName || 'עזר תורה',
      });
    } catch(e) {
      msg.style.color='var(--danger)'; msg.textContent='שגיאה בשליחה: ' + (e.text || e.message); return;
    }
  }
  // Generic message (security - don't reveal if email exists)
  msg.style.color='var(--success)'; msg.textContent='קוד איפוס נשלח אם המייל קיים במערכת';
  if (!document.getElementById('resetCodeInput')) {
    document.getElementById('forgotPassBox').innerHTML += `<div style="display:flex;flex-direction:column;gap:10px;margin-top:12px">
      <div class="fg"><label class="form-label">קוד האיפוס שקיבלת</label>
        <input class="form-control" id="resetCodeInput" placeholder="6 ספרות" maxlength="6" inputmode="numeric">
      </div>
      <div class="fg"><label class="form-label">סיסמה חדשה</label>
        <input class="form-control" type="password" id="resetNewPassInput" placeholder="לפחות 8 תווים">
      </div>
      <button class="btn btn-navy" onclick="confirmPasswordReset('${emailInput}')" style="justify-content:center">אפס סיסמה</button>
    </div>`;
  }
}

function confirmPasswordReset(email) {
  const code = document.getElementById('resetCodeInput')?.value.trim();
  const newPass = document.getElementById('resetNewPassInput')?.value;
  const stored = DB._resetCodes ? DB._resetCodes[email] : null;
  if (!stored || stored.code !== code) { toast('קוד שגוי — נסה שוב'); return; }
  if (Date.now() - stored.ts > 30 * 60 * 1000) { toast('הקוד פג תוקף — בקש קוד חדש'); return; }
  if (!newPass || newPass.length < 8) { toast('הסיסמה חייבת להכיל לפחות 8 תווים'); return; }
  const user = DB.users.find(u => u.email === email || u.username === email);
  if (user) { user.password = newPass; }
  delete DB._resetCodes[email];
  saveDB();
  toast('הסיסמה אופסה בהצלחה');
  showLoginForm();
}

// SEND EMAIL TO SINGLE DONOR
let _emailDonorId = null;

function openSendEmailModal(donorId) {
  if (!donorId && currentDonorId) donorId = currentDonorId;
  const d = DB.donors.find(x => x.id === donorId);
  if (!d) return;
  const s = getEmailSettings();
  if (!s.publicKey) { toast('יש להגדיר מערכת מיילים קודם'); openEmailSettings(); return; }
  _emailDonorId = donorId;
  document.getElementById('donorEmailTo').value = d.email || '';
  const noEmail = document.getElementById('sendDonorNoEmail');
  const sendBtn = document.getElementById('sendDonorEmailBtn');
  if (!d.email) { if(noEmail) noEmail.style.display='block'; if(sendBtn) sendBtn.disabled=true; }
  else { if(noEmail) noEmail.style.display='none'; if(sendBtn) sendBtn.disabled=false; }
  document.getElementById('donorEmailSubject').value = '';
  document.getElementById('donorEmailBody').value = '';
  const rb = document.getElementById('donorRichBody');
  if (rb) rb.innerHTML = '';
  document.getElementById('donorEmailResult').style.display = 'none';
  updateDonorEmailPreview();
  openModal('sendDonorEmailModal');
}

function updateDonorEmailPreview() {
  const type = document.getElementById('donorEmailType').value;
  const msgFields = document.getElementById('donorEmailMsgFields');
  const preview = document.getElementById('donorEmailPreview');
  if (type === 'link') {
    msgFields.style.display = 'none'; preview.style.display = 'block';
    const d = _emailDonorId ? DB.donors.find(x => x.id === _emailDonorId) : null;
    preview.innerHTML = '<strong>תוכן:</strong> קישור אישי לתורם ' + (d ? donorName(d) : '') + ' לעדכון פרטיו עצמאית';
  } else {
    msgFields.style.display = ''; preview.style.display = 'none';
  }
}

async function sendEmailToDonorNow() {
  const d = _emailDonorId ? DB.donors.find(x => x.id === _emailDonorId) : null;
  if (!d || !d.email) return;
  const s = getEmailSettings();
  const type = document.getElementById('donorEmailType').value;
  const result = document.getElementById('donorEmailResult');
  result.style.display = 'block'; result.style.color = 'var(--muted)'; result.textContent = 'שולח...';
  const btn = document.getElementById('sendDonorEmailBtn');
  if (btn) btn.disabled = true;
  try {
    if (type === 'link') {
      const url = getSelfServiceUrl(d.id);
      const subject = 'קישור לעדכון פרטים — ' + (s.orgName || 'עזר תורה');
      await _sendEmail(s.tplMessage, {
        to_email: d.email, donor_name: donorName(d),
        subject, message: 'לעדכון פרטיך האישיים לחץ על הקישור הבא:\n' + url,
        org_name: s.orgName || 'עזר תורה',
      });
    } else {
      const subject = document.getElementById('donorEmailSubject').value.trim();
      const rawBody = getRichBodyText('donorRichBody');
      const body = applyMergeFields(rawBody, d).trim();
      if (!subject || !body) { result.style.color='var(--danger)'; result.textContent='נא למלא נושא ותוכן'; if(btn) btn.disabled=false; return; }
      await _sendEmail(s.tplMessage, {
        to_email: d.email, donor_name: donorName(d),
        subject, message: body, org_name: s.orgName || 'עזר תורה',
      });
    }
    result.style.color = 'var(--success)'; result.textContent = 'מייל נשלח בהצלחה!';
    auditLog('export', 'נשלח מייל ל' + donorName(d) + ' (' + d.email + ')');
    setTimeout(() => closeModal('sendDonorEmailModal'), 1500);
  } catch(e) {
    result.style.color = 'var(--danger)';
    result.textContent = 'שגיאה: ' + (e.text || e.message || 'בדוק הגדרות EmailJS');
    if (btn) btn.disabled = false;
  }
}

// BULK EMAIL
function openBulkEmail() {
  if (!can('admin')) { toast('אין הרשאה'); return; }
  const s = getEmailSettings();
  if (!s.publicKey) { toast('יש להגדיר מערכת מיילים קודם'); openEmailSettings(); return; }
  const count = DB.donors.filter(d => d.email).length;
  const el = document.getElementById('bulkEmailCount');
  if (el) el.textContent = count + ' תורמים';
  document.getElementById('bulkEmailProgress').style.display = 'none';
  document.getElementById('bulkEmailSendBtn').disabled = false;
  const brb = document.getElementById('bulkRichBody');
  if (brb) brb.innerHTML = '';
  document.getElementById('bulkEmailSubject').value = '';
  toggleBulkEmailBody();
  openModal('bulkEmailModal');
}

async function sendBulkEmails() {
  const s = getEmailSettings();
  const type = document.getElementById('bulkEmailType').value;
  const subject = document.getElementById('bulkEmailSubject').value.trim();
  const rawBulkBody = getRichBodyText('bulkRichBody');
  if (type === 'message' && (!subject || !rawBulkBody.trim())) { toast('נא למלא נושא ותוכן'); return; }
  const donors = DB.donors.filter(d => d.email);
  if (!donors.length) { toast('אין תורמים עם כתובת מייל'); return; }
  if (!confirm('לשלוח מייל ל-' + donors.length + ' תורמים?')) return;
  document.getElementById('bulkEmailSendBtn').disabled = true;
  const progress = document.getElementById('bulkEmailProgress');
  const bar = document.getElementById('bulkEmailProgressBar');
  const status = document.getElementById('bulkEmailStatus');
  progress.style.display = '';
  let sent = 0, failed = 0;
  for (const d of donors) {
    try {
      let emailSubject = subject;
      let emailBody = applyMergeFields(rawBulkBody, d);
      if (type === 'link') {
        const url = getSelfServiceUrl(d.id);
        emailSubject = 'קישור לעדכון פרטים — ' + (s.orgName || 'עזר תורה');
        emailBody = 'שלום ' + donorName(d) + ',\n\nלעדכון פרטיך האישיים לחץ על הקישור:\n' + url;
      }
      await _sendEmail(s.tplMessage, {
        to_email: d.email, donor_name: donorName(d),
        subject: emailSubject, message: emailBody,
        org_name: s.orgName || 'עזר תורה',
      });
      sent++;
    } catch(e) { failed++; }
    const pct = Math.round(((sent + failed) / donors.length) * 100);
    bar.style.width = pct + '%';
    status.textContent = 'נשלחו ' + sent + ' | נכשלו ' + failed + ' | נותרו ' + (donors.length - sent - failed);
    await new Promise(r => setTimeout(r, 350)); // respect rate limits
  }
  auditLog('export', 'שליחת מייל מרובה: ' + sent + ' נשלחו, ' + failed + ' נכשלו');
  status.textContent = 'סיום: ' + sent + ' נשלחו בהצלחה, ' + failed + ' נכשלו';
  document.getElementById('bulkEmailSendBtn').disabled = false;
  toast(sent + ' מיילים נשלחו!');
}

// ════════════════════════════════════════════════════
// YEMOT IVR — placeholder (phase 3)
// ════════════════════════════════════════════════════
function getYemotSettings() { return DB.yemotSettings || {}; }

function openYemotSettings() {
  if (!can('admin')) { toast('אין הרשאה'); return; }
  const s = getYemotSettings();
  document.getElementById('ymSystemNum').value = s.systemNum || '';
  document.getElementById('ymApiKey').value = s.apiKey || '';
  document.getElementById('ymWebhookUrl').value = s.webhookUrl || (SUPABASE_URL.replace('.supabase.co', '.functions.supabase.co') + '/v1/yemot-ivr');
  document.getElementById('ymPinType').value = s.pinType || 'none';
  document.getElementById('ymOrgName').value = s.orgName || 'עזר תורה';
  document.getElementById('ymConnectResult').style.display = 'none';
  openModal('yemotSettingsModal');
}

function saveYemotSettings() {
  DB.yemotSettings = {
    systemNum: document.getElementById('ymSystemNum').value.trim(),
    apiKey: document.getElementById('ymApiKey').value.trim(),
    webhookUrl: document.getElementById('ymWebhookUrl').value.trim(),
    pinType: document.getElementById('ymPinType').value,
    orgName: document.getElementById('ymOrgName').value.trim() || 'עזר תורה',
  };
  saveDB();
  closeModal('yemotSettingsModal');
  toast('הגדרות ימות המשיח נשמרו');
}

async function testYemotConnection() {
  const s = getYemotSettings();
  const el = document.getElementById('ymConnectResult');
  if (!s.apiKey) { el.style.display='block'; el.style.color='var(--danger)'; el.textContent='נא להזין API Key'; return; }
  el.style.display='block'; el.style.color='var(--muted)'; el.textContent='בודק חיבור...';
  try {
    const resp = await fetch('https://www.call2all.co.il/ym/api/GetSession?token=' + encodeURIComponent(s.apiKey));
    const data = await resp.json();
    if (data.responseStatus === 'OK') {
      el.style.color='var(--success)'; el.textContent='חיבור תקין! מערכת: ' + (data.username || s.systemNum);
    } else {
      el.style.color='var(--danger)'; el.textContent='שגיאה: ' + (data.message || data.responseStatus);
    }
  } catch(e) {
    el.style.color='var(--danger)'; el.textContent='לא ניתן להתחבר לשרת ימות (ייתכן CORS — נדרש שרת)';
  }
}

function saveYemotSettings_unused() {} // placeholder



// ════════════════════════════════════════════════════
// ITEM 8 — Israeli ID validation
// ════════════════════════════════════════════════════
function validateIsraeliId(id) {
  id = String(id).trim().padStart(9,'0');
  if (!/^\d{9}$/.test(id)) return false;
  let sum = 0;
  for (let i=0; i<9; i++) { let d=parseInt(id[i])*((i%2)+1); sum += d>9?d-9:d; }
  return sum%10===0;
}
function validateIdField(input) {
  const icon=document.getElementById('f_idValidIcon'), err=document.getElementById('f_idError');
  const val=input.value.replace(/\D/g,''); input.value=val;
  if (!val) { icon.textContent=''; if(err)err.style.display='none'; return; }
  if (val.length===9) { const ok=validateIsraeliId(val); icon.textContent=ok?'✅':'❌'; if(err)err.style.display=ok?'none':'block'; }
  else { icon.textContent=''; if(err)err.style.display='none'; }
}

// ════════════════════════════════════════════════════
// ITEM 7 — Duplicate Detection
// ════════════════════════════════════════════════════
function openDuplicateDetection() {
  if (!can('admin')) { toast('אין הרשאה'); return; }
  const dupes = findDuplicateDonors();
  renderDuplicateModal(dupes);
  openModal('duplicateModal');
}
function findDuplicateDonors() {
  const groups=[], seen=new Set(), donors=DB.donors;
  const phoneMap={}, mobileMap={}, emailMap={};
  donors.forEach(d => {
    if(d.phone)  { if(!phoneMap[d.phone])   phoneMap[d.phone]=[];  phoneMap[d.phone].push(d.id);  }
    if(d.mobile) { if(!mobileMap[d.mobile]) mobileMap[d.mobile]=[]; mobileMap[d.mobile].push(d.id); }
    if(d.email)  { const k=d.email.toLowerCase(); if(!emailMap[k]) emailMap[k]=[]; emailMap[k].push(d.id); }
  });
  const addGroup=(ids,reason)=>{ const key=ids.slice().sort().join(','); if(seen.has(key))return; seen.add(key); groups.push({ids,reason}); };
  Object.entries(phoneMap).forEach(([v,ids])  =>{ if(ids.length>1) addGroup(ids,'טלפון: '+v); });
  Object.entries(mobileMap).forEach(([v,ids]) =>{ if(ids.length>1) addGroup(ids,'סלולרי: '+v); });
  Object.entries(emailMap).forEach(([v,ids])  =>{ if(ids.length>1) addGroup(ids,'מייל: '+v); });
  return groups;
}
function renderDuplicateModal(groups) {
  const body=document.getElementById('dupBody');
  if (!groups.length) { body.innerHTML='<div style="text-align:center;padding:32px;color:var(--muted)">🎉 לא נמצאו כפילויות!</div>'; return; }
  body.innerHTML=groups.map((g,gi)=>{
    const donors=g.ids.map(id=>DB.donors.find(d=>d.id===id)).filter(Boolean);
    return `<div style="border:1px solid var(--border);border-radius:10px;padding:14px;margin-bottom:12px">
      <div style="font-weight:700;font-size:13px;color:var(--navy);margin-bottom:8px">⚠️ ${g.reason}</div>
      ${donors.map(d=>`<div style="display:flex;align-items:center;justify-content:space-between;background:var(--cream);border-radius:8px;padding:9px 12px;margin-bottom:6px;font-size:12px">
        <div><strong>${donorName(d)}</strong> <span style="color:var(--muted)">${d.code||''}</span><br>
        <span>${d.address||''}</span> <span style="color:var(--muted)">${[d.phone,d.mobile,d.email].filter(Boolean).join(' | ')}</span></div>
        <button class="btn btn-outline btn-sm" onclick="openDonorModal('${d.id}')">✏️ פתח</button>
      </div>`).join('')}
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
        <button class="btn btn-gold btn-sm" onclick="openMergeModal(${gi})">🔀 מזג לכרטיס אחד</button>
      </div>
    </div>`;
  }).join('');
  window._dupGroups=groups;
}
function openMergeModal(gi) {
  const g=window._dupGroups[gi];
  const donors=g.ids.map(id=>DB.donors.find(d=>d.id===id)).filter(Boolean);
  document.getElementById('mergeOptions').innerHTML=`
    <p style="font-size:13px;margin-bottom:12px">בחר את הכרטיס ה<strong>ראשי</strong> שישמר. כל התרומות מהכרטיסים האחרים יועברו אליו.</p>
    ${donors.map((d,i)=>`<label style="display:flex;align-items:center;gap:8px;padding:10px;background:var(--cream);border-radius:8px;margin-bottom:6px;cursor:pointer">
      <input type="radio" name="mergeBase" value="${d.id}" ${i===0?'checked':''}> 
      <span><strong>${donorName(d)}</strong> <span style="font-size:11px;color:var(--muted)">${d.code||''} | ${d.address||''}</span></span>
    </label>`).join('')}`;
  window._mergeIds=g.ids;
  openModal('mergeModal');
}
function confirmMerge() {
  const base=document.querySelector('input[name="mergeBase"]:checked')?.value; if(!base)return;
  const others=window._mergeIds.filter(id=>id!==base);
  const baseDonor=DB.donors.find(d=>d.id===base); if(!baseDonor)return;
  others.forEach(id=>{
    const other=DB.donors.find(d=>d.id===id); if(!other)return;
    if(!baseDonor.donations)baseDonor.donations=[];
    (other.donations||[]).forEach(dn=>baseDonor.donations.push({...dn,mergedFrom:id}));
    if(!baseDonor.futureDonations)baseDonor.futureDonations=[];
    (other.futureDonations||[]).forEach(fd=>baseDonor.futureDonations.push(fd));
    if(!baseDonor.relations)baseDonor.relations=[];
    (other.relations||[]).filter(r=>r.donorId!==base).forEach(r=>{ if(!baseDonor.relations.find(x=>x.donorId===r.donorId))baseDonor.relations.push(r); });
    ['phone','mobile','email','address','notes','idNumber'].forEach(k=>{ if(!baseDonor[k]&&other[k])baseDonor[k]=other[k]; });
    DB.donors=DB.donors.filter(d=>d.id!==id);
    auditLog('delete',`מיזוג תורם: ${donorName(other)} אוחד עם ${donorName(baseDonor)}`);
  });
  saveDB(); renderAll(); closeModal('mergeModal'); closeModal('duplicateModal');
  toast('✓ הכרטיסים אוחדו בהצלחה');
  setTimeout(()=>openDuplicateDetection(),400);
}

// ════════════════════════════════════════════════════
// ITEM 6 — Nedarim Plus Import
// ════════════════════════════════════════════════════
function openNedarimImport() {
  document.getElementById('ndImportStatus').innerHTML='';
  document.getElementById('ndImportFile').value='';
  document.getElementById('ndImportResult').style.display='none';
  openModal('nedarimImportModal');
}
function processNedarimImport(input) {
  const file=input.files[0]; if(!file) return;
  const statusEl=document.getElementById('ndImportStatus');
  statusEl.innerHTML='<span style="color:var(--muted)">⏳ קורא קובץ...</span>';
  const reader=new FileReader();
  reader.onload=(e)=>{
    try {
      const wb=XLSX.read(e.target.result,{type:'binary'});
      const ws=wb.Sheets[wb.SheetNames[0]];
      const rows=XLSX.utils.sheet_to_json(ws,{defval:''});
      importNedarimRows(rows);
    } catch(err) {
      statusEl.innerHTML=`<span style="color:var(--danger)">שגיאה: ${err.message}</span>`;
    }
  };
  reader.readAsBinaryString(file);
}
function importNedarimRows(rows) {
  let added=0, matched=0, skipped=0;
  const ac=activeCampaign();
  rows.forEach(row=>{
    const amount=parseFloat(row['סכום']||row['Amount']||row['amount']||row['סכום תרומה']||0);
    if(!amount){skipped++;return;}
    const phone =String(row['טלפון']||row['Phone']||row['phone']||'').replace(/\D/g,'');
    const mobile=String(row['נייד']||row['Mobile']||row['cellular']||row['סלולרי']||'').replace(/\D/g,'');
    const email =String(row['מייל']||row['Email']||row['email']||'').trim().toLowerCase();
    const fname =String(row['שם פרטי']||row['FirstName']||row['first_name']||'').trim();
    const lname =String(row['שם משפחה']||row['LastName']||row['last_name']||'').trim();
    const dateRaw=row['תאריך']||row['Date']||row['date']||row['תאריך תרומה']||'';
    const method=String(row['אמצעי תשלום']||row['PaymentMethod']||'אשראי').trim();
    const notes =String(row['הערות']||row['Notes']||'').trim();
    let date='';
    try { const d=new Date(dateRaw); if(!isNaN(d)) date=d.toISOString().split('T')[0]; else date=String(dateRaw).split(' ')[0]; } catch(e){ date=String(dateRaw).split(' ')[0]||''; }
    if(!date) date=today();
    const donation={amount,date,method:method||'אשראי',campaignId:ac?ac.id:'',notes:(notes?notes+' | ':'')+'ייבוא נדרים פלוס',source:'nedarim'};
    let donor=null;
    if(mobile) donor=DB.donors.find(d=>d.mobile&&d.mobile.replace(/\D/g,'')===mobile);
    if(!donor&&phone) donor=DB.donors.find(d=>d.phone&&d.phone.replace(/\D/g,'')===phone);
    if(!donor&&email) donor=DB.donors.find(d=>d.email&&d.email.toLowerCase()===email);
    if(!donor&&fname&&lname) donor=DB.donors.find(d=>(d.firstName||'').trim()===fname&&(d.lastName||'').trim()===lname);
    if(donor){
      if(!donor.donations)donor.donations=[];
      const isDup=donor.donations.some(dn=>parseFloat(dn.amount)===amount&&dn.date===date&&dn.source==='nedarim');
      if(!isDup){donor.donations.push(donation);matched++;}
      else skipped++;
    } else {
      const code='ND'+String(DB.nextCode||1001).padStart(4,'0'); DB.nextCode=(DB.nextCode||1001)+1;
      DB.donors.push({id:'D'+Date.now()+Math.random().toString(36).slice(2,6),code,firstName:fname,lastName:lname,phone:phone||'',mobile:mobile||'',email:email||'',address:String(row['כתובת']||row['Address']||'').trim(),title:'',closingName:'',affil:'',notes:'יובא מנדרים פלוס',idNumber:'',createdAt:new Date().toISOString(),donations:[donation],futureDonations:[],relations:[]});
      added++;
    }
  });
  saveDB(); renderAll();
  auditLog('import',`ייבוא נדרים פלוס: ${matched} שוייכו, ${added} חדשים, ${skipped} דולגו`);
  const el=document.getElementById('ndImportResult');
  el.style.display='block';
  el.innerHTML=`<div style="background:var(--success-bg);border-radius:8px;padding:14px;font-size:13px">
    ✅ <strong>${matched+added} תרומות</strong> עובדו בהצלחה<br>
    ↩ <strong>${matched}</strong> שוייכו לתורמים קיימים &nbsp;|&nbsp; ✨ <strong>${added}</strong> כרטיסים חדשים נוצרו<br>
    ${skipped?`⚠️ ${skipped} שורות דולגו (ללא סכום או כפולות)`:''}
  </div>`;
  document.getElementById('ndImportStatus').innerHTML='';
}

// ════════════════════════════════════════════════════
// ITEM 5 — Standalone donation form page
// ════════════════════════════════════════════════════
function openDonationFormPage() {
  const nd=getNedarimSettings();
  if(!nd.mosad){toast('יש להגדיר קוד מוסד בהגדרות נדרים פלוס');openNedarimSettings();return;}
  const orgName=nd.orgName||getEmailSettings().orgName||'עזר תורה';
  const params=new URLSearchParams({mosad:nd.mosad,ApiValid:nd.apiKey||'',Teur:nd.desc||'תרומה',Currency:'1',CallBack:'postMessage'});
  const html=`<!DOCTYPE html><html dir="rtl" lang="he"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>תרומה — ${orgName}</title>
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700;900&display=swap" rel="stylesheet">
<style>*{box-sizing:border-box}body{margin:0;padding:0;font-family:'Heebo',Arial,sans-serif;background:linear-gradient(135deg,#1a2744 0%,#243358 100%);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:16px}.wrap{background:white;border-radius:20px;box-shadow:0 16px 60px rgba(0,0,0,.25);padding:28px 24px;width:520px;max-width:100%}.logo{font-size:24px;font-weight:900;color:#1a2744;border-bottom:3px solid #c9a84c;padding-bottom:10px;margin-bottom:20px}.loading{text-align:center;padding:40px;color:#888;font-size:14px}iframe{width:100%;min-height:580px;border:none;border-radius:12px;display:none}</style>
</head><body><div class="wrap">
<div class="logo">✡️ ${orgName}</div>
<div id="loading" class="loading">⏳ טוען טופס תרומה...</div>
<iframe id="donIframe" src="https://matara.pro/nedarimplus/online/?${params.toString()}" onload="iframeReady()"></iframe>
<div id="successMsg" style="display:none;text-align:center;padding:32px 20px;color:#16a34a">
  <div style="font-size:48px;margin-bottom:12px">✅</div>
  <div style="font-size:20px;font-weight:700">תרומתך התקבלה בהצלחה!</div>
  <div style="font-size:14px;color:#555;margin-top:8px">תודה רבה על תרומתך ל${orgName}</div>
</div>
</div>
<script>
function iframeReady(){document.getElementById('loading').style.display='none';document.getElementById('donIframe').style.display='block';}
window.addEventListener('message',e=>{if(e.data&&(e.data.Amount||e.data.status==='success')){document.getElementById('donIframe').style.display='none';document.getElementById('loading').style.display='none';document.getElementById('successMsg').style.display='block';}});
<\/script></body></html>`;
  const w=window.open('','_blank');
  if(w){w.document.write(html);w.document.close();}
  else toast('אפשר פופ-אפ בדפדפן');
}

// ════════════════════════════════════════════════════
// ITEM 10 — Multi-select relations (donors + fundraisers)
// ════════════════════════════════════════════════════
let _relSelectedIds=[], _relMode='donor';

function showRelSearch(mode) {
  _relSelectedIds=[]; _relMode=mode||'donor';
  const box=document.getElementById('relSearchBox');
  document.getElementById('relSearchLabel').textContent = _relMode==='fr' ? 'חיפוש מתרים' : 'חיפוש תורם';
  document.getElementById('relSearch').value='';
  document.getElementById('relResults').innerHTML='';
  document.getElementById('relSelectedList').innerHTML='';
  document.getElementById('relSelected').style.display='none';
  box.style.display='';
}
function searchRelDonors() {
  const q=document.getElementById('relSearch').value.trim().toLowerCase(); if(!q){document.getElementById('relResults').innerHTML='';return;}
  let res;
  if (_relMode==='fr') {
    res=(DB.fundraisers||[]).filter(f=>(f.firstName+' '+f.lastName).toLowerCase().includes(q)||(f.code||'').toLowerCase().includes(q)).slice(0,8);
    document.getElementById('relResults').innerHTML=res.map(f=>`<div class="pick-item" onclick="addRelSelected('fr_${f.id}')">${(f.firstName||'')+' '+(f.lastName||'')} <span style="color:var(--muted);font-size:11px">${f.code||''}</span></div>`).join('')||(q?'<p style="font-size:13px;color:var(--muted)">לא נמצאו</p>':'');
  } else {
    res=DB.donors.filter(d=>d.id!==currentDonorId&&!_relSelectedIds.includes(d.id)&&(donorName(d).toLowerCase().includes(q)||(d.code||'').toLowerCase().includes(q))).slice(0,8);
    document.getElementById('relResults').innerHTML=res.map(d=>`<div class="pick-item" onclick="addRelSelected('${d.id}')">${donorName(d)} <span style="color:var(--muted);font-size:11px">${d.code||''}</span></div>`).join('')||(q?'<p style="font-size:13px;color:var(--muted)">לא נמצאו</p>':'');
  }
}
function addRelSelected(id) {
  if(_relSelectedIds.includes(id))return;
  _relSelectedIds.push(id);
  document.getElementById('relSearch').value='';
  document.getElementById('relResults').innerHTML='';
  renderRelSelectedList();
}
function removeRelSelected(id) {
  _relSelectedIds=_relSelectedIds.filter(x=>x!==id);
  renderRelSelectedList();
}
function renderRelSelectedList() {
  const list=document.getElementById('relSelectedList');
  document.getElementById('relSelected').style.display=_relSelectedIds.length?'':'none';
  list.innerHTML=_relSelectedIds.map(id=>{
    let name='';
    if(id.startsWith('fr_')){const f=DB.fundraisers.find(x=>x.id===id.slice(3));name=f?((f.firstName||'')+' '+(f.lastName||'')).trim()+' 👤':'?';}
    else{const d=DB.donors.find(x=>x.id===id);name=d?donorName(d):'?';}
    return `<div style="display:flex;align-items:center;gap:6px;background:var(--cream);padding:5px 9px;border-radius:8px;margin-bottom:4px;font-size:12px">
      <span style="flex:1">${name}</span>
      <button style="border:none;background:none;cursor:pointer;color:var(--danger);font-size:16px;padding:0" onclick="removeRelSelected('${id}')">✕</button>
    </div>`;
  }).join('');
}
function confirmRel() {
  if(!_relSelectedIds.length){toast('בחר לפחות אחד');return;}
  const relType=document.getElementById('relType').value;
  const baseDonor=DB.donors.find(x=>x.id===currentDonorId);
  if(!baseDonor.relations)baseDonor.relations=[];
  let added=0;
  _relSelectedIds.forEach(id=>{
    if(!baseDonor.relations.find(r=>r.donorId===id)){baseDonor.relations.push({donorId:id,type:relType});added++;}
  });
  _relSelectedIds=[];
  saveDB(); renderRelTab();
  toast(`✓ ${added} שיוכים נוספו`);
}
function cancelRel(){document.getElementById('relSearchBox').style.display='none';_relSelectedIds=[];}
function deleteRel(idx){const d=DB.donors.find(x=>x.id===currentDonorId);if(!d||!confirm('להסיר?'))return;d.relations.splice(idx,1);saveDB();renderRelTab();}

// ════════════════════════════════════════════════════
// ITEM 11 — Print with interactive Leaflet map + "תרומה נוכחית" column
// ════════════════════════════════════════════════════
function printFundraisingSheet(grpId) {
  const grp=DB.groups.find(g=>g.id===grpId); if(!grp)return;
  const ac=activeCampaign();
  const prev3=[...DB.campaigns].sort((a,b)=>(b.year||'').localeCompare(a.year||'')).filter(c=>!c.active).slice(0,3);
  const ORG_NAME=getSettings().orgName||'עזר תורה — תושיה תפרח';
  const members=(grp.memberIds||[]).map(id=>{const f=DB.fundraisers.find(x=>x.id===id);return f?((f.firstName||'')+' '+(f.lastName||'')).trim():'';}).filter(Boolean);
  const donors=(grp.donorIds||[]).map(id=>DB.donors.find(d=>d.id===id)).filter(Boolean);

  const donorRows=donors.map(d=>{
    const maxDon=Math.max(0,...(d.donations||[]).map(dn=>parseFloat(dn.amount||0)));
    const prev3Tots=prev3.map(c=>(d.donations||[]).filter(dn=>dn.campaignId===c.id).reduce((s,dn)=>s+parseFloat(dn.amount||0),0));
    const addr=(d.address||'')+(d.entrance?' '+d.entrance:'');
    const tel=[d.phone,d.mobile].filter(Boolean).join(' | ');
    return `<tr><td class="nc">${d.title?d.title+' ':''}${donorName(d)}</td><td>${addr}</td><td style="white-space:nowrap">${tel}</td><td class="notec">${d.notes||''}</td><td class="mc">${maxDon>0?'₪'+maxDon.toLocaleString():''}</td>${prev3Tots.map(t=>`<td class="mc">${t>0?'₪'+t.toLocaleString():''}</td>`).join('')}<td class="curc"></td></tr>`;
  }).join('');

  const mappable=donors.filter(d=>d.lat&&d.lng);
  const markerData=JSON.stringify(mappable.map((d,i)=>({lat:d.lat,lng:d.lng,name:(d.title?d.title+' ':'')+donorName(d),addr:d.address||'',idx:i+1})));
  const mapHtml=mappable.length>0?`
    <div class="mapsec">
      <h3>🗺 מפת האיסוף <span style="font-size:11px;font-weight:400;color:#666">(${mappable.length} כתובות)</span></h3>
      <div id="lmap" style="height:420px;border-radius:12px;border:1px solid #ddd;overflow:hidden"></div>
    </div>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"><\/script>
    <script>
    window.addEventListener('load',function(){
      const map=L.map('lmap');
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'© OpenStreetMap',maxZoom:18}).addTo(map);
      const pts=${markerData},bounds=[];
      pts.forEach(m=>{
        const ic=L.divIcon({html:'<div style="background:#1a2744;color:#fff;border-radius:50%;width:26px;height:26px;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;border:2px solid #c9a84c;box-shadow:0 2px 6px rgba(0,0,0,.4)">'+m.idx+'</div>',className:'',iconSize:[26,26],iconAnchor:[13,13]});
        L.marker([m.lat,m.lng],{icon:ic}).addTo(map).bindPopup('<strong>'+m.name+'</strong><br>'+m.addr);
        bounds.push([m.lat,m.lng]);
      });
      if(bounds.length)map.fitBounds(bounds,{padding:[40,40]});
    });
    <\/script>`:
  `<div class="mapsec" style="background:#f8f4ed;border-radius:10px;padding:20px;text-align:center;color:#888;font-size:12px;margin-top:20px">אין כתובות עם נתוני מיקום למיפוי. קבע מיקום בכרטיס התורם כדי לייצר מפה.</div>`;

  const w=window.open('','_blank','width=1000,height=750');
  w.document.write(`<!DOCTYPE html><html dir="rtl" lang="he"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>גליית התרמה — ${grp.name}</title>
<style>
*{box-sizing:border-box}
body{font-family:Arial,sans-serif;margin:28px 32px;color:#1a2744;direction:rtl;font-size:12px}
.org{font-size:22px;font-weight:900;color:#1a2744;border-bottom:4px solid #c9a84c;padding-bottom:8px;margin-bottom:6px}
.sub{font-size:12px;color:#555;margin-bottom:6px}
.memb{background:#f0f4ff;border-radius:8px;padding:8px 14px;font-size:11px;margin-bottom:16px;border-right:3px solid #1a2744}
table{width:100%;border-collapse:collapse;margin-bottom:24px;border-radius:10px;overflow:hidden;box-shadow:0 2px 12px rgba(0,0,0,.08)}
thead tr{background:#1a2744}
th{color:white;padding:9px 10px;text-align:right;font-size:11px;font-weight:700;white-space:nowrap}
td{padding:8px 10px;border-bottom:1px solid #e8eaf0;vertical-align:middle;font-size:11px}
tr:nth-child(even) td{background:#f8f7f4}
tr:hover td{background:#eef2ff}
.nc{font-weight:600;min-width:120px;font-size:12px}
.mc{text-align:center;font-weight:600;color:#16a34a;min-width:80px}
.notec{font-size:10px;color:#666;max-width:130px}
.curc{background:#fffbeb;border-right:2px dashed #c9a84c;min-width:90px;text-align:center}
th.curc{background:#c9a84c;color:#1a2744}
.mapsec{margin-top:24px;page-break-inside:avoid}
.mapsec h3{font-size:14px;margin-bottom:10px;color:#1a2744}
.pbtn{background:#1a2744;color:white;border:none;padding:9px 22px;border-radius:8px;cursor:pointer;font-size:13px;margin-bottom:16px;font-family:Arial}
@media print{.pbtn{display:none}body{margin:12px 16px}table{box-shadow:none}tr{page-break-inside:avoid}#lmap{height:300px!important}}
</style></head><body>
<button class="pbtn" onclick="window.print()">🖨️ הדפס</button>
<div class="org">${ORG_NAME}</div>
<div class="sub">${ac?'מגבית: '+ac.name+' '+(ac.year||''):''} | קבוצה: <strong>${grp.name}</strong> | קוד: ${grp.code||'—'} | ${donors.length} תורמים | ${new Date().toLocaleDateString('he-IL')}</div>
${members.length?`<div class="memb">👥 מתרימים: ${members.join(' &bull; ')}</div>`:''}
<table>
<thead><tr>
  <th class="nc">שם תורם</th><th>כתובת</th><th>טלפון</th><th class="notec">הערות</th>
  <th class="mc">תרומה גבוהה</th>
  ${prev3.map(c=>`<th class="mc">${c.name}</th>`).join('')}
  <th class="curc">תרומה נוכחית</th>
</tr></thead>
<tbody>${donorRows}</tbody>
</table>
${mapHtml}
<div style="margin-top:16px;font-size:10px;color:#aaa;border-top:1px solid #eee;padding-top:8px">הודפס: ${new Date().toLocaleDateString('he-IL')} | ${ORG_NAME}</div>
</body></html>`);
  w.document.close();
}


// ════════════════════════════════════════════════════
// ITEM 7+9 — Column visibility & Multi-filter (Donors page)
// ════════════════════════════════════════════════════

const COL_DEFS = ['code','name','address','phones','email','affil','prefTime','total','lastDon','maxDon','createdAt','updatedAt','idNumber'];

function toggleColPicker() {
  const d = document.getElementById('colPickerDropdown');
  d.style.display = d.style.display === 'none' ? 'block' : 'none';
}

function applyColVis() {
  const cbs = document.querySelectorAll('#colCheckboxes input[type=checkbox]');
  const visible = new Set([...cbs].filter(cb => cb.checked).map(cb => cb.value));
  // Update table header
  document.querySelectorAll('#donorsTableHead th[data-col]').forEach(th => {
    const col = th.dataset.col;
    th.style.display = visible.has(col) ? '' : 'none';
  });
  // Update body rows
  document.querySelectorAll('#donorsBody tr').forEach(tr => {
    tr.querySelectorAll('td[data-col]').forEach(td => {
      td.style.display = visible.has(td.dataset.col) ? '' : 'none';
    });
  });
  // Save preference
  try { localStorage.setItem('donorColVis', JSON.stringify([...visible])); } catch(e){}
}

function selectAllCols(on) {
  document.querySelectorAll('#colCheckboxes input[type=checkbox]').forEach(cb => cb.checked = on);
  applyColVis();
}

function loadColVis() {
  try {
    const saved = JSON.parse(localStorage.getItem('donorColVis') || 'null');
    if (!saved) return;
    document.querySelectorAll('#colCheckboxes input[type=checkbox]').forEach(cb => {
      cb.checked = saved.includes(cb.value);
    });
    applyColVis();
  } catch(e) {}
}

// Multi-filter dropdown
const _multiSelected = {}; // { filterId: Set of selected values }

function toggleMultiFilter(id) {
  // Close all others first
  document.querySelectorAll('.multi-filter-drop').forEach(d => {
    if (d.id !== id) d.style.display = 'none';
  });
  const el = document.getElementById(id);
  if (!el) return;
  const isOpen = el.style.display !== 'none';
  el.style.display = isOpen ? 'none' : 'block';
}

// Close dropdowns on outside click
document.addEventListener('click', e => {
  if (!e.target.closest('.multi-filter-drop') && !e.target.closest('[onclick*="toggleMultiFilter"]')) {
    document.querySelectorAll('.multi-filter-drop').forEach(d => d.style.display = 'none');
  }
}, true);

function buildMultiOpts(optsId, values, onChange) {
  if (!_multiSelected[optsId]) _multiSelected[optsId] = new Set(values); // all selected by default
  const el = document.getElementById(optsId);
  if (!el) return;
  el.innerHTML = values.map(v =>
    `<label class="multi-filter-opt">
      <input type="checkbox" value="${escHtml(v)}" ${_multiSelected[optsId].has(v) ? 'checked' : ''} onchange="updateMultiSel('${optsId}',this);${onChange}">
      ${escHtml(v)}
    </label>`
  ).join('');
}

function escHtml(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

function updateMultiSel(optsId, cb) {
  if (!_multiSelected[optsId]) _multiSelected[optsId] = new Set();
  if (cb.checked) _multiSelected[optsId].add(cb.value);
  else _multiSelected[optsId].delete(cb.value);
}

function selectAllMulti(optsId, on) {
  const el = document.getElementById(optsId);
  if (!el) return;
  el.querySelectorAll('input[type=checkbox]').forEach(cb => {
    cb.checked = on;
    if (on) { if (!_multiSelected[optsId]) _multiSelected[optsId] = new Set(); _multiSelected[optsId].add(cb.value); }
    else { if (_multiSelected[optsId]) _multiSelected[optsId].delete(cb.value); }
  });
  applyFilters();
}

function filterMultiOpts(input, optsId) {
  const q = input.value.toLowerCase();
  document.getElementById(optsId)?.querySelectorAll('.multi-filter-opt').forEach(opt => {
    opt.style.display = opt.textContent.toLowerCase().includes(q) ? '' : 'none';
  });
}

function getMultiSelected(optsId) {
  const el = document.getElementById(optsId);
  if (!el) return null;
  const checked = [...el.querySelectorAll('input:checked')].map(cb => cb.value);
  const all = [...el.querySelectorAll('input')].map(cb => cb.value);
  if (checked.length === all.length || checked.length === 0) return null; // no filter
  return new Set(checked);
}

function updateMultiLabel(labelId, optsId, allLabel) {
  const sel = getMultiSelected(optsId);
  const labelEl = document.getElementById(labelId);
  if (!labelEl) return;
  if (!sel) labelEl.textContent = allLabel;
  else labelEl.textContent = sel.size + ' נבחרו';
}

// Extract city from address (last word after comma or last segment)
function extractCity(address) {
  if (!address) return '';
  const parts = address.split(',');
  if (parts.length >= 2) return parts[parts.length - 1].trim();
  const words = address.trim().split(/\s+/);
  return words.length > 1 ? words[words.length - 1] : address.trim();
}

// Rebuild donor filter options dynamically
function rebuildDonorFilters() {
  const affils = [...new Set(DB.donors.map(d => d.affil).filter(Boolean))].sort();
  const prefs  = [...new Set(DB.donors.map(d => d.prefTime).filter(Boolean))].sort();
  const cities = [...new Set(DB.donors.map(d => extractCity(d.address)).filter(Boolean))].sort();

  buildMultiOpts('affilOpts',  affils, 'applyFilters()');
  buildMultiOpts('prefOpts',   prefs,  'applyFilters()');
  buildMultiOpts('cityOpts',   cities, 'applyFilters()');
}

function clearFilters() {
  document.getElementById('mainSearch').value = '';
  ['affilOpts','prefOpts','cityOpts'].forEach(id => {
    if (_multiSelected[id]) _multiSelected[id] = null;
    document.getElementById(id)?.querySelectorAll('input').forEach(cb => cb.checked = true);
  });
  document.getElementById('fMinAmt').value = '';
  document.getElementById('fMaxAmt').value = '';
  ['affilFilterLabel','prefFilterLabel','cityFilterLabel'].forEach((id,i) => {
    const labels = ['כל השיוכים','כל מועדי תרמה','כל הערים'];
    const el = document.getElementById(id);
    if (el) el.textContent = labels[i];
  });
  applyFilters();
}

// ════════════════════════════════════════════════════
// ITEM 6 — Fix toggleDonForm + show details summary
// ════════════════════════════════════════════════════
function updateDetailsTabSummary() {
  if (!currentDonorId) return;
  const d = DB.donors.find(x => x.id === currentDonorId);
  if (!d) return;
  const total = (d.donations||[]).reduce((s,dn) => s + parseFloat(dn.amount||0), 0);
  const summEl = document.getElementById('detailsTabDonSummary');
  const totEl = document.getElementById('detailsTabTotal');
  if (summEl) summEl.style.display = total > 0 ? '' : 'none';
  if (totEl) totEl.textContent = total > 0 ? '₪' + total.toLocaleString() : '';
}

// ════════════════════════════════════════════════════
// ITEM 9 — Updated applyFilters with multi-select
// ════════════════════════════════════════════════════
function applyFilters() {
  const q = (document.getElementById('mainSearch')?.value||'').toLowerCase().trim();
  const minAmt = parseFloat(document.getElementById('fMinAmt')?.value||0) || 0;
  const maxAmt = parseFloat(document.getElementById('fMaxAmt')?.value||0) || 0;

  const affilSel = getMultiSelected('affilOpts');
  const prefSel  = getMultiSelected('prefOpts');
  const citySel  = getMultiSelected('cityOpts');

  // Update labels
  updateMultiLabel('affilFilterLabel', 'affilOpts', 'כל השיוכים');
  updateMultiLabel('prefFilterLabel',  'prefOpts',  'כל מועדי תרמה');
  updateMultiLabel('cityFilterLabel',  'cityOpts',  'כל הערים');

  filteredRows = DB.donors.filter(d => {
    if (q) {
      const hay = [d.code,d.firstName,d.lastName,d.address,d.phone,d.mobile,d.email,d.affil,d.prefTime,d.notes,d.idNumber].join(' ').toLowerCase();
      if (!hay.includes(q)) return false;
    }
    if (affilSel && !affilSel.has(d.affil||'')) return false;
    if (prefSel  && !prefSel.has(d.prefTime||'')) return false;
    if (citySel) {
      const city = extractCity(d.address||'');
      if (!citySel.has(city)) return false;
    }
    if (minAmt > 0) {
      const tot = (d.donations||[]).reduce((s,dn) => s+parseFloat(dn.amount||0), 0);
      if (tot < minAmt) return false;
    }
    if (maxAmt > 0) {
      const tot = (d.donations||[]).reduce((s,dn) => s+parseFloat(dn.amount||0), 0);
      if (tot > maxAmt) return false;
    }
    return true;
  });

  sortAndRender();

  const total = filteredRows.reduce((s,d) => s + (d.donations||[]).reduce((x,dn) => x+parseFloat(dn.amount||0),0), 0);
  document.getElementById('tableCount').textContent = filteredRows.length + ' תורמים';
  if (total > 0) document.getElementById('tableSum').textContent = ' | סה"כ תרומות: ₪' + total.toLocaleString();
  else document.getElementById('tableSum').textContent = '';

  const filtersActive = q || affilSel || prefSel || citySel || minAmt || maxAmt;
  const infoEl = document.getElementById('filterInfo');
  if (infoEl) infoEl.textContent = filtersActive ? `מציג ${filteredRows.length} מתוך ${DB.donors.length}` : '';
  applyColVis();
}

// ════════════════════════════════════════════════════
// ITEM 10+11 — Donations panel with new multi-filters
// ════════════════════════════════════════════════════
function rebuildDonsFilters() {
  const donors = [...new Set(DB.donors.map(d => donorName(d)).filter(Boolean))].sort();
  const methods = [...new Set(DB.donors.flatMap(d => (d.donations||[]).map(dn => dn.method)).filter(Boolean))].sort();
  const camps = [...new Set(DB.donors.flatMap(d => (d.donations||[]).map(dn => {
    const camp = DB.campaigns.find(c => c.id === dn.campaignId);
    return camp ? camp.name : '';
  })).filter(Boolean))].sort();
  const frs = [...new Set(DB.donors.flatMap(d => (d.donations||[]).map(dn => {
    if (dn.frId) { const fr = DB.fundraisers.find(f => f.id === dn.frId); return fr ? ((fr.firstName||'')+' '+(fr.lastName||'')).trim() : ''; }
    if (dn.groupId) { const g = DB.groups.find(x => x.id === dn.groupId); return g ? g.name : ''; }
    return '';
  })).filter(Boolean))].sort();

  buildMultiOpts('donsDonorOpts',  donors,  'renderDonationsPanel()');
  buildMultiOpts('donsMethodOpts', methods, 'renderDonationsPanel()');
  buildMultiOpts('donsCampOpts',   camps,   'renderDonationsPanel()');
  buildMultiOpts('donsFROpts',     frs,     'renderDonationsPanel()');
}

function clearDonsFilters() {
  document.getElementById('donsSearch').value = '';
  document.getElementById('donsFrom').value = '';
  document.getElementById('donsTo').value = '';
  ['donsDonorOpts','donsMethodOpts','donsCampOpts','donsFROpts'].forEach(id => {
    _multiSelected[id] = null;
    document.getElementById(id)?.querySelectorAll('input').forEach(cb => cb.checked = true);
  });
  ['donsDonorFilterLabel','donsMethodFilterLabel','donsCampFilterLabel','donsFRFilterLabel'].forEach((id,i) => {
    const labels = ['כל התורמים','כל אופני תשלום','כל המגביות','כל המתרימים'];
    const el = document.getElementById(id);
    if (el) el.textContent = labels[i];
  });
  renderDonationsPanel();
}

function printDonationsPanel() {
  // Gather current filtered data
  const rows = _lastDonsRows || [];
  const ac = activeCampaign();
  const ORG_NAME = getSettings().orgName || 'עזר תורה — תושיה תפרח';
  const total = rows.reduce((s,r) => s + parseFloat(r.amount||0), 0);

  const tableRows = rows.map(r => {
    const d = DB.donors.find(x => x.id === r.donorId);
    const camp = DB.campaigns.find(c => c.id === r.campaignId);
    let frLabel = '';
    if (r.frId) { const fr = DB.fundraisers.find(f => f.id === r.frId); if(fr) frLabel = ((fr.firstName||'')+' '+(fr.lastName||'')).trim(); }
    else if (r.groupId) { const g = DB.groups.find(x => x.id === r.groupId); if(g) frLabel = g.name; }
    return `<tr>
      <td>${r.date||''}</td>
      <td>${d ? donorName(d) : ''}</td>
      <td style="font-weight:700;color:#16a34a">₪${parseFloat(r.amount||0).toLocaleString()}</td>
      <td>${r.method||''}</td>
      <td>${camp ? camp.name : ''}</td>
      <td>${frLabel}</td>
      <td style="font-size:10px;color:#666">${r.notes||''}</td>
    </tr>`;
  }).join('');

  const w = window.open('', '_blank', 'width=900,height=700');
  w.document.write(`<!DOCTYPE html><html dir="rtl" lang="he"><head><meta charset="UTF-8">
    <title>דוח תרומות — ${ORG_NAME}</title>
    <style>
      *{box-sizing:border-box}body{font-family:Arial,sans-serif;margin:28px 32px;color:#1a2744;direction:rtl;font-size:12px}
      .org{font-size:22px;font-weight:900;border-bottom:4px solid #c9a84c;padding-bottom:8px;margin-bottom:6px}
      .sub{font-size:12px;color:#555;margin-bottom:16px}
      table{width:100%;border-collapse:collapse;border-radius:10px;overflow:hidden;box-shadow:0 2px 12px rgba(0,0,0,.08)}
      thead tr{background:#1a2744}th{color:white;padding:9px 10px;text-align:right;font-size:11px}
      td{padding:7px 10px;border-bottom:1px solid #e8eaf0;vertical-align:middle;font-size:11px}
      tr:nth-child(even) td{background:#f9f8f4}
      .total{font-size:15px;font-weight:700;color:#16a34a;margin-top:14px;text-align:left}
      .pbtn{background:#1a2744;color:white;border:none;padding:9px 22px;border-radius:8px;cursor:pointer;font-size:13px;margin-bottom:16px}
      @media print{.pbtn{display:none}body{margin:12px 16px}}
    </style></head><body>
    <button class="pbtn" onclick="window.print()">🖨️ הדפס</button>
    <div class="org">${ORG_NAME}</div>
    <div class="sub">דוח תרומות | ${rows.length} תרומות | ${new Date().toLocaleDateString('he-IL')}</div>
    <table>
      <thead><tr><th>תאריך</th><th>תורם</th><th>סכום</th><th>אופן</th><th>מגבית</th><th>מתרים</th><th>הערות</th></tr></thead>
      <tbody>${tableRows}</tbody>
    </table>
    <div class="total">סה"כ: ₪${total.toLocaleString()}</div>
    <div style="margin-top:12px;font-size:10px;color:#aaa;border-top:1px solid #eee;padding-top:8px">הודפס: ${new Date().toLocaleDateString('he-IL')} | ${ORG_NAME}</div>
    </body></html>`);
  w.document.close();
}



function openDonorAddDonation() {
  // Switch to donations tab, then open the form
  switchDTab('donations');
  // Wait for tab render, then open form
  requestAnimationFrame(() => {
    setTimeout(() => {
      const box = document.getElementById('donationFormBox');
      if (!box || box.style.display === '') return; // already open
      toggleDonForm();
      // Scroll the form into view
      setTimeout(() => box.scrollIntoView({ behavior: 'smooth', block: 'start' }), 100);
    }, 80);
  });
}

// ══ Rich Email Editor Helpers ══
function execRichFmt(editorId, cmd) {
  document.getElementById(editorId).focus();
  document.execCommand(cmd, false, null);
}

function insertMergeField(editorId, field) {
  const el = document.getElementById(editorId);
  el.focus();
  const sel = window.getSelection();
  if (sel.rangeCount) {
    const range = sel.getRangeAt(0);
    range.deleteContents();
    const span = document.createElement('span');
    span.style.cssText = 'background:#fef3c7;border:1px solid #fbbf24;border-radius:3px;padding:0 3px;font-size:11px;color:#92400e;white-space:nowrap';
    span.contentEditable = 'false';
    span.textContent = field;
    range.insertNode(span);
    range.setStartAfter(span);
    range.collapse(true);
    sel.removeAllRanges();
    sel.addRange(range);
  } else {
    el.innerHTML += '<span style="background:#fef3c7;border:1px solid #fbbf24;border-radius:3px;padding:0 3px;font-size:11px;color:#92400e" contenteditable="false">' + field + '</span>';
  }
}

function getRichBodyText(editorId) {
  // Extract text with merge field tokens intact
  const el = document.getElementById(editorId);
  if (!el) return '';
  // Convert spans (merge fields) to their text
  const clone = el.cloneNode(true);
  clone.querySelectorAll('span[contenteditable="false"]').forEach(s => {
    s.replaceWith(s.textContent);
  });
  // Get text with newlines from block elements
  return clone.innerText || clone.textContent || '';
}

function applyMergeFields(text, donor) {
  const fmt = v => (v !== undefined && v !== null && v !== '') ? v : '';
  const lastName = fmt(donor.lastName);
  const firstName = fmt(donor.firstName);
  const fullName = (lastName + ' ' + firstName).trim() || firstName || lastName;
  return text
    .replace(/\{\{שם\}\}/g, fullName)
    .replace(/\{\{שם_פרטי\}\}/g, firstName)
    .replace(/\{\{שם_משפחה\}\}/g, lastName)
    .replace(/\{\{קוד\}\}/g, fmt(donor.code))
    .replace(/\{\{עיר\}\}/g, fmt(donor.city))
    .replace(/\{\{כתובת\}\}/g, fmt(donor.address))
    .replace(/\{\{שיוך\}\}/g, fmt(donor.affiliation))
    .replace(/\{\{סך_תרומות\}\}/g, (donor._totalDonations||0).toLocaleString())
    .replace(/\{\{תרומה_אחרונה\}\}/g, (donor._lastDonation||0).toLocaleString())
    .replace(/\{\{תרומה_מקסימלית\}\}/g, (donor._maxDonation||0).toLocaleString());
}

function toggleBulkEmailBody() {
  const type = document.getElementById('bulkEmailType').value;
  const fields = document.getElementById('bulkEmailFields');
  if (fields) fields.style.display = type === 'link' ? 'none' : '';
}



// ════════════════════════════════════════════════════
// EXPORT WIZARD — Full Implementation v2
// ════════════════════════════════════════════════════

const TANEX_CONFIGS = {
  '3100':{label:'TANEX 3100 — 3×8',cols:3,rows:8,labelW:66,labelH:33.9,marginTop:13,marginLeft:4.5,gapH:0,gapV:0},
  '3101':{label:'TANEX 3101 — 2×7',cols:2,rows:7,labelW:99,labelH:38.1,marginTop:10,marginLeft:5,gapH:2,gapV:2},
  '3102':{label:'TANEX 3102 — 3×10',cols:3,rows:10,labelW:64,labelH:25.4,marginTop:12,marginLeft:5,gapH:3,gapV:0},
  '3106':{label:'TANEX 3106 — 4×11',cols:4,rows:11,labelW:48.5,labelH:25.4,marginTop:8.5,marginLeft:0,gapH:0,gapV:0},
};

let _lblRows = [];
let _lblDragIdx = null;

function initLabelRows() {
  _lblRows = [
    {field:'fullName',    label:'שם מלא',       bold:true},
    {field:'street_num',  label:'רחוב + מספר',   bold:false},
    {field:'city_zip',    label:'עיר + מיקוד',   bold:false},
  ];
  renderLabelBuilder();
}

function addLabelRow(field, label, bold) {
  _lblRows.push({field, label, bold});
  renderLabelBuilder();
  renderLabelPreview();
}

function removeLabelRow(idx) {
  _lblRows.splice(idx, 1);
  renderLabelBuilder();
  renderLabelPreview();
}

function renderLabelBuilder() {
  const container = document.getElementById('lblRowBuilder');
  if(!container) return;
  container.innerHTML = '';
  _lblRows.forEach((row, i) => {
    const el = document.createElement('div');
    el.style.cssText = 'display:flex;align-items:center;gap:8px;padding:6px 10px;background:white;border:1.5px solid var(--border);border-radius:8px;cursor:grab;user-select:none;font-size:13px';
    el.dataset.idx = i;
    el.draggable = true;
    el.innerHTML = `
      <span style="color:var(--muted);font-size:16px;cursor:grab">⠿</span>
      <span style="flex:1;font-weight:${row.bold?'700':'400'}">${row.label}</span>
      <label style="display:flex;align-items:center;gap:4px;font-size:11px;cursor:pointer">
        <input type="checkbox" ${row.bold?'checked':''} onchange="toggleLabelRowBold(${i},this.checked)"> מודגש
      </label>
      <button onclick="removeLabelRow(${i})" style="border:none;background:none;color:var(--danger);cursor:pointer;font-size:14px;padding:0 2px">✕</button>
    `;
    el.addEventListener('dragstart', e => { _lblDragIdx = i; el.style.opacity='0.5'; e.dataTransfer.effectAllowed='move'; });
    el.addEventListener('dragend',   e => { el.style.opacity='1'; });
    el.addEventListener('dragover',  e => { e.preventDefault(); el.style.borderColor='var(--gold)'; });
    el.addEventListener('dragleave', e => { el.style.borderColor='var(--border)'; });
    el.addEventListener('drop', e => {
      e.preventDefault();
      el.style.borderColor='var(--border)';
      if(_lblDragIdx !== null && _lblDragIdx !== i) {
        const moved = _lblRows.splice(_lblDragIdx, 1)[0];
        _lblRows.splice(i, 0, moved);
        renderLabelBuilder();
        renderLabelPreview();
      }
    });
    container.appendChild(el);
  });
}

function toggleLabelRowBold(idx, val) {
  _lblRows[idx].bold = val;
  renderLabelPreview();
}

function getLblVal(d, field) {
  if(!d) return '';
  const full = (d.firstName||'') + ' ' + (d.lastName||'');
  const sn   = (d.street||'') + ' ' + (d.houseNum||d.house||'');
  const cz   = (d.city||'') + (d.zip ? ' '+d.zip : '');
  const map = {
    fullName:full, firstName:d.firstName||'', lastName:d.lastName||'',
    title_name:'כבוד '+full, street_num:sn, street:d.street||'',
    house:d.houseNum||d.house||'', address_full:sn+', '+(d.city||''),
    city:d.city||'', zip:d.zip||'', city_zip:cz,
    phone:d.phone||'', mobile:d.mobile||'', code:d.code||'', email:d.email||''
  };
  return map[field] || '';
}

function renderLabelPreview() {
  const sp = document.getElementById('lblSinglePreview');
  if(!sp) return;
  const fontSz = document.getElementById('wiz_label_font')?.value || '10';
  const sampleDonor = (window.donors||[]).find(d=>d.city)||{firstName:'ישראל',lastName:'ישראלי',street:'הרצל',houseNum:'1',city:'ירושלים',zip:'9100001',phone:'02-1234567',mobile:'050-1234567',code:'D001'};
  if(!_lblRows.length) { sp.innerHTML='<div style="text-align:center;color:var(--muted);font-size:12px;padding:20px 0">הוסף שורות לתצוגה</div>'; return; }
  sp.innerHTML = _lblRows.map(row =>
    `<div style="font-size:${fontSz}pt;font-weight:${row.bold?'700':'400'};line-height:1.4;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${getLblVal(sampleDonor,row.field)||' '}</div>`
  ).join('');
  // Page layout sample
  const ps = document.getElementById('lblPageSample');
  if(!ps) return;
  const model = document.getElementById('wiz_tanex_model')?.value||'3100';
  const cfg = TANEX_CONFIGS[model];
  const SCALE = 1.5;
  const pageW = Math.round(210*SCALE);
  const pageH = Math.round(297*SCALE);
  const total = cfg.cols*cfg.rows;
  const donorsCount = (window.donors||[]).length||8;
  let lbl = '';
  for(let i=0;i<total;i++){
    const isEmpty = i>=Math.min(donorsCount,total);
    lbl+=`<div style="border:0.5px solid ${isEmpty?'#e0e0e0':'#999'};background:${isEmpty?'#fafafa':'white'};overflow:hidden;padding:1px 2px;display:flex;flex-direction:column;justify-content:center">
      ${isEmpty?'':_lblRows.slice(0,2).map(r=>`<div style="font-size:4.5px;font-weight:${r.bold?'700':'400'};overflow:hidden;white-space:nowrap">${r.label}</div>`).join('')}
    </div>`;
  }
  const scaleFactor = 240/pageW;
  ps.style.cssText=`width:${pageW}px;height:${pageH}px;background:white;display:grid;grid-template-columns:repeat(${cfg.cols},1fr);grid-template-rows:repeat(${cfg.rows},1fr);padding:${Math.round(cfg.marginTop*SCALE)}px ${Math.round(cfg.marginLeft*SCALE)}px;gap:${Math.round(cfg.gapV*SCALE)}px ${Math.round(cfg.gapH*SCALE)}px;transform-origin:top right;transform:scale(${scaleFactor});margin-bottom:${Math.round(pageH*scaleFactor-pageH)}px`;
  ps.innerHTML=lbl;
}

function updateTanexConfig() {
  const model = document.getElementById('wiz_tanex_model')?.value;
  const cfg = TANEX_CONFIGS[model];
  if(!cfg) return;
  const el = document.getElementById('tanex_config_info');
  if(el) el.textContent=`${cfg.cols} עמודות × ${cfg.rows} שורות = ${cfg.cols*cfg.rows} מדבקות לדף | גודל: ${cfg.labelW}×${cfg.labelH} מ"מ`;
  renderLabelPreview();
}

// ── Wizard state ──
let wizCurrentStep = 1;
let wizType = null;
let wizFilteredDonors = [];

function openExportWizard(context) {
  if(!can('admin')){toast('אשף הייצוא מיועד למנהלים ומעלה בלבד','warn');return;}
  // Populate window.* aliases from DB
  window.campaigns = DB.campaigns||[];
  window.fundraisers = DB.fundraisers||[];
  window.groups = DB.groups||[];
  window.donors = DB.donors||[];
  window.donations = [];
  (DB.donors||[]).forEach(d=>(d.donations||[]).forEach(dn=>window.donations.push({...dn,donorId:d.id})));
  wizCurrentStep = 1;
  wizType = null;
  wizFilteredDonors = [];
  ['wizPage1','wizPage2','wizPage3','wizPage4'].forEach((id,i)=>{ const el=document.getElementById(id); if(el)el.style.display=i===0?'':'none'; });
  document.querySelectorAll('.wiz-type-card').forEach(c=>c.classList.remove('selected'));
  _updateWizNav();
  _updateWizStepIndicators();
  _wizPopulateCampaigns();
  _wizPopulateGroups();
  if(context && ['donors','donations','fundraisers'].includes(context)) {
    wizType='excel';
    document.getElementById('wt_excel')?.classList.add('selected');
  }
  openModal('exportWizardModal');
  setTimeout(()=>{ initLabelRows(); updateTanexConfig(); },100);
}

function _wizPopulateCampaigns() {
  const camps=window.campaigns||[];
  ['wiz_campaign','wiz_pdf_campaign2','wiz_pkt_campaign'].forEach(id=>{
    const sel=document.getElementById(id); if(!sel)return;
    sel.innerHTML='<option value="">ללא / כל המגביות</option>';
    camps.forEach(c=>{ const o=document.createElement('option'); o.value=c.id||c.name; o.textContent=c.name; sel.appendChild(o); });
    const active=camps.find(c=>c.active); if(active) sel.value=active.id||active.name;
  });
}

function _wizPopulateGroups() {
  const groups=window.groups||[];
  const gf=document.getElementById('wiz_group');
  if(gf){ gf.innerHTML='<option value="">כל הקבוצות</option>'; groups.forEach(g=>{ const o=document.createElement('option'); o.value=g.code||g.id; o.textContent=`[${g.code}] ${g.name}`; gf.appendChild(o); }); }
  const ms=document.getElementById('wiz_pkt_groups');
  if(ms){ ms.innerHTML=''; groups.forEach(g=>{ const o=document.createElement('option'); o.value=g.code||g.id; o.textContent=`[${g.code}] ${g.name}`; o.selected=true; ms.appendChild(o); }); }
}

function selectWizType(type) {
  wizType=type;
  document.querySelectorAll('.wiz-type-card').forEach(c=>c.classList.remove('selected'));
  document.getElementById('wt_'+type)?.classList.add('selected');
}

function _updateWizNav() {
  const back=document.getElementById('wizBackBtn');
  const next=document.getElementById('wizNextBtn');
  const exp =document.getElementById('wizExportBtn');
  const prev=document.getElementById('wizPreviewBtn');
  if(back) back.style.display=wizCurrentStep>1?'':'none';
  if(next){ next.style.display=wizCurrentStep<4?'':'none'; next.textContent=wizCurrentStep===3?'👁️ תצוגה מקדימה →':'הבא →'; }
  if(exp)  exp.style.display=wizCurrentStep===4?'':'none';
  if(prev) prev.style.display=wizCurrentStep===4?'':'none';
}

function _updateWizStepIndicators() {
  ['ws1','ws2','ws3','ws4'].forEach((id,i)=>{
    const el=document.getElementById(id); if(!el)return;
    const step=i+1;
    if(step<wizCurrentStep)       { el.style.borderBottomColor='var(--gold)'; el.style.color='var(--gold)'; el.style.fontWeight='700'; }
    else if(step===wizCurrentStep){ el.style.borderBottomColor='var(--navy)'; el.style.color='var(--navy)'; el.style.fontWeight='700'; }
    else                          { el.style.borderBottomColor='transparent'; el.style.color='var(--muted)'; el.style.fontWeight='600'; }
  });
}

function wizStep(dir) {
  if(dir===1 && wizCurrentStep===1 && !wizType){ alert('אנא בחר סוג תוצר'); return; }
  if(dir===1 && wizCurrentStep===2) wizComputeFilter();
  const next=Math.max(1,Math.min(4,wizCurrentStep+dir));
  if(next===wizCurrentStep) return;
  document.getElementById('wizPage'+wizCurrentStep).style.display='none';
  wizCurrentStep=next;
  document.getElementById('wizPage'+wizCurrentStep).style.display='';
  _updateWizNav();
  _updateWizStepIndicators();
  if(wizCurrentStep===3){
    ['excel','pdf_donors','fundraiser_packets','labels'].forEach(t=>{
      const el=document.getElementById('wiz_settings_'+t); if(el)el.style.display=t===wizType?'':'none';
    });
    if(wizType==='labels') setTimeout(()=>{ renderLabelBuilder(); renderLabelPreview(); updateTanexConfig(); },50);
  }
  if(wizCurrentStep===4) wizGeneratePreview();
}

function wizComputeFilter() {
  const affil    = document.getElementById('wiz_affil')?.value||'';
  const city     = (document.getElementById('wiz_city')?.value||'').trim().toLowerCase();
  const minAmt   = parseFloat(document.getElementById('wiz_minAmount')?.value)||0;
  const campId   = document.getElementById('wiz_campaign')?.value||'';
  const groupId  = document.getElementById('wiz_group')?.value||'';
  const pref     = document.getElementById('wiz_pref')?.value||'';
  const dateFrom = document.getElementById('wiz_dateFrom')?.value||'';
  const dateTo   = document.getElementById('wiz_dateTo')?.value||'';
  const sort     = document.getElementById('wiz_sort')?.value||'name';
  let donors=(window.donors||[]).slice();
  if(affil) donors=donors.filter(d=>d.affiliation===affil);
  if(city)  donors=donors.filter(d=>(d.city||'').toLowerCase().includes(city));
  if(pref)  donors=donors.filter(d=>d.prefTime===pref);
  if(campId||dateFrom||dateTo||minAmt>0){
    donors=donors.filter(d=>{
      let dons=(window.donations||[]).filter(dn=>dn.donorId===d.id);
      if(campId) dons=dons.filter(dn=>dn.campaignId===campId||dn.campaign===campId);
      if(dateFrom) dons=dons.filter(dn=>(dn.date||'')>=dateFrom);
      if(dateTo)   dons=dons.filter(dn=>(dn.date||'')<=dateTo);
      if(minAmt>0){ const total=dons.reduce((s,dn)=>s+(parseFloat(dn.amount)||0),0); if(total<minAmt)return false; }
      if(campId&&!dons.length) return false;
      return true;
    });
  }
  if(groupId){
    const frs=(window.fundraisers||[]).filter(fr=>fr.groupCode===groupId||fr.group===groupId);
    const frIds=new Set(frs.map(fr=>fr.id));
    const relDonorIds=new Set((window.relations||window.donorRelations||[]).filter(r=>frIds.has(r.fundraiserId||r.frId)).map(r=>r.donorId));
    donors=donors.filter(d=>relDonorIds.has(d.id));
  }
  const getTotal=d=>(window.donations||[]).filter(dn=>dn.donorId===d.id).reduce((s,dn)=>s+(parseFloat(dn.amount)||0),0);
  donors.sort((a,b)=>{
    if(sort==='name') return (a.lastName||'').localeCompare(b.lastName||'','he');
    if(sort==='code') return (a.code||'').localeCompare(b.code||'');
    if(sort==='city') return (a.city||'').localeCompare(b.city||'','he');
    if(sort==='amount_desc') return getTotal(b)-getTotal(a);
    if(sort==='amount_asc')  return getTotal(a)-getTotal(b);
    return 0;
  });
  wizFilteredDonors=donors;
  const el=document.getElementById('wiz_filter_result');
  if(el) el.innerHTML=`✅ <strong>${donors.length}</strong> תורמים נמצאו לפי הפילטרים`;
}

function wizSelectAllCols(val) {
  document.querySelectorAll('input[name="exc_col"]').forEach(cb=>cb.checked=val);
}

function wizGeneratePreview() {
  if(!wizFilteredDonors.length) wizComputeFilter();
  const el=document.getElementById('wizPreviewContent');
  const cnt=document.getElementById('wizPreviewCount');
  if(cnt) cnt.textContent=wizFilteredDonors.length+' תורמים';
  if(wizType==='excel'){
    const LABELS={code:'קוד',firstName:'שם פרטי',lastName:'שם משפחה',affiliation:'שיוך',prefTime:'מועד תרמה',notes:'הערות',street:'רחוב',city:'עיר',zip:'מיקוד',phone:'טלפון',mobile:'פלאפון',email:'מייל',totalDonations:'סך תרומות',lastDonation:'תרומה אחרונה',maxDonation:'מקסימלי',donationCount:'מספר תרומות',lastCampaign:'מגבית אחרונה'};
    const cols=[...document.querySelectorAll('input[name="exc_col"]:checked')].map(c=>c.value);
    let html=`<div style="font-size:11px;color:var(--muted);margin-bottom:8px">מציג 20 מתוך ${wizFilteredDonors.length} רשומות</div><table style="border-collapse:collapse;width:100%;font-size:11px">`;
    html+='<tr style="background:var(--navy);color:white">'+cols.map(c=>`<th style="padding:4px 8px;border:1px solid #444">${LABELS[c]||c}</th>`).join('')+'</tr>';
    wizFilteredDonors.slice(0,20).forEach((d,i)=>{
      const dons=(window.donations||[]).filter(dn=>dn.donorId===d.id);
      const total=dons.reduce((s,dn)=>s+(parseFloat(dn.amount)||0),0);
      const sorted=[...dons].sort((a,b)=>(b.date||'').localeCompare(a.date||''));
      const row={code:d.code||'',firstName:d.firstName||'',lastName:d.lastName||'',affiliation:d.affiliation||'',prefTime:d.prefTime||'',notes:d.notes||'',street:d.street||'',city:d.city||'',zip:d.zip||'',phone:d.phone||'',mobile:d.mobile||'',email:d.email||'',totalDonations:total?'₪'+total.toLocaleString():'',lastDonation:sorted[0]?'₪'+(parseFloat(sorted[0].amount)||0).toLocaleString():'',maxDonation:dons.length?'₪'+Math.max(...dons.map(dn=>parseFloat(dn.amount)||0)).toLocaleString():'',donationCount:dons.length||'',lastCampaign:sorted[0]?.campaign||sorted[0]?.campaignId||''};
      html+=`<tr style="background:${i%2?'#f9f9f9':'white'}">`+cols.map(c=>`<td style="padding:3px 6px;border:1px solid #eee">${row[c]||''}</td>`).join('')+'</tr>';
    });
    if(wizFilteredDonors.length>20) html+=`<tr><td colspan="${cols.length}" style="text-align:center;padding:6px;color:var(--muted);font-style:italic">... ועוד ${wizFilteredDonors.length-20} רשומות</td></tr>`;
    html+='</table>';
    el.innerHTML=html;
  } else if(wizType==='labels'){
    const model=document.getElementById('wiz_tanex_model')?.value||'3100';
    const cfg=TANEX_CONFIGS[model];
    const fontSz=document.getElementById('wiz_label_font')?.value||'10';
    const perPage=cfg.cols*cfg.rows;
    el.innerHTML=`<div style="font-size:12px;color:var(--muted);margin-bottom:10px">📄 ${Math.min(wizFilteredDonors.length,perPage)} מדבקות — עמוד 1 מתוך ${Math.ceil(wizFilteredDonors.length/perPage)||1}</div>
    <div style="display:grid;grid-template-columns:repeat(${cfg.cols},1fr);gap:4px">
    ${wizFilteredDonors.slice(0,perPage).map(d=>`<div style="border:1px solid #bbb;padding:3px 5px;font-family:Heebo,sans-serif;min-height:30px">
      ${_lblRows.map(r=>`<div style="font-size:${fontSz}pt;font-weight:${r.bold?'700':'400'};white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${getLblVal(d,r.field)||' '}</div>`).join('')}
    </div>`).join('')}
    </div>`;
  } else {
    const icons={pdf_donors:'📋',fundraiser_packets:'📦',labels:'🏷️'};
    el.innerHTML=`<div style="text-align:center;padding:40px"><div style="font-size:48px;margin-bottom:16px">${icons[wizType]||'🖨️'}</div><div style="font-size:16px;font-weight:700;color:var(--navy);margin-bottom:8px">✅ מוכן לייצוא</div><div style="font-size:13px;color:var(--muted)">${wizFilteredDonors.length} תורמים יכנסו לתוצר</div><div style="font-size:12px;color:var(--muted);margin-top:8px">לחץ "ייצוא / הדפסה" להמשך</div></div>`;
  }
}

function wizExecuteExport() {
  if(!wizFilteredDonors.length) wizComputeFilter();
  if(wizType==='excel')               wizDoExcel();
  else if(wizType==='pdf_donors')     wizDoPdfDonors();
  else if(wizType==='fundraiser_packets') wizDoPdfPackets();
  else if(wizType==='labels')         wizDoPdfLabels();
}

// ── Quick Export ──
function quickExcelExport(context) {
  let data=[];
  if(context==='donors'){
    const headers=[...document.querySelectorAll('#donorsTable thead th')].map(th=>th.textContent.trim()).filter(h=>h&&h!=='☑');
    data.push(headers);
    document.querySelectorAll('#donorsTable tbody tr').forEach(row=>{
      if(row.style.display==='none') return;
      const cells=[...row.querySelectorAll('td')].slice(1).map(td=>td.textContent.trim());
      if(cells.length) data.push(cells);
    });
  } else if(context==='donations'){
    const headers=[...document.querySelectorAll('#donationsTable thead th')].map(th=>th.textContent.trim()).filter(h=>h);
    data.push(headers);
    document.querySelectorAll('#donationsTable tbody tr').forEach(row=>{
      if(row.style.display==='none') return;
      const cells=[...row.querySelectorAll('td')].map(td=>td.textContent.trim());
      if(cells.length) data.push(cells);
    });
  } else if(context==='fundraisers'){
    data=[['קוד','שם פרטי','שם משפחה','וועד','קוד קבוצה','טלפון בית','פלאפון','יעד (₪)']];
    (window.fundraisers||[]).forEach(fr=>data.push([fr.code||'',fr.firstName||'',fr.lastName||'',fr.vaad||'',fr.groupCode||'',fr.homePhone||'',fr.mobile||'',fr.target||'']));
  }
  if(!data.length||data.length<2){alert('אין נתונים לייצוא');return;}
  if(typeof XLSX==='undefined'){alert('ספריית Excel לא טעונה');return;}
  const ws=XLSX.utils.aoa_to_sheet(data);
  const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,'נתונים');
  XLSX.writeFile(wb,context+'-export-'+today()+'.xlsx');
  showToast('📊 קובץ Excel הורד','success');
}

function quickPdfExport(context) {
  if(context==='fundraisers'){
    const hdr=['קוד','שם פרטי','שם משפחה','וועד','קוד קבוצה','טלפון','פלאפון','יעד (₪)'];
    const rows=(window.fundraisers||[]).map(fr=>[fr.code||'',fr.firstName||'',fr.lastName||'',fr.vaad||'',fr.groupCode||'',fr.homePhone||'',fr.mobile||'',fr.target||'']);
    const inst='עזר תורה - תושיה'; const camp=(window.campaigns||[]).find(c=>c.active)?.name||'';
    const pw=window.open('','_blank','width=900,height=700');
    pw.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="utf-8"><title>רשימת מתרימים</title><style>@import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap');body{font-family:Heebo,sans-serif;font-size:9px;margin:10mm;direction:rtl}.hdr{text-align:center;margin-bottom:10px;border-bottom:2px solid #1a2744;padding-bottom:8px}.hdr h1{font-size:18px;margin:0;color:#1a2744}table{border-collapse:collapse;width:100%}th{background:#1a2744;color:white;padding:4px 6px;font-size:8px;border:1px solid #555}td{padding:2px 4px;border:1px solid #ddd;font-size:8px}tr:nth-child(even){background:#f8f8f8}@page{size:A4;margin:10mm}</style></head><body><div class="hdr"><h1>${inst}</h1><h2>${camp}</h2><p style="font-size:8px;color:#888">רשימת מתרימים | ${new Date().toLocaleDateString('he-IL')}</p></div><table><thead><tr>${hdr.map(h=>`<th>${h}</th>`).join('')}</tr></thead><tbody>${rows.map((r,i)=>`<tr style="background:${i%2?'#f8f8f8':'white'}">${r.map(v=>`<td>${v}</td>`).join('')}</tr>`).join('')}</tbody></table><script>window.onload=()=>{window.print();setTimeout(()=>window.close(),2000)}<\/script></body></html>`);
    pw.document.close(); return;
  }
  const tbl=context==='donors'?document.getElementById('donorsTable'):document.getElementById('donationsTable');
  if(!tbl){alert('טבלה לא נמצאה');return;}
  const title=context==='donors'?'רשימת תורמים':'רשימת תרומות';
  const inst='עזר תורה - תושיה';
  const camp=(window.campaigns||[]).find(c=>c.active)?.name||'';
  const clone=tbl.cloneNode(true);
  clone.querySelectorAll('tbody tr').forEach(tr=>{ if(tr.style.display==='none')tr.remove(); });
  const pw=window.open('','_blank','width=900,height=700');
  pw.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="utf-8">
<title>${title}</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap');
body{font-family:Heebo,sans-serif;font-size:9px;margin:10mm 12mm;direction:rtl}
.hdr{text-align:center;margin-bottom:10px;border-bottom:2px solid #1a2744;padding-bottom:8px}
.hdr h1{font-size:18px;margin:0;color:#1a2744}.hdr h2{font-size:12px;margin:4px 0;color:#555}
table{border-collapse:collapse;width:100%}
th{background:#1a2744;color:white;padding:4px 6px;font-size:8px;border:1px solid #555}
td{padding:2px 4px;border:1px solid #ddd;font-size:8px;word-break:break-word}
tr:nth-child(even){background:#f8f8f8}
th:first-child,td:first-child{display:none}
@page{size:A4;margin:10mm}
</style></head><body>
<div class="hdr"><h1>${inst}</h1><h2>${camp}</h2><p style="font-size:8px;color:#888">${title} | ${new Date().toLocaleDateString('he-IL')}</p></div>
${clone.outerHTML}
<script>window.onload=()=>{window.print();setTimeout(()=>window.close(),2000)}<\/script>
</body></html>`);
  pw.document.close();
}

// ── Wizard Excel ──
function wizDoExcel() {
  const LABELS={code:'קוד',firstName:'שם פרטי',lastName:'שם משפחה',affiliation:'שיוך',prefTime:'מועד תרמה',notes:'הערות',street:'רחוב',city:'עיר',zip:'מיקוד',phone:'טלפון',mobile:'פלאפון',email:'מייל',totalDonations:'סך תרומות',lastDonation:'תרומה אחרונה',maxDonation:'מקסימלי',donationCount:'מספר תרומות',lastCampaign:'מגבית אחרונה'};
  const cols=[...document.querySelectorAll('input[name="exc_col"]:checked')].map(c=>c.value);
  const fmt=document.querySelector('input[name="exc_format"]:checked')?.value||'xlsx';
  const data=[cols.map(c=>LABELS[c]||c)];
  wizFilteredDonors.forEach(d=>{
    const dons=(window.donations||[]).filter(dn=>dn.donorId===d.id);
    const total=dons.reduce((s,dn)=>s+(parseFloat(dn.amount)||0),0);
    const sorted=[...dons].sort((a,b)=>(b.date||'').localeCompare(a.date||''));
    const max=dons.length?Math.max(...dons.map(dn=>parseFloat(dn.amount)||0)):0;
    data.push(cols.map(c=>{
      switch(c){
        case 'code':return d.code||''; case 'firstName':return d.firstName||''; case 'lastName':return d.lastName||'';
        case 'affiliation':return d.affiliation||''; case 'prefTime':return d.prefTime||''; case 'notes':return d.notes||'';
        case 'street':return d.street||''; case 'city':return d.city||''; case 'zip':return d.zip||'';
        case 'phone':return d.phone||''; case 'mobile':return d.mobile||''; case 'email':return d.email||'';
        case 'totalDonations':return total||0; case 'lastDonation':return sorted[0]?parseFloat(sorted[0].amount)||0:0;
        case 'maxDonation':return max; case 'donationCount':return dons.length; case 'lastCampaign':return sorted[0]?.campaign||sorted[0]?.campaignId||'';
        default:return '';
      }
    }));
  });
  if(fmt==='csv'){
    const csv=data.map(r=>r.map(v=>typeof v==='string'&&v.includes(',')? '"'+v+'"':v).join(',')).join('\n');
    const blob=new Blob(['\uFEFF'+csv],{type:'text/csv;charset=utf-8'});
    const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='donors-'+today()+'.csv';a.click();
  } else {
    if(typeof XLSX==='undefined'){alert('ספריית Excel לא טעונה');return;}
    const ws=XLSX.utils.aoa_to_sheet(data);
    const wb=XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb,ws,'תורמים');
    XLSX.writeFile(wb,'donors-'+today()+'.xlsx');
  }
  closeModal('exportWizardModal');
  showToast('📊 קובץ Excel הורד!','success');
}

// ── Wizard PDF Donor List ──
function wizDoPdfDonors() {
  const inst    = document.getElementById('wiz_pdf_institution')?.value||'';
  const campSel = document.getElementById('wiz_pdf_campaign2');
  const campName= campSel?.options[campSel.selectedIndex]?.text||'';
  const orient  = document.getElementById('wiz_pdf_orient')?.value||'portrait';
  const maxRowH = parseFloat(document.getElementById('wiz_pdf_rowH')?.value)||15;
  const cols    = [...document.querySelectorAll('input[name="pdf_col"]:checked')].map(c=>c.value);
  const LABELS  = {code:'קוד',name:'שם',address:'כתובת',phone:'טלפון',mobile:'פלאפון',affil:'שיוך',totalDonations:'סך תרומות',notes:'הערות'};
  const colWidthMap={code:12,name:38,address:52,phone:26,mobile:26,affil:18,totalDonations:20,notes:38};
  const pageW=orient==='landscape'?277:190;
  const rawW=cols.reduce((s,c)=>s+(colWidthMap[c]||25),0);
  const scale=pageW/Math.max(rawW,pageW);
  const scaledW=cols.map(c=>Math.round((colWidthMap[c]||25)*scale));

  const rows=wizFilteredDonors.map(d=>{
    const dons=(window.donations||[]).filter(dn=>dn.donorId===d.id);
    const total=dons.reduce((s,dn)=>s+(parseFloat(dn.amount)||0),0);
    return cols.map(c=>{
      switch(c){
        case 'code':return d.code||''; case 'name':return (d.firstName||'')+' '+(d.lastName||'');
        case 'address':return [(d.street||''),(d.houseNum||''),(d.city?', '+d.city:'')].filter(x=>x.trim()).join(' ');
        case 'phone':return d.phone||''; case 'mobile':return d.mobile||'';
        case 'affil':return d.affiliation||'';
        case 'totalDonations':return total?'₪'+total.toLocaleString():'';
        case 'notes':return d.notes||''; default:return '';
      }
    });
  });

  const pw=window.open('','_blank','width=1100,height=800');
  pw.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="utf-8">
<title>רשימת תורמים</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap');
*{box-sizing:border-box}
body{font-family:Heebo,sans-serif;direction:rtl;margin:0;padding:8mm 10mm;font-size:9px}
.page-hdr{text-align:center;margin-bottom:12px;border-bottom:2px solid #1a2744;padding-bottom:8px}
.page-hdr h1{font-size:20px;margin:0;color:#1a2744}
.page-hdr h2{font-size:12px;margin:4px 0;color:#555}
table{border-collapse:collapse;width:100%}
th{background:#1a2744;color:white;padding:4px 5px;font-size:9px;border:1px solid #333;text-align:right}
td{padding:2px 4px;border:1px solid #ddd;font-size:9px;word-break:break-word;vertical-align:top}
tr:nth-child(even){background:#f8f8f8}
@page{size:A4 ${orient==='landscape'?'landscape':'portrait'};margin:10mm;
  @bottom-center{content:"עמוד " counter(page) " מתוך " counter(pages);font-family:Heebo,sans-serif;font-size:7px;color:#888}}
@media print{body{margin:0;padding:0}}
</style></head><body>
<div class="page-hdr">
  <h1>${inst}</h1><h2>${campName}</h2>
  <p style="font-size:9px;color:#888;margin:4px 0">${new Date().toLocaleDateString('he-IL')} | ${wizFilteredDonors.length} תורמים</p>
</div>
<table>
<thead><tr>${cols.map((c,i)=>`<th style="width:${scaledW[i]}mm">${LABELS[c]||c}</th>`).join('')}</tr></thead>
<tbody>${rows.map(row=>`<tr>${row.map((v,i)=>{
  const isLong=['address','notes'].includes(cols[i]);
  return `<td style="width:${scaledW[i]}mm" data-long="${isLong}">${v||''}</td>`;
}).join('')}</tr>`).join('')}</tbody>
</table>
<script>
window.onload=()=>{
  const maxH = ${maxRowH} * 3.78;
  document.querySelectorAll('td[data-long="true"]').forEach(td=>{
    let fs=9;
    while(td.scrollHeight>maxH && fs>6){ fs--; td.style.fontSize=fs+'px'; }
  });
  setTimeout(()=>window.print(),400);
  setTimeout(()=>window.close(),3000);
};
<\/script>
</body></html>`);
  pw.document.close();
  closeModal('exportWizardModal');
}

// ── Wizard Fundraiser Packets ──
function wizDoPdfPackets() {
  const inst      = document.getElementById('wiz_pkt_institution')?.value||'';
  const campSel   = document.getElementById('wiz_pkt_campaign');
  const campName  = campSel?.options[campSel.selectedIndex]?.text||'';
  const mapsKey   = document.getElementById('wiz_maps_key')?.value.trim()||'';
  const selGroups = [...(document.getElementById('wiz_pkt_groups')?.selectedOptions||[])].map(o=>o.value);
  const pkCols    = [...document.querySelectorAll('input[name="pkt_col"]:checked')].map(c=>c.value);
  const LABELS    = {code:'קוד',name:'שם',address:'כתובת',phone:'טלפון',mobile:'פלאפון',maxDonation:'מקסימלי',lastDonation:'אחרון',notes:'הערות',empty:'✍'};
  const half      = Math.ceil(pkCols.length/2);
  const topCols   = pkCols.slice(0,half);
  const btmCols   = pkCols.slice(half);
  const groupsToProcess=(window.groups||[]).filter(g=>selGroups.includes(g.code||g.id)||selGroups.length===0);

  function getDonorVal(d,col){
    const dons=(window.donations||[]).filter(dn=>dn.donorId===d.id);
    const sorted=[...dons].sort((a,b)=>(b.date||'').localeCompare(a.date||''));
    const max=dons.length?Math.max(...dons.map(dn=>parseFloat(dn.amount)||0)):0;
    const last=sorted[0]?parseFloat(sorted[0].amount)||0:0;
    switch(col){
      case 'code':return d.code||''; case 'name':return (d.firstName||'')+' '+(d.lastName||'');
      case 'address':return (d.street||'')+' '+(d.houseNum||'')+', '+(d.city||'');
      case 'phone':return d.phone||''; case 'mobile':return d.mobile||'';
      case 'maxDonation':return max?'₪'+max.toLocaleString():'';
      case 'lastDonation':return last?'₪'+last.toLocaleString():'';
      case 'notes':return d.notes||''; case 'empty':return ''; default:return '';
    }
  }

  let pagesHTML='';
  groupsToProcess.forEach((grp,gi)=>{
    const grpFrs=(window.fundraisers||[]).filter(fr=>fr.groupCode===grp.code||fr.group===grp.code);
    const frIds=new Set(grpFrs.map(fr=>fr.id));
    const relDonorIds=new Set((window.relations||window.donorRelations||[]).filter(r=>frIds.has(r.fundraiserId||r.frId)).map(r=>r.donorId));
    const grpDonors=wizFilteredDonors.filter(d=>relDonorIds.has(d.id));
    const memberRows=grpFrs.map(fr=>`<tr><td style="padding:3px 8px;border:1px solid #ddd">${fr.firstName||''} ${fr.lastName||''}</td><td style="padding:3px 8px;border:1px solid #ddd">${fr.mobile||fr.homePhone||''}</td></tr>`).join('');
    const donorRows=grpDonors.map((d,i)=>{
      const bg1=i%2===0?'white':'#f0f5ff';
      const bg2=i%2===0?'#e8ecf8':'#dde5ff';
      return `
      <tr style="background:${bg1};border-top:1.5px solid #bbb">
        ${topCols.map(c=>`<td style="padding:2px 5px;font-size:9px;border:1px solid #ddd">${getDonorVal(d,c)}</td>`).join('')}
      </tr>
      <tr style="background:${bg2}">
        ${btmCols.map(c=>`<td style="padding:2px 5px;font-size:9px;border:1px solid #ddd;color:#333;font-style:italic">${getDonorVal(d,c)}</td>`).join('')}
        ${topCols.length>btmCols.length?`<td colspan="${topCols.length-btmCols.length}" style="border:1px solid #ddd;background:white"></td>`:''}
      </tr>`;
    }).join('');

    let mapSection='';
    if(mapsKey&&grpDonors.length>0){
      const markers=grpDonors.slice(0,40).map(d=>`color:red%7C${encodeURIComponent((d.street||'')+' '+(d.houseNum||'')+','+(d.city||''))}`).join('&markers=');
      const mapUrl=`https://maps.googleapis.com/maps/api/staticmap?size=640x480&maptype=roadmap&markers=${markers}&language=he&key=${mapsKey}`;
      mapSection=`<div class="page-break">
        <div style="text-align:center;background:#1a2744;color:white;padding:10px;border-radius:8px;margin-bottom:14px">
          <div style="font-size:13px;font-weight:700">🗺️ מפת התמצאות — קבוצה ${grp.code} | ${grp.name||''}</div>
          <div style="font-size:10px;opacity:.8;margin-top:4px">${grpDonors.length} תורמים</div>
        </div>
        <div style="text-align:center">
          <img src="${mapUrl}" style="max-width:100%;border:2px solid #1a2744;border-radius:8px" onerror="this.parentElement.innerHTML='<p style=\\'color:red;padding:20px\\'>שגיאה בטעינת המפה</p>'">
        </div>
      </div>`;
    }

    pagesHTML+=`
    <div class="${gi>0?'page-break':''}">
      <div style="text-align:center;border-bottom:2px solid #1a2744;padding-bottom:10px;margin-bottom:12px">
        <div style="font-size:13px;color:#666;font-weight:600">${inst}</div>
        <div style="font-size:18px;font-weight:700;color:#1a2744">${campName}</div>
        <div style="font-size:15px;font-weight:700;margin-top:6px">קבוצה ${grp.code} — ${grp.name||''}</div>
        <div style="font-size:10px;color:#888;margin-top:4px">${new Date().toLocaleDateString('he-IL')} | ${grpDonors.length} תורמים</div>
      </div>
      ${memberRows?`<table style="border-collapse:collapse;margin-bottom:14px;font-size:10px;border:1px solid #bbb;background:#f8f8f8">
        <thead><tr style="background:#1a2744;color:white"><th colspan="2" style="padding:5px 8px;text-align:right">חברי הקבוצה (${grpFrs.length})</th></tr></thead>
        <tbody>${memberRows}</tbody>
      </table>`:''}
      <table style="border-collapse:collapse;width:100%">
        <thead>
          <tr style="background:#1a2744;color:white">${topCols.map(c=>`<th style="padding:3px 6px;font-size:9px;border:1px solid #333;text-align:right">${LABELS[c]||c}</th>`).join('')}</tr>
          <tr style="background:#2d4070;color:#ccd">${btmCols.map(c=>`<th style="padding:2px 5px;font-size:8px;border:1px solid #333;text-align:right;font-style:italic">${LABELS[c]||c}</th>`).join('')}${topCols.length>btmCols.length?`<th colspan="${topCols.length-btmCols.length}" style="border:1px solid #333"></th>`:''}</tr>
        </thead>
        <tbody>${donorRows}</tbody>
      </table>
    </div>
    ${mapSection}`;
  });

  const pw=window.open('','_blank','width=1200,height=900');
  pw.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="utf-8"><title>דוחות קבוצות</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap');
*{box-sizing:border-box}
body{font-family:Heebo,sans-serif;direction:rtl;margin:0;padding:6mm 8mm;font-size:10px}
.page-break{page-break-before:always;break-before:page;padding-top:6mm}
@page{size:A4 landscape;margin:8mm;@bottom-center{content:"עמוד " counter(page) " מתוך " counter(pages);font-family:Heebo,sans-serif;font-size:7px;color:#888}}
@media print{body{margin:0;padding:0}.page-break{page-break-before:always}}
</style></head><body>
${pagesHTML}
<script>
window.onload=()=>{
  const imgs=document.querySelectorAll('img');
  Promise.all([...imgs].map(img=>new Promise(res=>{if(img.complete)res();else{img.onload=res;img.onerror=res;}}))).then(()=>{
    setTimeout(()=>window.print(),300);
    setTimeout(()=>window.close(),5000);
  });
};
<\/script>
</body></html>`);
  pw.document.close();
  closeModal('exportWizardModal');
}

// ── Wizard TANEX Labels ──
function wizDoPdfLabels() {
  const model  = document.getElementById('wiz_tanex_model')?.value||'3100';
  const cfg    = TANEX_CONFIGS[model];
  const fontSz = parseInt(document.getElementById('wiz_label_font')?.value)||10;
  const rows   = _lblRows;

  function buildLabel(d) {
    if(!d) return '<div class="label"></div>';
    return `<div class="label">${rows.map(r=>`<div class="${r.bold?'lb':'lr'}">${getLblVal(d,r.field)||' '}</div>`).join('')}</div>`;
  }

  const perPage=cfg.cols*cfg.rows;
  let pagesHTML='';
  for(let pi=0;pi<Math.ceil(wizFilteredDonors.length/perPage);pi++){
    const pg=wizFilteredDonors.slice(pi*perPage,(pi+1)*perPage);
    while(pg.length<perPage) pg.push(null);
    pagesHTML+=`<div class="pg">${pg.map(buildLabel).join('')}</div>`;
  }

  const pw=window.open('','_blank','width=800,height=900');
  pw.document.write(`<!DOCTYPE html><html dir="rtl"><head><meta charset="utf-8"><title>מדבקות</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap');
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Heebo,sans-serif;direction:rtl;background:white}
.pg{
  width:210mm;height:297mm;
  padding:${cfg.marginTop}mm ${cfg.marginLeft}mm;
  display:grid;
  grid-template-columns:repeat(${cfg.cols},${cfg.labelW}mm);
  grid-template-rows:repeat(${cfg.rows},${cfg.labelH}mm);
  column-gap:${cfg.gapH}mm;row-gap:${cfg.gapV}mm;
  overflow:hidden;page-break-after:always;break-after:page;
}
.label{width:${cfg.labelW}mm;height:${cfg.labelH}mm;padding:1.5mm 2.5mm;display:flex;flex-direction:column;justify-content:center;overflow:hidden}
.lb{font-size:${fontSz}pt;font-weight:700;line-height:1.35;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.lr{font-size:${Math.max(fontSz-1,7)}pt;font-weight:400;line-height:1.35;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
@page{size:A4 portrait;margin:0}
@media print{body{margin:0}.pg{page-break-after:always}}
</style></head><body>
${pagesHTML}
<script>window.onload=()=>{window.print();setTimeout(()=>window.close(),4000)}<\/script>
</body></html>`);
  pw.document.close();
  closeModal('exportWizardModal');
  showToast('🏷️ מדבקות נשלחו להדפסה','success');
}

// ════════════════════════════════════════════════════
// INIT: check URL params (reset token, self service)
// ════════════════════════════════════════════════════

// INIT
// Note: loadDB is now async and called inside doLogin()
// Check cloud connectivity on page load
(async()=>{ try { await _sb.from("app_state").select("id").limit(1); console.log("✓ Supabase connected"); } catch(e){ console.warn("Supabase offline, will use localStorage:", e.message); } })();
</script>
</body>
</html>
